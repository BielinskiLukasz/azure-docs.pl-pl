---
title: Rozszerzenie ochrony przed złośliwym oprogramowaniem firmy Microsoft dla maszyn wirtualnych z systemem Windows na platformie Azure
description: Wdrażanie rozszerzenia ochrony przed złośliwym oprogramowaniem platformy Azure na maszynie wirtualnej systemu Windows przy użyciu rozszerzenia.
services: virtual-machines-windows
documentationcenter: ''
author: TomShinder
manager: gwallace
editor: ''
ms.assetid: ''
ms.service: virtual-machines-windows
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure-services
ms.date: 04/12/2018
ms.author: tomsh
ms.openlocfilehash: 4cdde31bb25dc9834ba53539c33c4e49c952840a
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/28/2020
ms.locfileid: "79253821"
---
# <a name="microsoft-antimalware-extension-for-windows"></a>Rozszerzenie ochrony przed złośliwym oprogramowaniem firmy Microsoft dla systemu Windows

## <a name="overview"></a>Omówienie

Nowoczesny krajobraz zagrożeń dla środowisk chmurowych jest niezwykle dynamiczny, co zwiększa presję na biznesowych subskrybentów chmury IT, aby utrzymać skuteczną ochronę w celu spełnienia wymagań dotyczących zgodności i bezpieczeństwa. Microsoft Antimalware for Azure to bezpłatna funkcja ochrony w czasie rzeczywistym, która pomaga identyfikować i usuwać wirusy, programy szpiegujące i inne złośliwe oprogramowanie, z konfigurowalnymi alertami, gdy znane złośliwe lub niechciane oprogramowanie próbuje się zainstalować lub uruchomić na Systemy platformy Azure. Rozwiązanie jest oparte na tej samej platformie chroniącej przed złośliwym oprogramowaniem, co Microsoft Security Essentials (MSE), Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune i Windows Defender dla windows 8.0 i nowszego.
Microsoft Antimalware for Azure to rozwiązanie jednoagentowe dla aplikacji i środowisk dzierżawy, zaprojektowane do pracy w tle bez interwencji człowieka. Ochronę można wdrożyć na podstawie potrzeb obciążeń aplikacji, przy zastosowaniu podstawowej bezpiecznej domyślnej lub zaawansowanej konfiguracji niestandardowej, w tym monitorowania ochrony przed złośliwym oprogramowaniem.

## <a name="prerequisites"></a>Wymagania wstępne

### <a name="operating-system"></a>System operacyjny

Rozwiązanie Microsoft Antimalware for Azure obejmuje klienta ochrony przed złośliwym oprogramowaniem firmy Microsoft i usługi, klasycznego modelu wdrażania ochrony przed złośliwym oprogramowaniem, polecenia cmdlet programu PowerShell ochrony przed złośliwym oprogramowaniem i rozszerzenie diagnostyki platformy Azure. Rozwiązanie Microsoft Antimalware jest obsługiwane w rodzinach systemów operacyjnych Windows Server 2008 R2, Windows Server 2012 i Windows Server 2012 R2. Nie jest obsługiwany w systemie operacyjnym Windows Server 2008, a także nie jest obsługiwany w systemie Linux. 

Usługa Windows Defender to wbudowane oprogramowanie ochrony przed złośliwym oprogramowaniem włączone w systemie Windows Server 2016. Interfejs usługi Windows Defender jest również domyślnie włączony w niektórych jednostkach SKU systemu Windows Server 2016.
Rozszerzenie ochrony przed złośliwym oprogramowaniem platformy Azure nadal można dodać do maszyny Wirtualnej Platformy Windows Server 2016 z usługą Windows Defender, ale w tym scenariuszu rozszerzenie zastosuje wszystkie opcjonalne zasady konfiguracji, które mają być używane przez usługę Windows Defender, rozszerzenie nie wdroży żadnych dodatkową usługę ochrony przed złośliwym oprogramowaniem. Możesz przeczytać więcej o tej aktualizacji [tutaj](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="internet-connectivity"></a>Łączność z Internetem

Ochrona przed złośliwym oprogramowaniem firmy Microsoft dla systemu Windows wymaga, aby docelowa maszyna wirtualna była połączona z Internetem w celu otrzymywania regularnych aktualizacji aparatu i podpisu. 

## <a name="template-deployment"></a>Wdrażanie na podstawie szablonu
Rozszerzenia maszyn wirtualnych platformy Azure można wdrożyć za pomocą szablonów usługi Azure Resource Manager. Szablony są idealne podczas wdrażania co najmniej jednej maszyny wirtualnej, które wymagają konfiguracji po wdrożeniu, takich jak dołączanie do usługi Azure Antimalware.

Konfiguracja JSON dla rozszerzenia maszyny wirtualnej może być zagnieżdżona wewnątrz zasobu maszyny wirtualnej lub umieszczona na głównym lub najwyższym poziomie szablonu JSON Menedżera zasobów. Położenie konfiguracji JSON wpływa na wartość nazwy i typu zasobu. Aby uzyskać więcej informacji, zobacz [Ustawianie nazwy i typu zasobów podrzędnych](../../azure-resource-manager/templates/child-resource-name-type.md). 

W poniższym przykładzie przyjęto założenie, że rozszerzenie maszyny wirtualnej jest zagnieżdżone wewnątrz zasobu maszyny wirtualnej. Podczas zagnieżdżania zasobu rozszerzenia `"resources": []` JSON jest umieszczany w obiekcie maszyny wirtualnej.

```json
{
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(parameters('vmName'),'/', parameters('vmExtensionName'))]",
      "apiVersion": "2019-07-01",
      "location": "[resourceGroup().location]",
      "dependsOn": [
        "[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))]"
      ],

      "properties": {
        "publisher": "Microsoft.Azure.Security",
        "type": "IaaSAntimalware",
        "typeHandlerVersion": "1.3",
        "autoUpgradeMinorVersion": true,
        "settings": {
          "AntimalwareEnabled": "true",
          "Exclusions": {
            "Extensions": ".log;.ldf",
            "Paths": "D:\\IISlogs;D:\\DatabaseLogs",
            "Processes": "mssence.svc"
          },

          "RealtimeProtectionEnabled": "true",
          "ScheduledScanSettings": {
            "isEnabled": "true",
            "scanType": "Quick",
            "day": "7",
            "time": "120"
          }
        },
        "protectedSettings": null
      }
}
```

## <a name="powershell-deployment"></a>Wdrożenie programu PowerShell
W zależności od typu wdrożenia, użyj odpowiednich poleceń, aby wdrożyć rozszerzenie maszyny wirtualnej ochrony przed złośliwym oprogramowaniem platformy Azure na istniejącej maszynie wirtualnej.

  * Maszyna wirtualna oparta na usłudze Azure Resource Manager-https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/
  * Klastry sieci szkieletowej usług Azure —https://blogs.msdn.microsoft.com/azuresecurity/2016/10/07/add-microsoft-antimalware-to-azure-service-fabric-clusters/
  * Klasyczna usługa w chmurze -https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension

## <a name="troubleshoot-and-support"></a>Rozwiązywanie problemów i pomoc techniczna

### <a name="troubleshoot"></a>Rozwiązywanie problemów

Dzienniki rozszerzeń ochrony przed złośliwym oprogramowaniem firmy Microsoft są dostępne pod adresem : %Systemdrive%\WindowsAzure\Logs\Plugins\Microsoft.Azure.Security.IaaSAntimalware(Or PaaSAntimalware)\1.5.5.x(version#)\CommandExecution.log

### <a name="error-codes-and-their-meanings"></a>Kody błędów i ich znaczenia

| Kod błędu | Znaczenie | Możliwe działanie |
| :---: | --- | --- |
| -2147156224 | MSI jest zajęty inną instalacją | Spróbuj uruchomić instalację w ostatniej |
| -2147156221 | Konfiguracja MSE już uruchomiona | Uruchamianie tylko jednego wystąpienia naraz |
| -2147156208 | Mało miejsca na dysku < 200 MB | Usuwanie nieużywanych plików i ponawianie próby instalacji |
| -2147156187 | Ostatnia instalacja, uaktualnianie, aktualizacja lub odinstalowanie żądanego ponownego uruchomienia | Ponowne uruchomienie komputera i ponów próbę instalacji |
| -2147156121 | Instalator próbował usunąć produkt konkurencji. Ale odinstalowanie produktu konkurencyjnego nie powiodło się | Spróbuj usunąć produkt konkurenta ręcznie, ponownie uruchomić i ponowić próbę instalacji  |
| -2147156116 | Sprawdzanie poprawności pliku zasad nie powiodło się | Upewnij się, że do konfiguracji został przegłosowyny prawidłowy plik XML zasad  |
| -2147156095 | Instalator nie może uruchomić usługi Ochrony przed złośliwym oprogramowaniem | Sprawdź, czy wszystkie pliki binarne są poprawnie podpisane, a właściwy plik licencjonowania jest zainstalowany |
| -2147023293 | Podczas instalacji wystąpił błąd krytyczny. W większości przypadków tak będzie. Epp.msi, nie można zarejestrować\start\stop usługi AM lub sterownika mini filtru | Dzienniki MSI z EPP.msi są tutaj wymagane do przyszłego dochodzenia |
| -2147023277 | Nie można otworzyć pakietu instalacyjnego | Sprawdź, czy pakiet istnieje i jest dostępny, lub skontaktuj się z dostawcą aplikacji, aby sprawdzić, czy jest to prawidłowy pakiet Instalatora Windows |
| -2147156109 | Defender jest wymagany jako warunek wstępny |  |
| -2147205073 | Wydawca websso nie jest obsługiwany | |
| -2147024893 | System nie może odnaleźć określonej ścieżki |  |
| -2146885619 | Nie jest to wiadomość kryptograficzna lub wiadomość kryptograficzna nie jest poprawnie sformatowana |  |
| -1073741819 | Instrukcja w 0x%p odwołuje się do pamięci na 0x%p. Nie można mieć pamięci %s |  |
| 1 | Nieprawidłowa funkcja |  |


### <a name="support"></a>Pomoc techniczna

Jeśli potrzebujesz więcej pomocy w dowolnym momencie tego artykułu, możesz skontaktować się z ekspertami platformy Azure na [forach MSDN Azure i Stack Overflow](https://azure.microsoft.com/support/forums/). Alternatywnie można zgłosić zdarzenie pomocy technicznej platformy Azure. Przejdź do [witryny pomocy technicznej platformy Azure](https://azure.microsoft.com/support/options/)i wybierz pozycję Uzyskaj pomoc techniczną. Aby uzyskać informacje na temat korzystania z pomocy technicznej platformy Azure, przeczytaj często zadawane [pytania dotyczące pomocy technicznej platformy Microsoft Azure](https://azure.microsoft.com/support/faq/).
