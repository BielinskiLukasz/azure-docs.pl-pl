<properties 
    pageTitle="CDN を使用する方法 | Microsoft Azure" 
    description="Azure Content Delivery Network (CDN) を使用して、BLOB と静的コンテンツをキャッシュすることにより、高帯域幅コンテンツを配信する方法について説明します。" 
    services="cdn" 
    documentationCenter=".net" 
    authors="camsoper" 
    manager="dwrede" 
    editor=""/>

<tags 
    ms.service="cdn" 
    ms.workload="tbd" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="12/02/2015" 
    ms.author="casoper"/>


# ストレージ アカウントと CDN の統合

CDN を使用して、Azure ストレージのコンテンツをキャッシュできます。 CDN は、米国、ヨーロッパ、アジア、オーストラリア、および南米にある物理ノードで、コンピューティング インスタンスの BLOB と静的コンテンツをキャッシュすることで、高帯域幅コンテンツを配信するグローバル ソリューションを開発者に提供します。


## ステップ 1: ストレージ アカウントを作成する

Azure サブスクリプションの新しいストレージ アカウントを作成するには、
として機能します。 ストレージ アカウントによって、 
Azure ストレージ サービスにアクセスできます。 ストレージ
アカウント
コンポーネント: Blob サービス、キュー サービス、およびテーブル サービスです。 詳細についてを参照してください、 [Microsoft Azure Storage の概要](../storage-introduction.md)します。

ストレージ アカウントを作成するには、
関連付けられているサブスクリプションのサービス管理者または共同管理者であることが必要です。

> [AZURE.NOTE] Azure ポータルと Powershell を含めて、ストレージ アカウントを作成に使用できるいくつかの方法はあります。  このチュートリアルでは Azure ポータルを使用します。  

**Azure サブスクリプションのストレージ アカウントを作成するには**

1.  サインイン、 [Azure ポータル](https://portal.azure.com)します。
2.  左上隅で [ **新規**します。  **新規** ] ダイアログ ボックスで選択 **データ + ストレージ**, 、クリックして **ストレージ アカウント**します。 ままにして **クラシック** 配置モデルと選択すると、をクリックし、 **作成**します。

     **ストレージ アカウント** ブレードが表示されます。

    ![ストレージ アカウントの作成][create-new-storage-account]

4.  **ストレージ** フィールドにサブドメイン名を入力します。 文字数は 3 ～ 24 文字とし、アルファベット小文字と数字を使用できます。

    この値は、対応するサブスクリプションの
    BLOB リソース、キュー リソース、またはテーブル リソースのアドレス指定に使用される URI 内でホスト名になります。 To
    サービスでコンテナー リソースをアドレス指定するには、
    次の形式で URI を *& lt;StorageAccountLabel & gt;* 参照
    入力した値に **URL を入力**:

    http://*& lt;StorageAcountLabel & gt;*.blob.core.windows.net/*& lt; mycontainer & gt;*

    **重要:** URL ラベルには、記憶域のサブドメイン
    URI のサブドメインとなるため、Azure のすべてのホステッド サービスで一意である必要が 
    Azure。

    この値は、このストレージ アカウントの名前として、ポータルやプログラムでこのアカウントにアクセスするときにも使用されます。

5.  選択、 **価格レベル** または既定値を使用します。  価格レベルの詳細については、次を参照してください。 [Azure Storage 料金](../../pricing/details/storage)します。

6.  選択または作成、 **リソース グループ**します。  リソース グループの詳細については、次を参照してください。 [Azure リソース マネージャーの概要](resource-group-overview/#resource-groups)します。 

7. 選択、 **サブスクリプション** で使用されるストレージ アカウント。

8.  クリックして **作成**します。 ストレージ アカウントを作成するプロセスは、完了までに数分かかる場合があります。

9.  ストレージ アカウントが正常に作成されたことを確認する] の一覧にアカウントが表示されていることを確認します **ストレージ** の状態で **オンライン**します。


## ステップ 2: 新しい CDN プロファイルを作成する

CDN プロファイルは、CDN エンドポイントのコレクションです。  各プロファイルには、1 つ以上の CDN エンドポイントが含まれます。  複数のプロファイルを使って、インターネット ドメイン、Web アプリケーション、またはその他の一部の基準別に CDN エンドポイントを整理する必要が生じる場合があります。

> [AZURE.TIP] このチュートリアルで使用する CDN プロファイルが既にあるを場合に進みます [手順 3](#step-3-create-a-new-cdn-endpoint)します。

**新しい CDN プロファイルを作成するには**

1.  [Azure 管理ポータル](https://portal.azure.com), 、左上でクリックして **新規**します。   **新規** ブレードで、 **メディア + CDN**, 、し **CDN**します。

    新しい CDN プロファイル ブレードが表示されます。
    
    ![新しい CDN プロファイル][new-cdn-profile]

2. CDN プロファイルの名前を入力します。 

3. 選択、 **価格レベル** または既定値を使用します。

4. 選択または作成、 **リソース グループ**します。  これは、ストレージ アカウントと同じリソース グループである必要はありません。

5. 選択、 **サブスクリプション** この CDN プロファイルの。  この場合は、このチュートリアルでの便宜上、ストレージ アカウントと同じサブスクリプションである必要があります。

6. 選択、 **場所**します。  これは、CDN プロファイル情報が格納される Azure の場所です。  CDN エンドポイントの場所には影響しません。  ストレージ アカウントと同じ場所である必要はありません。

7. クリックして、 **作成** 新しいプロファイルを作成する] ボタンをクリックします。

## ステップ 3: 新しい CDN エンドポイントを作成する

**ストレージ アカウントに対する新しい CDN エンドポイントを作成するには**

1.  [Azure 管理ポータル](https://portal.azure.com), 、CDN プロファイルに移動します。  これは、前の手順でダッシュボードにピン留めしている可能性があります。  かどうかは表示されていない、することができますをクリックして **参照**, 、し、 **CDN プロファイル**, 、ボードを使用するエンドポイントを追加する予定のプロファイル] をクリックします。

    CDN プロファイル ブレードが表示されます。
    
    ![CDN プロファイル][cdn-profile-settings]
    
2. クリックして、 **エンドポイントの追加** ] ボタンをクリックします。

    ![[エンドポイントの追加] ボタン][cdn-new-endpoint-button]

     **エンドポイントを追加** ブレードが表示されます。
    
    ![[エンドポイントの追加] ブレード][cdn-add-endpoint]

3. 入力、 **名前** この CDN エンドポイントです。  この名前は、ドメイン `<EndpointName>.azureedge.net` でキャッシュされたリソースにアクセスする際に使用します。

4.  **配信元の種類** ドロップダウンで、選択 *ストレージ*します。  

5.  **配信元のホスト名** ドロップダウン リストで、ストレージ アカウントを選択します。

6. 既定値のままにして **オリジン パス**, 、**Origin ヘッダーがホスト**, 、および **プロトコル/送信元ポート**します。  少なくとも 1 つのプロトコル (HTTP または HTTPS) を指定する必要があります。 

    > [AZURE.NOTE] この構成により、すべてのストレージ アカウント、CDN にキャッシュ用に公開されているコンテナーです。  1 つのコンテナーにスコープを限定する場合を使用して **オリジン パス**します。  コンテナーの表示設定は公開に指定されている必要があります。

7. クリックして、 **追加** 新しいエンドポイントを作成する] ボタンをクリックします。

8. エンドポイントが作成されると、プロファイルのエンドポイントの一覧に表示されます。 一覧には、キャッシュされたコンテンツへのアクセスに使用する URL と元のドメインが表示されます。

    ![CDN エンドポイント][cdn-endpoint-success]

    > [AZURE.NOTE] エンドポイントはすぐにはできません使用します。  登録が CDN ネットワークに反映されるまでに最大で 90 分かかる場合があります。 CDN ドメイン名を直ちに使用しようとするユーザーは、CDN を経由してコンテンツを取得できるようになるまでは状態コード 404 を受け取る場合があります。


## ステップ 4: CDN コンテンツにアクセスする

CDN にキャッシュされたコンテンツにアクセスするには、ポータルで提供される CDN URL を使用します。 キャッシュされた BLOB のアドレスは、次のようになります。

p:\\ http://&lt*EndpointName*\ >.azureedge.net/<*myPublicContainer*\ >/<*BlobName*\ >

> [AZURE.NOTE] ストレージ アカウントへの CDN アクセスを有効にする場合、またはホステッド サービスとすべてのパブリックに利用可能なオブジェクトは CDN エッジ キャッシュの対象です。 CDN で現在キャッシュされているオブジェクトを変更する場合、キャッシュされたコンテンツの有効期限終了時に CDN によりそのコンテンツが更新されるまでは、CDN を通じて新しいコンテンツを使用することはできません。

## ステップ 5: CDN からコンテンツを削除する

Azure コンテンツ配信ネットワーク (CDN) にオブジェクトをキャッシュする必要がなくなった場合は、
次のいずれかの手順を実行できます。

-   コンテナーをパブリックではなくプライベートに設定できます。 参照してください [コンテナーと blob への匿名読み取りアクセスを管理](../storage-manage-access-to-resources/) の詳細。
-   管理ポータルを使用して CDN エンドポイントを無効にしたり削除したりできます。
-   オブジェクトの要求に応答しなくなるようにホストされるサービスを変更できます。

CDN に既にキャッシュされているオブジェクトは、オブジェクトの有効期限が切れるまで、またはエンドポイントが消去されるまでキャッシュに残ったままとなります。 有効期限が切れると、CDN エンドポイントがまだ有効で、オブジェクトがまだ匿名アクセス可能かどうかが CDN によって確認されます。 CDN エンドポイントが無効になり、オブジェクトに匿名でアクセスできなくなった場合、オブジェクトはキャッシュされなくなります。


## その他のリソース

-   [CDN コンテンツをカスタム ドメインにマッピングする方法](cdn-map-content-to-custom-domain.md)

[create-new-storage-account]: ./media/cdn-create-a-storage-account-with-cdn/CDN_CreateNewStorageAcct.png

[new-cdn-profile]: ./media/cdn-create-a-storage-account-with-cdn/cdn-new-profile.png
[cdn-profile-settings]: ./media/cdn-create-a-storage-account-with-cdn/cdn-profile-settings.png
[cdn-new-endpoint-button]: ./media/cdn-create-a-storage-account-with-cdn/cdn-new-endpoint-button.png
[cdn-add-endpoint]: ./media/cdn-create-a-storage-account-with-cdn/cdn-add-endpoint.png
[cdn-endpoint-success]: ./media/cdn-create-a-storage-account-with-cdn/cdn-endpoint-success.png


