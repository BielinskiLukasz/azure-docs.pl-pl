<properties
   pageTitle="Visual Studio からの Azure アプリケーションの発行またはデプロイの準備"
   description="クラウド サービスとストレージ アカウント サービスを設定し、Azure アプリケーションを構成する手順を説明します。"
   services="visual-studio-online"
   documentationCenter="na"
   authors="TomArcher"
   manager="douge"
   editor="" />
<tags
   ms.service="multiple"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="multiple"
   ms.date="09/28/2015"
   ms.author="tarcher" />

# Visual Studio からの Azure アプリケーションの発行またはデプロイの準備

## 概要

クラウド サービス プロジェクトを発行可能にするには、次のサービスを設定する必要があります。

- A **クラウド サービス** Azure 環境で、ロールを実行するには

- A **ストレージ アカウント** Blob、キュー、およびテーブル サービスへのアクセスを提供します。

これらのサービスを設定し、アプリケーションを構成するには、次の手順を使用します。


## クラウド サービスを作成する

Azure にクラウド サービスを発行するには、まず、Azure 環境でロールを実行するクラウド サービスを作成する必要があります。 セクションで説明されていると、Azure 管理ポータルでクラウド サービスを作成できます **Azure 管理ポータルを使用してクラウド サービスを作成する**, は、このトピックで後述します。 クラウド サービスは、発行ウィザードを使用して Visual Studio を作成することもできます。

### Visual Studio を使用してクラウド サービスを作成するには

1. Azure プロジェクトのショートカット メニューを開き **発行**します。

    ![VST_PublishMenu](./media/vs-azure-tools-cloud-service-publish-set-up-required-services-in-visual-studio/vst-publish-menu.png)

1. サインインしていない場合は、Azure サブスクリプションに関連付けられている Microsoft アカウントまたは組織アカウントのユーザー名とパスワードを使用してサインインします。

1. 選択、 **次** に進む] ボタン、 **設定** ページです。

    ![Publishing Wizard Common Settings](./media/vs-azure-tools-cloud-service-publish-set-up-required-services-in-visual-studio/publish-settings-page.png)

1.  **Cloud Services** 一覧で、選択 **新規作成**します。  **Azure サービスの作成** ダイアログが表示されます。

1. クラウド サービスの名前を入力します。 この名前はサービスの URL の一部として使用されるため、グローバルに一意であることが必要です。 この名前では、大文字小文字が区別されません。

### Azure 管理ポータルを使用してクラウド サービスを作成するには

1. サインイン、 [Azure 管理ポータル](http://go.microsoft.com/fwlink/?LinkId=253103) 、Microsoft web サイトです。

1. (省略可能) 既に作成したクラウド サービスの一覧を表示するには、ページの左側にある [Cloud Services] リンクを選択します。

1. 選択、 **+** 左下隅のアイコン コーナー、クリックして **クラウド サービス** 表示されるメニューです。 2 つのオプションが別の画面 **簡易作成** と **カスタム作成**, が表示されます。 選択した場合 **簡易作成**, 、クラウド サービスを作成するには、URL と、物理的にホストするリージョンを指定しています。 選択した場合 **カスタム作成**, 、パッケージ (.cspkg ファイル)、構成 (.cscfg) ファイル、および証明書を指定して、クラウド サービスをすぐに発行できます。 カスタムを作成するには必要ありませんを使用して、クラウド サービスを発行する場合、 **発行** コマンド Azure プロジェクトを実行します。  **発行** コマンドは、Azure プロジェクトのショートカット メニューで使用します。

1. 選択 **簡易作成** 後で Visual Studio を使用してクラウド サービスを発行します。

1. クラウド サービスの名前を指定します。名前の隣に完全な URL が表示されます。

1. 一覧で、ユーザーが主に配置されているリージョンを選択します。

1. ウィンドウの下部にある、選択、 **クラウド サービスの作成** リンクします。

## ストレージ アカウントの作成

ストレージ アカウントを使用すると、BLOB サービス、Queue サービス、および Table サービスにアクセスできます。 ストレージ アカウントを作成するには Visual Studio を使用して、または [Azure 管理ポータル](http://go.microsoft.com/fwlink/?LinkId=253103)します。

### Visual Studio を使用して、ストレージ アカウントを作成するには

1.  **ソリューション エクスプ ローラー**, 、ショートカット メニューを開き、 **ストレージ** ] ノードを選択し **ストレージ アカウントの作成**します。

    ![Create a new Azure storage account](./media/vs-azure-tools-cloud-service-publish-set-up-required-services-in-visual-studio/IC744166.png)

1. 選択するか、次の情報で新しいストレージ アカウントを入力、 **ストレージ アカウントの作成** ] ダイアログ ボックス。
    - ストレージ アカウントを追加する Azure サブスクリプション。
    - 新しいストレージ アカウントに使用する名前。
    - リージョンまたはアフィニティ グループ (米国西部や東アジアなど)。
    - geo 冗長など、ストレージ アカウントで使用するレプリケーションの種類。

1. 完了したら、選択 **作成**します。新しいストレージ アカウントに表示される、 **ストレージ** リストに **サーバー エクスプ ローラー**します。

### Azure 管理ポータルを使用して、ストレージ アカウントを作成するには

1. サインイン、 [Azure 管理ポータル](http://go.microsoft.com/fwlink/?LinkId=253103) 、Microsoft web サイトです。

1. (省略可能)表示するには、ストレージ アカウントを選択、 **ストレージ** 、ページの左側のパネルにリンクします。

1. ページの左上にある、 **+** アイコン。

1. 表示されるメニューで、選択 **ストレージ**, 、にして **簡易作成**します。

1. ストレージ アカウントに一意の URL となる名前を付けます。

1. クラウド サービスに名前を付けます。 名前の隣に完全な URL が表示されます。

1. リージョンの一覧で、ユーザーが主に配置されているリージョンを選択します。

1. geo レプリケーションを有効にするかどうかを指定します。 geo レプリケーションを有効にした場合は、データは複数の物理的な場所に保存され、損失の可能性が低減します。 この機能ではストレージは高価になりますが、機能を後で追加するのではなく、ストレージ アカウントを作成するときに geo ロケーションを有効にすると、コストを削減することができます。 詳細については、次を参照してください。 [Geo レプリケーション](http://go.microsoft.com/fwlink/?LinkId=253108)します。

1. ウィンドウの下部にある、選択、 **ストレージ アカウントの作成** リンクします。

ストレージ アカウントを作成したら、各 Azure Storage サービスのリソースにアクセスするために使用できる URL が表示されます。また、アカウントのプライマリ アクセス キーとセカンダリ アクセス キーも表示されます。 これらのキーは、ストレージ サービスに対する要求を認証するために使用します。

>[AZURE.NOTE] セカンダリ アクセス キーは、プライマリ アクセス キーと、ストレージ アカウントに同じアクセスを提供し、プライマリ アクセス キーが侵害されるバックアップとして生成されます。 また、定期的にアクセスのキーを再生成することをお勧めします。 プライマリ キーの再生成時にセカンダリ キーを使用するように接続文字列の設定を変更した後で、セカンダリ キーの再生成時に再生成したプライマリ キーを使用するように接続文字列の設定を変更できます。

## ストレージ アカウントによって提供されるサービスを使用するようアプリケーションを構成する

作成した Azure Storage サービスを使用するには、Storage サービスにアクセスするロールを構成する必要があります。 これを行うために、Azure プロジェクトの複数のサービス構成を使用できます。 既定では、Azure プロジェクトに 2 つのサービス構成が作成されます。 複数のサービス構成を使用すると、コード内では同じ接続文字列を使用しつつ、各サービス構成で定めた接続文字列に別の値を適用することができます。 たとえば、Azure ストレージ エミュレーターを使用してアプリケーションをローカルで実行およびデバッグするサービス構成と、Azure にアプリケーションを発行する別のサービス構成を使用できます。 サービス構成の詳細については、次を参照してください。 [を構成する、Azure プロジェクトを使用して複数のサービス構成](vs-azure-tools-multiple-services-project-configurations.md)します。

### ストレージ アカウントが提供するサービスを使用するようアプリケーションを構成するには

1. Visual Studio で Azure ソリューションを開きます。 ソリューション エクスプ ローラーでストレージ サービスにアクセスする Azure プロジェクトの各ロールのショートカット メニューを開き、選択 **プロパティ**します。 ロールの名前のページが、Visual Studio エディターに表示されます。 ページのフィールドに表示されます、 **構成** ] タブをクリックします。

1. ロールのプロパティ ページで選択 **設定**します。

1.  **サービス構成** ボックスの一覧で、編集するサービスの構成の名前を選択します。 すべてのこのロールのサービス構成を変更する場合は、選択できます **すべての構成**します。  サービス構成を更新する方法の詳細については、セクションを参照してください。 **のストレージ アカウント接続文字列の管理** のトピックで [Visual Studio で Azure クラウド サービスの役割を構成する](vs-azure-tools-configure-roles-for-cloud-service.md)です。

1. 接続文字列の設定を変更するには、選択、 **...** 設定の横にあるボタンをクリックします。  **ストレージ接続文字列の作成** ] ダイアログ ボックスが表示されます。

1.  **を使用して接続**, 、選択、 **サブスクリプション** オプション。

1.  **サブスクリプション** ボックスの一覧でサブスクリプションを選択します。 サブスクリプションの一覧には、する 1 つが含まれていない場合、 **発行設定のダウンロード** リンクします。

1.  **アカウント名** 一覧で、ストレージ アカウント名を選択します。 Azure Tools は .publishsettings ファイルを使用して、自動的にストレージ アカウントの資格情報を取得します。 ストレージ アカウントの資格情報を手動で指定するには、選択、 **資格情報を手動で入力された** にして、この手順を続行しています。 ストレージ アカウント名とプライマリ キーを取得できます、 [Azure 管理ポータル](http://go.microsoft.com/fwlink/p/?LinkID=213885)します。 設定を手動で、選択、ストレージ アカウントを指定したくないかどうか、 **OK** ] ダイアログ ボックスを閉じます。

1. 選択、 **ストレージ アカウントを入力して** 資格情報のリンク。

1.  **アカウント名** ボックスで、ストレージ アカウントの名前を入力します。

    >[AZURE.NOTE] 管理ポータルにログインしを選択し、 **ストレージ** ] ボタンをクリックします。 ポータルでは、ストレージ アカウントの一覧が表示されます。 アカウントを選択すると、アカウント用のページが開きます。 このページからストレージ アカウントの名前をコピーできます。 ストレージ アカウントの名前は、以前のバージョンの管理ポータルを使用している場合、 **ストレージ アカウント** 管理ポータルの表示。 この名前をコピーするには、強調、 **プロパティ** このウィンドウを表示して、ctrl キーを押しながら C キーを選択します。 Visual Studio に名前を貼り付ける、 **アカウント名** テキスト ボックス、および、ctrl キーを押しながら V キーを選択します。

1.  **アカウント キー** ボックスで、プライマリ キーを入力またはコピーして貼り付けますから、 [Azure 管理ポータル](http://go.microsoft.com/fwlink/?LinkID=213885)します。
    管理ポータルからこのキーをコピーするには:

    1. 適切なストレージ アカウントのページの下部にある、選択、 **キーの管理** ] ボタンをクリックします。

    1.  **キーのアクセスを管理** ページをプライマリ アクセス キーのテキストを選択し、ctrl キーを押しながら C キーを選択します。

    1. Azure Tools でにキーを貼り付け、 **アカウント キー** ボックス。

    1. サービスがストレージ アカウントにアクセスする方法を決定するには、次のオプションのいずれかを選択する必要があります。
        - **HTTP を使用して**します。 これは、標準的なオプションです。 たとえば、「`http://<account name>.blob.core.windows.net`」のように入力します。
        - **HTTPS を使用して** セキュリティで保護された接続。 たとえば、「`https://<accountname>.blob.core.windows.net`」のように入力します。
        - **カスタム エンドポイントの指定** 3 つのサービスごとにします。 このオプションを選択すると、特定のサービスのフィールドにエンドポイントを入力できます。

        >[AZURE.NOTE] カスタム エンドポイントを作成する場合は、複雑な接続文字列を作成できます。 この文字列形式を使用する場合は、ストレージ アカウント用に BLOB サービスに登録したカスタム ドメイン名を含むストレージ サービス　エンドポイントを指定できます。 また、Shared Access Signature を介して単一コンテナーの BLOB リソースにのみアクセスを許可できます。 カスタム エンドポイントを作成する方法の詳細については、次を参照してください。 [Azure ストレージ接続文字列の構成](storage-configure-connection-string.md)します。

1. これらの接続文字列の変更を保存する、 **[ok]** ボタンをクリックしを選択し、 **保存** ツールバーのボタンをクリックします。 これらの変更を保存すると、コードの [この接続文字列の値を取得を使用することができます [GetConfigurationSettingValue](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.getconfigurationsettingvalue.aspx)します。 Azure にアプリケーションを発行するときに、接続文字列用の Azure ストレージ アカウントを含むサービス構成を選択します。 アプリケーションを発行した後、アプリケーションが Azure Storage サービスに対して期待どおりに動作することを確認します。

## 次のステップ

アプリの発行の詳細についてを Azure に Visual Studio からを参照してください [Azure ツールを使用してクラウド サービスの発行](vs-azure-tools-publishing-a-cloud-service.md)します。

