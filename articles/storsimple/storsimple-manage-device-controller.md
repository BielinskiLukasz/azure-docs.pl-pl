<properties 
   pageTitle="StorSimple デバイス コントローラーを管理する | Microsoft Azure"
   description="StorSimple デバイス コントローラーの停止、再起動、シャットダウン、リセットの方法について説明します。"
   services="storsimple"
   documentationCenter=""
   authors="alkohli"
   manager="carolz"
   editor="" />
<tags 
   ms.service="storsimple"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="12/02/2015"
   ms.author="alkohli" />

# StorSimple デバイス コントローラーを管理する

## 概要

このチュートリアルでは、StorSimple デバイス コントローラーに対して実行できる各種の操作について説明します。 StorSimple デバイスでは、ピア コントローラーがアクティブ/パッシブ構成で冗長化されています。 特定の時点でアクティブなコントローラーは 1 台だけで、そのコントローラーがすべてのディスク操作とネットワーク操作を処理します。 その他のコントローラーはパッシブ モードになります。 アクティブなコントローラーに障害が発生すると、パッシブ コントローラーが自動的にアクティブになります。

このチュートリアルでは、以下の手段を使ってデバイス コントローラーを管理するための手順を取り上げています。

- **コント ローラー** のセクションで、 **メンテナンス** 、StorSimple Manager サービス ページ
- StorSimple 用 Windows PowerShell。 

デバイス コントローラーは、StorSimple Manager サービスを介して管理することをお勧めします。 StorSimple 用 Windows PowerShell を使用しないと実行できない操作については、チュートリアルの中で記載しています。

このチュートリアルを読むと、次のことができるようになります。

- StorSimple デバイス コントローラーを再起動またはシャットダウンする
- StorSimple デバイスをシャットダウンする
- StorSimple デバイスを出荷時の設定にリセットする


## 単一のコントローラーの再起動とシャットダウン

通常のシステム運用の中でコントローラーの再起動またはシャットダウンが必要になることはありません。 単一デバイス コントローラーのシャットダウン操作が一般的に行われるのは、障害の発生したデバイスのハードウェア コンポーネントを交換しなければならないケースです。 また、過剰なメモリの使用やコントローラーの不調などでパフォーマンスに影響が生じている状況でコントローラーの再起動が必要となる場合もあります。 無事交換したコントローラーを有効にしてテストする場合にも、コントローラーを再起動する必要があります。

デバイスを再起動しても、パッシブ コントローラーが利用できる状態にあれば、接続されているイニシエーターに悪影響は生じません。 パッシブ コントローラーが利用できない、またはオフになっている場合は、アクティブ コントローラーを再起動すると、サービスの機能不全やダウンタイムが生じます。

> [AZURE.IMPORTANT] 

> - **実行中のコントローラーを物理的に取り外すことは絶対に避けてください。冗長性が失われ、ダウンタイムのリスクが増大します。**

> - 以下の手順は、StorSimple の物理デバイスにのみ当てはまります。 開始、停止、および仮想デバイスを再起動する方法については、次を参照してください。 [仮想デバイスの作業](storsimple-virtual-device-u1.md#work-with-the-storsimple-virtual-device)します。

StorSimple Manager サービスの Azure クラシック ポータルまたは StorSimple 用 Windows PowerShell を使用して、1 つのデバイス コント ローラーを再起動またはシャットダウンすることができます。 

Azure クラシック ポータルからデバイス コントローラーを管理するには、次の手順を実行します。

#### クラシック ポータルでコントローラーを再起動またはシャットダウンするには

1. 移動 **デバイス > メンテナンス**します。

1. 移動 **ハードウェアの状態** デバイスの両方のコント ローラーの状態があることを確認および **健全**します。

    ![StorSimple デバイス コントローラーが正常であることを確認する](./media/storsimple-manage-device-controller/IC766017.png)

1. 下部にある、 **メンテナンス** ] ページで [ **コント ローラーの管理**します。

    ![StorSimple デバイス コントローラーを管理する](./media/storsimple-manage-device-controller/IC766018.png)</br>

    >[AZURE.NOTE] 表示されない場合 **コント ローラーの管理**, 、更新プログラムをインストールする必要があります。 詳細については、次を参照してください。 [StorSimple デバイスの更新](storsimple-update-device.md)します。

1.  **コント ローラーの設定を変更** ] ダイアログ ボックスで、次の操作します。


    - From the **Select Controller** drop-down list, select the controller that you want to manage. The options are Controller 0 and Controller 1. These controllers are also identified as active or passive.

        >[AZURE.NOTE] A controller cannot be managed if it is unavailable or turned off, and it will not appear in the drop-down list.
    


    - From the **Select Action** drop-down list, choose **Restart controller** or **Shut down controller**.
    
        ![Restart StorSimple device passive controller](./media/storsimple-manage-device-controller/IC766020.png)
 

    - Click the check icon ![Check Icon](./media/storsimple-manage-device-controller/IC740895.png).

これでコントローラーが再起動またはシャットダウンされます。 次の表で行った選択とその結果の詳細をまとめたものです、 **コント ローラーの設定を変更** ] ダイアログ ボックス。  
                                                    

|選択範囲 #|操作の内容|想定される結果|
|---|---|---|
|1.|パッシブ コントローラーを再起動する。|コントローラーを再起動するためのジョブが作成されます。ジョブが正常に作成されると通知されます。 このジョブによってコントローラーの再起動が開始されます。 再起動プロセスを監視するにはアクセスすることによって **サービス > ダッシュ ボード > 操作ログを表示** とし、サービスに固有のパラメーターでフィルター処理します。|
|2.|アクティブ コントローラーを再起動する。|"アクティブ コントローラーを再起動すると、デバイスがパッシブ コントローラーにフェールオーバーされます。 続行してもよろしいですか?" という警告が表示されます。 </br>次のステップがパッシブ コント ローラーを再起動するために使用と同じで操作を続行する場合は、(選択 1 を参照してください)。|
|3.|パッシブ コントローラーをシャットダウンする。|"シャットダウンが完了した後で、コントローラーの電源ボタンを押して電源をオンにする必要があります。 このコントローラーをシャットダウンしてもよろしいですか?" というメッセージが表示されます。 </br>次のステップがパッシブ コント ローラーを再起動するために使用と同じで操作を続行する場合は、(選択 1 を参照してください)。|
|4.|アクティブ コントローラーをシャットダウンする。|"シャットダウンが完了した後で、コントローラーの電源ボタンを押して電源をオンにする必要があります。 このコントローラーをシャットダウンしてもよろしいですか?" というメッセージが表示されます。 </br>次のステップがパッシブ コント ローラーを再起動するために使用と同じで操作を続行する場合は、(選択 1 を参照してください)。|


#### StorSimple 用 Windows PowerShell でコントローラーを再起動またはシャットダウンするには
StorSimple デバイスの単一のコントローラーを Azure クラシック ポータルからシャットダウンまたは再起動するには、次の手順を実行します。 


1. リモート コンピューターからシリアル コンソールまたは Telnet セッションを使ってデバイスにアクセスします。 次の手順に従って、コント ローラー 0 またはコント ローラー 1 に接続 [デバイスのシリアル コンソールに接続するための PuTTY を使用して](storsimple-deployment-walkthrough.md#use-putty-to-connect-to-the-device-serial-console)します。

1. シリアル コンソール メニューでは、オプション 1 を選択して **フル アクセスでログイン**します。

1. バナー メッセージで、接続先のコントローラーがどれであるか (コントローラー 0 またはコントローラー 1)、また、それがアクティブ コントローラーであるかパッシブ (スタンバイ) コントローラーであるかを書き留めます。
    

    - To shut down a single controller, at the prompt, type:

        `Stop-HcsController`

        This will shut down the controller that you are connected to. If you stop the active controller, then it will fail over to the passive controller before it shuts down.


    - To restart a controller, at the prompt, type:

        `Restart-HcsController`

        This will restart the controller that you are connected to. If you restart the active controller, it will fail over to the passive controller before the restart.


## StorSimple デバイスをシャットダウンする

このセクションでは、実行中の StorSimple デバイスまたは障害の発生した StorSimple デバイスをリモート コンピューターからシャットダウンする方法について説明します。 両方のデバイス コントローラーをシャットダウンすると、デバイスはオフになります。 デバイスのシャットダウンは、そのデバイスを物理的に移動するか、または運用から外すときに行います。 

> [AZURE.IMPORTANT] デバイスをシャット ダウンする前に、デバイス コンポーネントのヘルスを確認します。 移動 **デバイス > メンテナンス > ハードウェア状態** すべてのコンポーネントの LED の状態が緑色であることを確認します。 正常なデバイスのみ、緑色のステータスになります。 デバイスをシャットダウンする場合や、不調なコンポーネントを交換する場合、コンポーネントごとにエラー (赤色) または機能低下 (黄色) ステータスが表示されます。

#### StorSimple デバイスをシャットダウンするには

1. 使用して、 [再起動またはシャット ダウン、コント ローラー](#restart-or-shut-down-a-single-controller) プロシージャを識別し、デバイスのパッシブ コント ローラーをシャット ダウンします。 この操作は、Azure クラシック ポータルまたは StorSimple 用 Windows PowerShell でのみ実行できます。
2. 上の手順を繰り返してアクティブ コントローラーをシャットダウンします。
3. ここでデバイスのバックプレーンを確認する必要があります。 2 つのコントローラーが完全にシャットダウンされた後、両方のコントローラーのステータス LED が赤色に点滅しています。 この時点でデバイスの電源を完全にオフにする必要がある場合は、両方の電源/冷却モジュール (PCM) の電源スイッチをオフの位置に設定してください。 これでデバイスの電源が切れます。


<!--#### To shut down a StorSimple device in Windows PowerShell for StorSimple

1. 次の手順に従って、StorSimple デバイスのシリアル コンソールに接続 [デバイスのシリアル コンソールに接続するための PuTTY を使用して](storsimple-deployment-walkthrough.md#use-putty-to-connect-to-the-serial-console)します。

1. シリアル コンソール メニューで、パッシブ コント ローラーに接続しているコント ローラーがあるバナー メッセージを確認します。 アクティブ コント ローラーに接続している場合は、このコント ローラーから切断し、他のコント ローラーに接続します。

1. シリアル コンソール メニューでは、オプション 1 を選択して **フル アクセスでログイン**します。

1. プロンプトで、次のように入力します。

    `Stop-HCSController`

    これは、現在のコント ローラーをシャット必要があります。 シャット ダウンが完了したかどうかを確認するには、デバイスの背面を確認します。 コント ローラーのステータス LED が赤に点灯をする必要があります。

1. 手順 1. ~ 4. をアクティブなコント ローラーに接続し、シャット ダウンします。

1. 両方のコント ローラーが完全にシャット ダウンした後、両方のステータス Led が赤で点滅します。 電源および off 冷却モジュール (Pcm) の両方の電源スイッチを完全にはこの時点で、デバイスをオフにする必要がある場合の位置。--> します。

## デバイスを出荷時の設定にリセットする

ここでは、StorSimple 用 Windows PowerShell を使って、Microsoft Azure StorSimple デバイスを出荷時の設定にリセットする手順を詳しく説明しています。

Microsoft Azure StorSimple デバイスを出荷時の設定にリセットするには、次の手順に従います。

### StorSimple 用 Windows PowerShell でデバイスを既定の設定にリセットするには

1. シリアル コンソールを使ってデバイスにアクセスします。 アクティブ コントローラーに接続されていることをバナー メッセージで確認してください。

1. シリアル コンソール メニューでは、オプション 1 を選択して **フル アクセスでログイン**します。

1. プロンプトで、次のコマンドを入力します。

    `Reset-HcsFactoryDefault`

    システムが何度か再起動されます。 リセットが正常に完了すると、その旨通知されます。 このプロセスの所要時間はシステムのモデルによって異なります。8100 デバイスの場合は 45 ～ 60 分、8600 の場合は 60 ～ 90 分かかります。

    > [AZURE.TIP] 
    
    > - 前掲のファクトリ リセット コマンドレットで、"ファームウェア バージョンが一致しないため、ファクトリ リセットを続行できません" というファームウェア不一致エラーが報告された場合に、ファームウェア バージョン チェックをスキップするには、`Reset-HcsFactoryDefault –SkipFirmwareVersionCheck` コマンドを使用してください。 Microsoft Update または修正プログラムの機構を使って更新済みのデバイスに対してファクトリ リセットを実行するときは、ファームウェア チェックを (`–SkipFirmwareCheck` オプションを使用して) スキップする必要があります。
    
    > - このコマンドレットを使用する方法の詳細についてを参照してください、 [StorSimple 用 Windows PowerShell のコマンドレット リファレンス](https://technet.microsoft.com/library/dn688168.aspx)します。


## デバイス コントローラーの管理に関する FAQ

このセクションでは、StorSimple デバイス コントローラーの管理に関して、よく寄せられる質問とその答えを掲載しています。

**Q。**デバイスの両方のコントローラーが正常で電源が投入されているときに、アクティブ コントローラーを再起動またはシャットダウンした場合、どうなりますか。

**A.**デバイスの両方のコントローラーが正常で電源が投入されている場合、確認のメッセージが表示されます。 次の操作を選択できます。

- **アクティブなコント ローラーを再起動** – いるアクティブなコント ローラーを再起動すると、デバイスがパッシブ コント ローラーにフェールオーバーすると通知されます。 コントローラーが再起動されます。

- **アクティブなコント ローラーをシャット ダウン** – いるアクティブなコント ローラーをシャット ダウン ダウンタイムが発生する通知されます。 この場合、コントローラーの電源を投入するには、デバイスの電源ボタンを押す必要があります。

**Q。**デバイスのパッシブ コントローラーが利用できない、または電源が切れているときに、アクティブ コントローラーを再起動またはシャットダウンした場合はどうなりますか。

**A.**デバイスのパッシブ コントローラーが利用できない、または電源が切れている場合、次の操作を選択できます。

- **アクティブなコント ローラーを再起動** –、サービスを一時的に中断操作を行うと、その確認を求められますが通知されます。

- **アクティブなコント ローラーをシャット ダウン** – 操作を続行原因になる、ダウンタイムと、デバイスをオンにする 1 つまたは両方のコント ローラーの電源ボタンをプッシュする必要がありますが通知されます。 確認を求められます。

**Q。**コントローラーの再起動またはシャットダウンに失敗するのはどのようなときでしょうか。

**A.**次の場合、コントローラーの再起動またはシャットダウンに失敗します。

- デバイスの更新が進行中であるとき。

- コントローラーの再起動が既に進行中であるとき。

- コントローラーのシャットダウンが既に進行中であるとき。

**Q。**コントローラーが再起動されたかどうかやシャットダウンされたかどうかは、どのようにして確認できるでしょうか。

**A.**コントローラーのステータスは、[メンテナンス] ページで確認できます。 コントローラーが再起動またはシャットダウンされたことは、コントローラーのステータスで把握できます。 コントローラーが再起動またはシャットダウンされた場合、[アラート] ページにも情報案内アラートが表示されます。 また操作ログにも、コントローラーの再起動操作とシャットダウン操作が記録されます。 操作ログの詳細についてを参照してください [操作ログの表示](storsimple-service-dashboard.md#view-the-operations-logs)します。

**Q。**コントローラーのフェールオーバーは I/O に影響しますか。

**A.**コントローラーがフェールオーバーされるとイニシエーターとアクティブ コントローラー間の TCP 接続がリセットされますが、パッシブ コントローラーが操作を引き継ぐときに、接続が再度確立されます。 この操作の過程でイニシエーターとデバイス間の I/O アクティビティが一時的 (30 秒未満) に停止する場合があります。

**Q。**シャットダウンして運用から除外したコントローラーを再び運用状態に戻すにはどうすればよいでしょうか。

**A.**サービスに、コント ローラーを取得する必要がありますに挿入するシャーシ」の説明に従って [StorSimple デバイスのコント ローラー モジュールを交換して](storsimple-controller-replacement.md)します。

## 次のステップ

- このチュートリアルで紹介した手順を使用して解決できない StorSimple デバイス コント ローラーで、問題が発生した場合 [Microsoft サポートにお問い合わせ](storsimple-contact-microsoft-support.md)します。

- StorSimple Manager サービスの使用に関する詳細についてをするには [StorSimple Manager サービスを使用して、StorSimple デバイスを管理する](storsimple-manager-service-administration.md)です。
