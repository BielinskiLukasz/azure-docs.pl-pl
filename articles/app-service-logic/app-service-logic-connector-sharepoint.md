<properties
   pageTitle="Logic Apps での SharePoint コネクタの使用 | Microsoft Azure App Service"
   description="SharePoint コネクタまたは API アプリを作成、構成して、Azure App Service のロジック アプリで使用する方法"
   services="app-service\logic"
   documentationCenter=".net,nodejs,java"
   authors="anuragdalmia"
   manager="dwrede"
   editor=""/>

<tags
   ms.service="app-service-logic"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration"
   ms.date="11/30/2015"
   ms.author="sameerch"/>


# SharePoint コネクタの使用を開始して、SharePoint コネクタをロジック アプリに追加する

SharePoint Server または SharePoint Online に接続して、ドキュメントやリスト項目を管理します。 さらに、ドキュメントやリスト項目の作成、更新、取得、削除などの操作を実行できます。 オンプレミスの SharePoint サーバーを使用する場合は、コネクタの構成の一部として Service Bus 接続文字列を入力し、サーバーに接続するオンプレミスのリスナー エージェントをインストールすることができます。

SharePoint Online コネクタおよび SharePoint Server コネクタ ギャラリー アプリでは、SharePoint とやり取りするメカニズムとしてトリガーとアクションを使用できます。

ロジック アプリはさまざまなデータ ソースを基にトリガーでき、フローの一環としてデータの取得と処理のためのコネクタを提供します。 この SharePoint コネクタをビジネス ワークフローに追加し、ロジック アプリ内のそのワークフローの一部としてデータを処理できます。

## SharePoint Online コネクタの作成

コネクタは、ロジック アプリ内で作成することも、Azure Marketplace から直接作成することもできます。 Marketplace からコネクタを作成するには、次の操作を実行します。

1. Azure のスタート画面で、**[Marketplace]** を選択します。
2. **[API Apps]** を選択し、"SharePoint Online コネクタ" を検索します。
3. 名前、App Service プラン、その他のプロパティを入力します。
4. 次のパッケージの設定を入力します。

    名前| 必須| 説明
--- | --- | ---
 サイトの URL| はい| SharePoint Web サイトの完全な URL を入力します。たとえば、入力: *https://microsoft.sharepoint.com/teams/wabstest*します。
 ドキュメント ライブラリ / リストの相対 URL| はい| コネクタが変更を加えることが許可されるドキュメント ライブラリまたはリストの URL を、SharePoint サイトの URL からの相対位置で入力します。たとえば、「*Lists/Task, Shared Documents*」のように入力します。

5. 完了すると、パッケージの設定は、次のようになります。  
![][1]

上記の手順を完了すると、同じリソース グループ内に SharePoint Online コネクタを使用するロジック アプリを作成できます。

## SharePoint Server コネクタの作成

コネクタは、ロジック アプリ内で作成することも、Azure Marketplace から直接作成することもできます。 Marketplace からコネクタを作成するには、次の操作を実行します。

1. Azure のスタート画面で、**[Marketplace]** を選択します。
2. **[API Apps]** を選択し、"SharePoint Server コネクタ" を検索します。
3. 名前、App Service プラン、その他のプロパティを入力します。
4. 次のパッケージの設定を入力します。

    名前| 必須| 説明
--- | --- | ---
 サイトの URL| はい| SharePoint Web サイトの完全な URL を入力します。たとえば、入力: *https://microsoft.sharepoint.com/teams/wabstest*します。
 認証モード| あり| SharePoint サイトに接続する認証モードを入力します。オプションがあります:<ul><li>既定</li><li>WindowsAuthentication</li><li>FormBasedAuthentication</li></ul><br/><br/>既定] を選択する場合は、SharePoint コネクタを実行している資格情報が使用されます。ユーザー名とパスワードは必要ありません。ユーザー名とパスワードは、その他の認証の種類に必要なのです。<br/><br/>**注** 匿名認証がサポートされていません。
 ユーザー名| いいえ| 認証モードが [既定] でない場合は、SharePoint サイトへの接続に使用する有効なユーザー名を入力します。
 パスワード| いいえ| 認証モードが既定ではない場合は、SharePoint サイトに接続する有効なパスワードを入力します。
 ドキュメント ライブラリ / リストの相対 URL| はい| コネクタが変更を加えることが許可されるドキュメント ライブラリまたはリストの URL を、SharePoint サイトの URL からの相対位置で入力します。たとえば、「*Lists/Task, Shared Documents*」のように入力します。
 Service Bus の接続文字列| いいえ| オンプレミスに接続する場合は、Service Bus relay の接続文字列を入力します。<br/><br/>[Using the Hybrid Connection Manager](app-service-logic-hybrid-connection-manager.md)<br/>[Service Bus Pricing](http://azure.microsoft.com/pricing/details/service-bus/)

5. 完了すると、パッケージの設定は、次のようになります。  
![][2]

作業が完了すると、同じリソース グループ内に SharePoint Server コネクタを使用するロジック アプリを作成できます。


## Logic App での SharePoint コネクタの使用

API アプリを作成すると、ロジック アプリのトリガーやアクションとして SharePoint コネクタを使用できます。 そのためには、次の手順を実行する必要があります。

1. 新しい Logic App を作成し、SharePoint コネクタが含まれるリソース グループを選択します。

2. **[トリガーとアクション]** を開き、Logic Apps デザイナーを開いてワークフローを構成します。 右側のギャラリーの [最近使用した項目] セクションに、SharePoint コネクタが表示されます。 それを選択します。

3. ロジック アプリの先頭で SharePoint コネクタを選択した場合、SharePoint コネクタはトリガーとして動作します。 それ以外の場合は、コネクタを使用する SharePoint アカウントに対するアクションとして動作します。

4. SharePoint Online コネクタを使用している場合は、ユーザーの代わりに操作を実行するロジック アプリの認証と承認を行います。 承認を開始するにはクリックして **Authorize** SharePoint コネクタの。  
![][3]

5. [承認] をクリックすると SharePoint の認証ダイアログ ボックスが開きます。 操作を実行する SharePoint アカウントの詳細情報に、記号を入力します。  
![][4]

6. あなたの代わりに操作を実行するアカウントにロジック アプリのアクセスを付与します。  
![][5]

7. SharePoint コネクタがトリガーとして構成されている場合は、そのトリガーが表示されます。 それ以外の場合、アクションの一覧が表示され、適切な操作を実行することができます。  
![][6]

**ドキュメント ライブラリの構成された相対 URL**  
![][7]

**ドキュメント リスト用に構成された相対 URL**
> [AZURE.NOTE]次のトリガーでは、コネクタのパッケージ設定で "Shared Documents, Lists/Task" を入力したものと想定しています。ここで、"Shared Documents" はドキュメント ライブラリ、"Lists/Task" はリストです。 

## トリガー

ロジック アプリを開始する場合は、トリガーを使用します。
> [AZURE.NOTE] トリガーはファイルの読み込み後、そのファイルを削除します。 ファイルを保持するには、アーカイブの場所の値を入力します。

### 1.Shared Documents 内の新しいドキュメント (JSON)

このトリガーは、"Shared Documents" 内で新しいドキュメントが利用可能になると発生します。


#### 入力

 名前| 必須| 説明
--- | --- | ---
 ビュー名| いいえ| 取得するドキュメントのフィルター処理に使用する有効なビューを入力します。たとえば、「Approved Orders」と入力します。既存のすべてのドキュメントを処理するには、このフィールドを空のままにします。
 アーカイブの場所| いいえ| 処理されたドキュメントのアーカイブ先の有効なフォルダー URL を、SharePoint サイトの相対位置で入力します。
 アーカイブで上書きする| いいえ| アーカイブのパスにファイルが既に存在する場合にファイルを上書きするには、このオプションをオンにします。
 CAML クエリ| いいえ。詳細設定| ドキュメントをフィルター処理するための、有効な CAML クエリを入力します。たとえば、入力:  `< 場所 >< Geq >< FieldRef 名 = 'ID'/>< 値の型 = 'Number' > 10 </value ></Geq ></で >`

#### 出力

 名前| 説明
--- | ---
 名前| ドキュメントの名前。
 コンテンツ| ドキュメントのコンテンツ。
 ContentTransferEncoding| メッセージのコンテンツ転送エンコード。("none"または"base64")

**注** ドキュメント項目のすべての列が "Advanced" 出力プロパティに表示されます。


### 2.Tasks の新しい項目 (JSON)

このトリガーは、"Tasks" リストに新しい項目が追加されると発生します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ビュー名| いいえ| リスト内の項目のフィルター処理に使用する有効なビューを入力します。たとえば、「Approved Orders」と入力します。新しい項目をすべて処理するには、このフィールドを空のままにします。
 アーカイブの場所| いいえ| 処理されたリスト項目のアーカイブ先の有効なフォルダー URL を、SharePoint サイトの相対位置で入力します。
 CAML クエリ| いいえ。詳細設定| ドキュメントをフィルター処理するための、有効な CAML クエリを入力します。たとえば、入力:  `< 場所 >< Geq >< FieldRef 名 = 'ID'/>< 値の型 = 'Number' > 10 </value ></Geq ></で >`

#### 出力

 名前| 説明
--- | ---
 リスト内の列は、動的に設定され、出力パラメーターに表示されます。| &nbsp;


### 3.Shared Documents 内の新しいドキュメント (XML)

このトリガーは、"Shared Documents" 内で新しいドキュメントが利用可能になると発生します。 新しいドキュメントが XML メッセージとして返されます。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ビュー名| いいえ| 取得するドキュメントのフィルター処理に使用する有効なビューを入力します。たとえば、「Approved Orders」と入力します。既存のドキュメントをすべて処理するには、このフィールドを空のままにします。
 アーカイブの場所| いいえ| 処理されたリスト ドキュメントのアーカイブ先の有効なフォルダー URL を、SharePoint サイトの相対位置で指定します。
 アーカイブで上書きする| いいえ| アーカイブのパスにファイルが既に存在する場合にファイルを上書きするには、このオプションをオンにします。
 CAML クエリ| いいえ。詳細設定| ドキュメントをフィルター処理するための、有効な CAML クエリを入力します。たとえば、入力:  `< 場所 >< Geq >< FieldRef 名 = 'ID'/>< 値の型 = 'Number' > 10 </value ></Geq ></で >`

#### 出力

 名前| 説明
--- | ---
 コンテンツ| ドキュメントのコンテンツ。
 ContentTransferEncoding| メッセージのコンテンツ転送エンコード。("none"または"base64")


### 4.Tasks の新しい項目 (XML)

このトリガーは、"Tasks" リストに新しい項目が追加されると発生します。 新しいリスト項目が XML メッセージとして返されます。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ビュー名| いいえ| リスト内の項目のフィルター処理に使用する有効なビューを入力します。例: "Approved Orders"。すべての新しい項目を処理するには、このフィールドを空のままにします。
 アーカイブの場所| いいえ| 処理されたリスト項目のアーカイブ先の有効なフォルダー URL を、SharePoint サイトの相対位置で入力します。
 CAML クエリ| いいえ。詳細設定| リスト項目をフィルター処理するための、有効な CAML クエリを入力します。たとえば、入力: `< 場所 >< Geq >< FieldRef 名 = 'ID'/>< 値の型 = 'Number' > 10 </value ></Geq ></で >`

#### 出力

 名前| 説明
--- | ---
 コンテンツ| ドキュメントのコンテンツ。
 ContentTransferEncoding| メッセージのコンテンツ転送エンコード。("none"または"base64")


## アクション

次のアクションでは、コネクタのパッケージ設定で "Shared Documents, Lists/Task" を入力したものと想定しています。ここで、"Shared Documents" はドキュメント ライブラリ、"Lists/Task" はリストです。


### 1.Shared Documents にアップロード (JSON)

このアクションは、新しいドキュメントを "Shared Documents" にアップロードします。 入力は、ドキュメント ライブラリのすべての列フィールドを含む、厳密に型指定された JSON オブジェクトです。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 名前| あり| ドキュメントの名前。
 コンテンツ| あり| ドキュメントのコンテンツ。
 ContentTransferEncoding| あり| メッセージのコンテンツ転送エンコード。("none"または"base64")
 強制的に上書きする| あり| TRUE に設定した場合、指定された名前のドキュメントが存在したときにドキュメントが上書きされます。
 ReqParam1*| あり| ドキュメント ライブラリにドキュメントを追加するための必須パラメーターの 1 つです。
 ReqParam2*| あり| ドキュメント ライブラリにドキュメントを追加するための必須パラメーターの 1 つです。
 OptionalParam1*| 番号詳細| ドキュメント ライブラリにドキュメントを追加するためのオプション パラメーターの 1 つです。
 OptionalParam2*| 番号詳細| ドキュメント ライブラリにドキュメントを追加するためのオプション パラメーターの 1 つです。

**注** ドキュメント ライブラリのすべてのパラメーターは動的に設定されます。 必須パラメーターは表示されていますが、オプションのパラメーターは詳細設定セクションに配置されています。

#### 出力

 名前| 説明
--- | ---
 ItemId| ドキュメント ライブラリに追加されたドキュメントの ItemId。
 状態| ドキュメントが正常にアップロードされると、状態コード 200 (OK) が返されます。




### 2.Shared Documents から取得 (JSON)

このアクションは、相対 URL (フォルダー構造) で指定されたドキュメントをドキュメント ライブラリから取得します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ドキュメントの相対 URI| いいえ| ドキュメントの URL を "Shared Documents" の相対位置で入力します。たとえば、「*myspec1,myfolder/orders*」のように入力します。

#### 出力

 名前| 説明
--- | ---
 コンテンツ| ドキュメントのコンテンツ
 ContentTransferEncoding| メッセージのコンテンツ転送エンコード。("none"または"base64")
 状態| アクションが正常に実行されると、状態コード 200 (OK) が返されます。
 Param1*| ドキュメント ライブラリ内のドキュメントの必須パラメーターの 1 つです。
 Param2*| ドキュメント ライブラリ内のドキュメントの必須パラメーターの 1 つです。

**注** ドキュメント ライブラリのすべてのパラメーターは動的に設定されます。 また、これらは詳細設定セクションにあります。



### 3.Shared Documents から削除

このアクションは、相対 URL (フォルダー構造) で指定されたドキュメントをドキュメント ライブラリから削除します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ドキュメントの相対 URI| いいえ| ドキュメントの URL を "Shared Documents" の相対位置で入力します。たとえば、「*myspec1,myfolder/orders*」のように入力します。

#### 出力

 名前| 説明
--- | ---
 状態| アクションが正常に実行されると、状態コード 200 (OK) が返されます。


### 4.Tasks への挿入 (JSON)

このアクションは、項目リストに項目を追加します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ReqParam1*| あり| リストに項目を追加するための必須パラメーターの 1 つです。
 ReqParam2*| あり| リストに項目を追加するための必須パラメーターの 1 つです。
 OptionalParam1*| 番号詳細| リストに項目を追加するための必須パラメーターの 1 つです。
 OptionalParam2*| 番号詳細| リストに項目を追加するための必須パラメーターの 1 つです。

**注** "List" のすべてのパラメーターは動的に設定されます。 必須パラメーターは表示されていますが、オプションのパラメーターは詳細設定セクションに配置されています。

#### 出力

 名前| 説明
--- | ---
 ItemId| 追加されたリスト項目の ItemId。
 状態| リスト項目が正常に挿入されると、状態コード 200 (OK) が返されます。


### 5.Tasks を更新 (JSON)

このアクションは、項目リストの項目を更新します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ItemId| あり| リスト項目の ItemId。
 ReqParam1*| いいえ| リストに項目を追加するための必須パラメーターの 1 つです。
 ReqParam2*| いいえ| リストに項目を追加するための必須パラメーターの 1 つです。
 OptionalParam1*| 番号詳細| リストに項目を追加するための必須パラメーターの 1 つです。
 OptionalParam2*| 番号詳細| リストに項目を追加するための必須パラメーターの 1 つです。

**注**  "List"のすべてのパラメーターが動的に設定されます。 必須パラメーターは表示されていますが、オプションのパラメーターは詳細設定セクションに配置されています。

#### 出力

 名前| 説明
--- | ---
 状態| リスト項目が正常に更新されると、状態コード 200 (OK) が返されます。


### 6.Tasks から項目を取得 (JSON)

このアクションは、項目リストから項目を取得します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ItemId| あり| リスト項目の ItemId。

#### 出力

 名前| 説明
--- | ---
 Column1*| リストのパラメーターの 1 つです。
 Column2*| リストのパラメーターの 1 つです。
 状態| アクションが正常に実行されると、状態コード 200 (OK) が返されます。

**注** リスト内の列は、動的に設定され、出力パラメーターに表示されます。


### 7.Tasks から項目を削除

このアクションは、項目リストから項目を削除します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ItemId| あり| リスト項目の ItemId。

#### 出力

 名前| 説明
--- | ---
 状態| リスト項目が正常に削除されると、状態コード 200 (OK) が返されます。


### 8.Shared Documents 内のドキュメントの一覧を取得 (JSON)

このアクションは、ドキュメント ライブラリ内のすべてのドキュメントの一覧を取得します。 View または CAML クエリを使用してドキュメントをフィルター選択できます。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ビュー名| いいえ| 取得するドキュメントのフィルター処理に使用する有効なビューを入力します。たとえば、「Approved Orders」と入力します。既存のすべてのドキュメントを処理するには、このフィールドを空のままにします。
 CAML クエリ| いいえ| ドキュメントをフィルター処理するための、有効な CAML クエリを入力します。たとえば、入力:  `< 場所 >< Geq >< FieldRef 名 = 'ID'/>< 値の型 = 'Number' > 10 </value ></Geq ></で >`

#### 出力

 名前| 説明
--- | ---
 ドキュメント| すべてのドキュメントの配列。各ドキュメントは、次のフィールド: <ul><li>をドキュメント</li><li>名</li><li>項目 Id</li><li>項目の完全な URL</li><li>詳細</li><li>項目編集 URL</li><li>リスト名</li><li>リストの完全な URL</li></ul>
 状態| リスト項目が正常に挿入されると、状態コード 200 (OK) が返されます。


### 9.Shared Documents にアップロード (XML)

このアクションは、新しいドキュメントを "Shared Documents" にアップロードします。 入力ドキュメントは XML ペイロードである必要があります。 アクションの応答は XML ペイロードになります。


#### 入力

 名前| 必須| 説明
--- | --- | ---
 名前| あり| ドキュメントの名前。
 コンテンツ| あり| ドキュメントのコンテンツ。
 ContentTransferEncoding| はい| メッセージのコンテンツ転送エンコード。("none"または"base64")
 強制的に上書きする| はい| TRUE に設定した場合、指定された名前のドキュメントが存在したときにドキュメントが上書きされます。


#### 出力

 名前| 説明
--- | ---
 出力 XML| アップロード アクションの応答 (XML 形式)。
 状態| ドキュメントが正常にアップロードされると、状態コード 200 (OK) が返されます。

### 10.Shared Documents から取得 (XML)

このアクションは、相対 URL (フォルダー構造) で指定されたドキュメントをドキュメント ライブラリから取得します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ドキュメントの相対 URI| いいえ| ドキュメントの URL を "Shared Documents" の相対位置で入力します。たとえば、「*myspec1,myfolder/orders*」のように入力します。
 ファイルの種類| はい| ファイルがバイナリ ファイルであるかテキスト ファイルであるかを入力します。

#### 出力

 名前| 説明
--- | ---
 出力 XML| ドキュメントのコンテンツ
 ContentTransferEncoding| メッセージのコンテンツ転送エンコード。("none"または"base64")
 状態| アクションが正常に実行されると、状態コード 200 (OK) が返されます。

### 11.Tasks への挿入 (XML)

このアクションは、項目リストに項目を追加します。 入力は XML ペイロードである必要があります。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 入力 XML| あり| 挿入するリスト項目のフィールドの値が含まれた XML メッセージ。変換 API App を使用して、XML メッセージを生成できます。

**注** "List" のすべてのパラメーターは動的に設定されます。 必須パラメーターは表示されていますが、オプションのパラメーターは詳細設定セクションに配置されています。

#### 出力

 名前| 説明
--- | ---
 ItemId| 追加されたリスト項目の ItemId。
 状態| リスト項目が正常に挿入されると、状態コード 200 (OK) が返されます。


### 12.Tasks を更新 (XML)

このアクションは、項目リストの項目を更新します。 入力は XML ペイロードである必要があります。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ItemID| はい| リスト項目の ItemId。
 入力 XML| あり| 挿入するリスト項目のフィールドの値が含まれた XML メッセージ。変換 API App を使用して、XML メッセージを生成できます。

**注** "List" のすべてのパラメーターは動的に設定されます。 必須パラメーターは表示されていますが、オプションのパラメーターは詳細設定セクションに配置されています。

#### 出力

 名前| 説明
--- | ---
 状態| リスト項目が正常に更新されると、状態コード 200 (OK) が返されます。


### 13.Tasks から項目を取得 (XML)

このアクションは、項目リストから項目を取得します。

#### 入力

 名前| 必須| 説明
--- | --- | ---
 ItemID| はい| リスト項目の ItemId。

#### 出力

 名前| 説明
--- | ---
 出力 XML| 選択されたリスト項目のフィールドの値が含まれた XML メッセージ。
 状態| アクションが正常に実行されると、状態コード 200 (OK) が返されます。


## ハイブリッド構成 (省略可能)

> [AZURE.NOTE] この手順は、ファイアウォールの背後にあるオンプレミスの SharePoint を使用する場合のみ必要があります。

App Service では、 ハイブリッド構成マネージャーを使用して、オンプレミス システムに安全に接続します。 コネクタでオンプレミスの SharePoint Server を使用する場合は、ハイブリッド接続マネージャーが必要です。

参照してください [Hybrid Connection Manager を使用して](app-service-logic-hybrid-connection-manager.md)します。

## コネクタでできること

コネクタが作成されたため、ロジック アプリを使用してコネクタをビジネス ワークフローに追加できます。 を参照してください [Logic Apps とは?](app-service-logic-what-are-logic-apps.md).
>[AZURE.NOTE] Azure Logic Apps と Azure アカウントにサインアップする前に開始する場合に、 [ロジック アプリを実行してください](https://tryappservice.azure.com/?appservice=logic), 、App Service で有効期間の短いスターター ロジック アプリをすぐに作成する場所です。 このサービスの利用にあたり、クレジット カードは必要ありません。契約も必要ありません。

表示、Swagger の REST API リファレンス [コネクタと API Apps のリファレンス](http://go.microsoft.com/fwlink/p/?LinkId=529766)します。

パフォーマンス統計をレビューし、コネクタに対するセキュリティを制御することもできます。 参照してください [管理と監視 API アプリとコネクタの](app-service-api-manage-in-portal.md)します。




[1]: ./media/app-service-logic-connector-sharepoint/image_0.png 
[2]: ./media/app-service-logic-connector-sharepoint/image_1.png 
[3]: ./media/app-service-logic-connector-sharepoint/image_2.png 
[4]: ./media/app-service-logic-connector-sharepoint/image_3.png 
[5]: ./media/app-service-logic-connector-sharepoint/image_4.jpg 
[6]: ./media/app-service-logic-connector-sharepoint/image_5.png 
[7]: ./media/app-service-logic-connector-sharepoint/image_6.png 

