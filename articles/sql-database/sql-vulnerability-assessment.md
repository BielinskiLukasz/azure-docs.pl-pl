---
title: Ocena luk w zabezpieczeniach SQL
description: Dowiedz się, jak skonfigurować ocenę luk w zabezpieczeniach SQL w bazie danych SQL azure i zinterpretować raporty oceny.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: mibar
ms.author: mibar
ms.reviewer: vanto, carlrab
ms.date: 04/19/2020
tags: azure-synapse
ms.openlocfilehash: 80629898b56f81fc738cb30df63766ea39adea6d
ms.sourcegitcommit: acb82fc770128234f2e9222939826e3ade3a2a28
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/21/2020
ms.locfileid: "81684248"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>Ocena luk w zabezpieczeniach sql pomaga zidentyfikować luki w zabezpieczeniach bazy danych

Ocena luk w zabezpieczeniach SQL to łatwa do skonfigurowania usługa, która może wykrywać, śledzić i pomagać w korygowania potencjalnych luk w zabezpieczeniach bazy danych. Dzięki niej można aktywnie zwiększać poziom bezpieczeństwa bazy danych.

Ocena luk w zabezpieczeniach jest częścią oferty [Advanced Data Security,](sql-database-advanced-data-security.md) która jest ujednoliconym pakietem dla zaawansowanych funkcji zabezpieczeń SQL. Ocena luk w zabezpieczeniach jest dostępna za pośrednictwem centralnego portalu SQL Advanced Data Security portal.

> [!NOTE]
> Ocena luk w zabezpieczeniach jest obsługiwana w przypadku usługi Azure SQL Database, wystąpienia zarządzanego usługi Azure SQL Database i usługi Azure Synapse Analytics. Dla uproszczenia bazy danych SQL jest używany w tym artykule, gdy odnosi się do dowolnej z tych usług zarządzanej bazy danych.

## <a name="vulnerability-assessment"></a>Ocena luk w zabezpieczeniach

Ocena luk w zabezpieczeniach SQL to usługa zapewniająca wgląd w stan zabezpieczeń. Ocena luk w zabezpieczeniach obejmuje czynności umożliwiające podjęcie działań w celu rozwiązania problemów z zabezpieczeniami i zwiększenia bezpieczeństwa bazy danych. Może ci pomóc: 

- Spełniaj wymagania dotyczące zgodności, które wymagają raportów skanowania bazy danych.
- Spełniaj standardy ochrony danych.
- Monitoruj dynamiczne środowisko bazy danych, w którym zmiany są trudne do śledzenia.

Ocena luk w zabezpieczeniach to usługa skanowania wbudowana w usługę Azure SQL Database. Usługa wykorzystuje bazę wiedzy reguł, które flagi luk w zabezpieczeniach. Wyróżnia odchylenia od najlepszych rozwiązań, takich jak błędne konfiguracje, nadmierne uprawnienia i niechronione dane poufne.

Reguły są oparte na najlepszych praktykach firmy Microsoft i koncentrują się na problemach z zabezpieczeniami, które stanowią największe zagrożenia dla bazy danych i jej cennych danych. Obejmują one problemy na poziomie bazy danych i problemy z zabezpieczeniami na poziomie serwera, takie jak ustawienia zapory serwera i uprawnienia na poziomie serwera. Zasady te reprezentują również wiele wymogów różnych organów regulacyjnych w celu spełnienia ich standardów zgodności.

Wyniki skanowania obejmują czynności, które można wykonać, aby rozwiązać każdy problem i zapewnić dostosowane skrypty korygujące, w stosownych przypadkach. Raport oceny dla środowiska można dostosować, ustawiając akceptowalną linię bazową dla:
* Konfiguracje uprawnień.
* Konfiguracje funkcji.
* Ustawienia bazy danych.

## <a name="implement-vulnerability-assessment"></a>Wdrażanie oceny luk w zabezpieczeniach

W poniższych krokach zaimplementowano ocenę luk w zabezpieczeniach bazy danych SQL.

### <a name="1-run-a-scan"></a>1. Uruchom skanowanie

W okienku usługi Azure SQL Database w nagłówku **Zabezpieczenia** wybierz pozycję **Zaawansowane zabezpieczenia danych**. Następnie kliknij pozycję **Wybierz magazyn** w okienku Ocena luk w **zabezpieczeniach,** aby otworzyć okienko ustawień oceny luk w zabezpieczeniach dla całego serwera SQL.

Skonfiguruj konto magazynu, na którym będą przechowywane wyniki skanowania dla wszystkich baz danych na serwerze. Aby uzyskać informacje o kontach magazynu, zobacz [Informacje o kontach magazynu platformy Azure](../storage/common/storage-create-storage-account.md). Po skonfigurowaniu magazynu wybierz **opcję Skanuj,** aby przeskanować bazę danych w poszukiwaniu luk w zabezpieczeniach.

![Skanowanie bazy danych](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > Skanowanie jest lekkie i bezpieczne. To trwa kilka sekund, aby uruchomić i jest całkowicie tylko do odczytu. Nie wprowadzać żadnych zmian w bazie danych.

### <a name="2-view-the-report"></a>2. Wyświetl raport

Po zakończeniu skanowania raport skanowania jest automatycznie wyświetlany w witrynie Azure portal. Raport przedstawia przegląd stanu zabezpieczeń. W nim wymieniono liczbę znalezionych problemów i ich odpowiednie nasilenie. Wyniki obejmują ostrzeżenia dotyczące odchyleń od najlepszych rozwiązań i migawkę ustawień związanych z zabezpieczeniami, takich jak podmioty bazy danych i role oraz skojarzone z nimi uprawnienia. Raport skanowania zawiera również mapę poufnych danych wykrytych w bazie danych. Zawiera zalecenia dotyczące klasyfikacji tych danych przy użyciu [odnajdowania i klasyfikacji danych.](sql-database-data-discovery-and-classification.md)

![Wyświetl raport](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. Analizowanie wyników i rozwiązywanie problemów

Przejrzyj wyniki i określ wyniki w raporcie, które są prawdziwymi problemami z zabezpieczeniami w Twoim środowisku. Przejdź do szczegółów do każdego wyniku nie powiodło się, aby zrozumieć wpływ znalezienia i dlaczego każdy sprawdzanie zabezpieczeń nie powiodło się. Aby rozwiązać problem, użyj informacji korygowania z zasłyniczenia, które można podjąć pod warunkiem podjęcia działań.

![Analizowanie raportu](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Ustaw punkt odniesienia

Podczas przeglądania wyników oceny można oznaczyć określone wyniki jako akceptowalną *linię bazową* w danym środowisku. Linia bazowa jest zasadniczo dostosowanie sposobu, w jaki wyniki są zgłaszane. Wyniki zgodne z linią bazową są uważane za przekazywanie w kolejnych skanach. Po ustanowieniu stanu zabezpieczeń według linii bazowej ocena luk w zabezpieczeniach zgłasza tylko odchylenia od linii bazowej. W ten sposób możesz skupić swoją uwagę na istotnych kwestiach.

![Ustawianie planu bazowego](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. Uruchom nowe skanowanie, aby wyświetlić dostosowany raport śledzenia

Po zakończeniu konfigurowania **planu bazowego reguły**uruchom nowe skanowanie, aby wyświetlić dostosowany raport. Ocena luk w zabezpieczeniach zgłasza teraz tylko problemy z zabezpieczeniami, które odbiegają od zatwierdzonego stanu bazowego.

![Wyświetlanie dostosowanego raportu](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

Ocena luk w zabezpieczeniach może być teraz używana do monitorowania, czy baza danych utrzymuje wysoki poziom zabezpieczeń przez cały czas i że zasady organizacyjne są spełnione. Jeśli wymagane są raporty zgodności, raporty oceny luk w zabezpieczeniach mogą być pomocne w ułatwieniu procesu zgodności.

### <a name="6-set-up-periodic-recurring-scans"></a>6. Konfigurowanie okresowych skanów cyklicznych

Przejdź do ustawień oceny luk w zabezpieczeniach, aby włączyć **okresowe skanowanie cykliczne**. To ustawienie konfiguruje ocenę luk w zabezpieczeniach do automatycznego uruchamiania skanowania w bazie danych raz w tygodniu. Podsumowanie wyników skanowania jest wysyłane na adresy e-mail, które podajesz.

![Wyświetlanie dostosowanego raportu](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. Wywóz sprawozdania z oceny

Wybierz **pozycję Eksportuj wyniki skanowania,** aby utworzyć raport programu Excel do pobrania z wyniku skanowania. Ten raport zawiera kartę podsumowania, na którym jest wyświetlane podsumowanie oceny. Raport zawiera wszystkie nieudane kontrole. Zawiera również **karty Wyniki,** która zawiera pełny zestaw wyników ze skanowania. Wyniki obejmują wszystkie kontrole, które zostały uruchomione i szczegóły wyników dla każdego.

### <a name="8-view-scan-history"></a>8. Wyświetl historię skanowania

Wybierz **pozycję Historia skanowania** w okienku Ocena luk w zabezpieczeniach, aby wyświetlić historię wszystkich skanów wcześniej uruchomionych w tej bazie danych. Wybierz konkretne skanowanie na liście, aby wyświetlić szczegółowe wyniki tego skanowania.

Ocena luk w zabezpieczeniach może być teraz używana do monitorowania, czy baza danych utrzymuje wysoki poziom zabezpieczeń przez cały czas i że zasady organizacyjne są spełnione. Jeśli wymagane są raporty zgodności, raporty oceny luk w zabezpieczeniach mogą być pomocne w ułatwieniu procesu zgodności.

## <a name="manage-vulnerability-assessments-by-using-azure-powershell"></a>Zarządzanie ocenami luk w zabezpieczeniach przy użyciu programu Azure PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Moduł usługi PowerShell Azure Resource Manager jest nadal obsługiwany przez usługę Azure SQL Database, ale wszystkie przyszłe prace rozwojowe są przeznaczone dla modułu Az.Sql. Aby uzyskać następujące polecenia cmdlet, zobacz [AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Argumenty dla poleceń w module Az i w modułach AzureRm są zasadniczo identyczne.

Polecenia cmdlet programu Azure PowerShell można używać do programowego zarządzania ocenami luk w zabezpieczeniach. Obsługiwane polecenia cmdlet to:

| Nazwa polecenia cmdlet jako łącze | Opis |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Czyści linię bazową reguły oceny luk w zabezpieczeniach.<br/>Najpierw ustaw linię bazową przed użyciem tego polecenia cmdlet, aby ją wyczyścić. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Czyści ustawienia oceny luk w zabezpieczeniach bazy danych. |
| [Konwersja-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Konwertuje wyniki skanowania oceny luk w zabezpieczeniach na plik programu Excel. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Pobiera linię bazową reguły oceny luk w zabezpieczeniach dla danej reguły. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Pobiera wszystkie rekordy skanowania oceny luk w zabezpieczeniach skojarzone z daną bazą danych. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Zwraca ustawienia oceny luk w zabezpieczeniach bazy danych. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Ustawia linię bazową reguły oceny luk w zabezpieczeniach. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Uruchamia rozpoczęcie skanowania oceny luk w zabezpieczeniach. |
| [Aktualizacja-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Aktualizuje ustawienia oceny luk w zabezpieczeniach bazy danych. |
| &nbsp; | &nbsp; |

Na przykład skryptu zobacz [Pomoc techniczna programu PowerShell oceny luk w zabezpieczeniach programu Azure SQL](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessment-baseline-rules-by-using-resource-manager-templates"></a>Zarządzanie regułami planu bazowego oceny luk w zabezpieczeniach przy użyciu szablonów Menedżera zasobów

Aby skonfigurować linie bazowe oceny luk w zabezpieczeniach `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` przy użyciu szablonów usługi Azure Resource Manager, użyj tego typu.

Przed dodaniem linii `vulnerabilityAssessments` bazowych upewnij się, że na komputerze z systemem SQL Server jest włączona opcja.

Oto przykład definiowania reguły bazowej VA2065 do masterdb i VA1143 do userdb jako zasobów w szablonie Menedżera zasobów:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

W przypadku głównej bazy danych i bazy danych użytkowników nazwy zasobów są definiowane inaczej:

* Master database - "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>master</b>')]",
* Baza danych użytkowników - "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>default</b>')]",
 
 
 Aby obsłużyć typy logiczne jako wartość true/false, ustaw wynik linii bazowej z wejściem binarnym, takim jak "1"/"0".
 
```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Następne kroki  

- Dowiedz się więcej o [zaawansowanym bezpieczeństwie danych](sql-database-advanced-data-security.md).
- Dowiedz się więcej o [odnajdowaniu i klasyfikacji danych](sql-database-data-discovery-and-classification.md).
