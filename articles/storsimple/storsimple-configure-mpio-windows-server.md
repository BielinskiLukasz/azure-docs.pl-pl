<properties 
   pageTitle="StorSimple デバイスの MPIO の構成 | Microsoft Azure"
   description="Windows Server 2012 R2 を実行するホストに接続されている、StorSimple デバイスのマルチパス I/O (MPIO) を構成する方法を説明します。"
   services="storsimple"
   documentationCenter=""
   authors="alkohli"
   manager="carolz"
   editor="" />
<tags 
   ms.service="storsimple"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/31/2015"
   ms.author="alkohli" />

# StorSimple デバイスのマルチパス IO の構成

Microsoft では、フォールト トレランスと可用性に優れた SAN を構成するために、Windows Server でマルチパス I/O (MPIO) 機能をサポートしています。 MPIO では、アダプター、ケーブル、スイッチなどの冗長な物理パス コンポーネントを使用して、サーバーとストレージ デバイスの間に論理パスを作成します。 コンポーネントのエラーによって論理パスに障害が発生した場合は、マルチパス ロジックで I/O の代替パスが使用され、アプリケーションから引き続きデータにアクセスできるようにします。 さらに構成によっては、これらのパスの間で負荷を分散することで、パフォーマンスの向上にも貢献します。 詳細については、次を参照してください。 [MPIO の概要](https://technet.microsoft.com/library/cc725907.aspx "MPIO の概要と機能")です。  

StorSimple ソリューションの可用性を高めるためには、StorSimple デバイスで MPIO を構成する必要があります。 Windows Server 2012 R2 を実行するホスト サーバーに MPIO をインストールすると、サーバーでリンク、ネットワーク、またはインターフェイスのフォールト トレランスが有効になります。 

MPIO はオプションの機能であり、Windows サーバーに既定ではインストールされていません。 サーバー マネージャーを使用して、機能としてインストールする必要があります。 このトピックでは、Windows Server 2012 R2 が実行され、StorSimple 物理デバイスに接続されているホストに MPIO 機能をインストールし、その機能を使用するための手順を説明します。

>[AZURE.NOTE] **StorSimple 仮想デバイスで MPIO がサポートされていません。**

次の手順に従って、StorSimple デバイスに MPIO を構成します。

- 手順 1. Windows Server ホストに MPIO をインストールする

- 手順 2. StorSimple ボリュームの MPIO を構成する

- 手順 3. ホストに StorSimple ボリュームをマウントする

- 手順 4. 高可用性と負荷分散のために MPIO を構成する

これらの各手順を以下のセクションで説明します。

## 手順 1. Windows Server ホストに MPIO をインストールする

Windows Server ホストにこの機能をインストールするには、次の手順を実行します。

#### ホストに MPIO をインストールするには

1. Windows Server ホストでサーバー マネージャーを開きます。 既定では、Windows Server 2012 R2 または Windows Server 2012 を実行しているコンピューターに Administrators グループのメンバーがログオンすると、サーバー マネージャーが起動します。 サーバー マネージャーがまだ開いていない場合はクリックして **開始 > サーバー マネージャー**します。
![サーバー マネージャー](./media/storsimple-configure-mpio-windows-server/IC740997.png)
2. クリックして **サーバー マネージャー > ダッシュ ボード > 役割と機能の追加**します。 起動、 **追加の役割と機能の** ウィザード。
![役割と機能ウィザード 1 を追加します。](./media/storsimple-configure-mpio-windows-server/IC740998.png)
3.  **追加の役割と機能の** ウィザードで、次の操作します。

    -  **開始する前に** ] ページで [ **次**します。
    -  **インストールの種類を選択して** ] ページで、既定の設定をそのまま使用 **役割ベースまたは機能ベース** インストールします。 クリックして **次**.![役割と機能のウィザード 2 を追加します。](./media/storsimple-configure-mpio-windows-server/IC740999.png)
    -  **[対象サーバーの** ページで、選択 **サーバー プールからサーバーを選択**します。 使用中のホスト サーバーが自動的に検出されます。 クリックして **次**します。
    -  **サーバーの役割の選択** ] ページで [ **次**します。
    -  **機能の選択** ] ページで選択 **マルチパス I/O**, 、] をクリック **次**.![役割と機能のウィザード 5 を追加します。](./media/storsimple-configure-mpio-windows-server/IC741000.png)
    -  **インストール オプションの確認** ] ページで、選択内容を確認し、[ **ために必要な場合は、移行先サーバーを自動的に再起動**, 、次のようにします。 クリックして **インストール**.![役割と機能のウィザード 8 を追加します。](./media/storsimple-configure-mpio-windows-server/IC741001.png)
    - インストールが完了すると、通知が表示されます。 クリックして **閉じる** ウィザードを閉じます![。役割と機能のウィザード 9 を追加します。](./media/storsimple-configure-mpio-windows-server/IC741002.png)

## 手順 2. StorSimple ボリュームの MPIO を構成する

StorSimple ボリュームを識別するには、MPIO を構成する必要があります。 StorSimple ボリュームを認識するように MPIO を構成するには、次の手順を実行します。

#### StorSimple ボリュームの MPIO を構成する

1. 開いている、 **MPIO の構成**します。 クリックして **サーバー マネージャー > ダッシュ ボード > ツール > MPIO**します。

2.  **MPIO のプロパティ** ダイアログ ボックスで、 **マルチパスの検出** ] タブをクリックします。

3. 選択 **iSCSI デバイスのサポートを追加**, 、クリックして **追加**します。  
![MPIO プロパティのマルチパスを検出します。](./media/storsimple-configure-mpio-windows-server/IC741003.png)

4. メッセージが表示されたら、サーバーを再起動します。
5.  **MPIO のプロパティ** ダイアログ ボックスで、をクリックして、 **MPIO デバイス** ] タブをクリックします。 クリックして **追加**します。
    </br>![MPIO プロパティの MPIO デバイス](./media/storsimple-configure-mpio-windows-server/IC741004.png)
6.  **MPIO サポートの追加** ダイアログ ボックスで、 **デバイスのハードウェア ID**, 、デバイスのシリアル番号を入力します。StorSimple Manager サービスにアクセスしてに移動して、デバイスのシリアル番号を取得できます **デバイス > ダッシュ ボード**します。 デバイスのシリアル番号は右に表示される **概要** デバイス ダッシュ ボードのウィンドウです。
    </br>![MPIO サポートを追加します。](./media/storsimple-configure-mpio-windows-server/IC741005.png)
7. メッセージが表示されたら、サーバーを再起動します。

## 手順 3. ホストに StorSimple ボリュームをマウントする

Windows Server で MPIO が構成されると、StorSimple デバイスに作成されたボリュームをマウントし、MPIO を活用して冗長性を確保できます。 ボリュームをマウントするには、次の手順を実行します。

#### ホストにボリュームをマウントするには

1. 開いている、 **iSCSI イニシエーターのプロパティ** Windows Server ホスト上のウィンドウです。 クリックして **サーバー マネージャー > ダッシュ ボード > ツール > iSCSI イニシエーター**します。
2.  **ISCSI イニシエーターのプロパティ** ダイアログ ボックスで、[探索] タブをクリックして **ターゲット ポータルの探索**します。
3.  **ターゲット ポータルの探索** ] ダイアログ ボックスで、次の操作します。
    
    - StorSimple デバイスの DATA ポートの IP アドレスを入力します (たとえば、「DATA 0」と入力します)。
    - クリックして **OK** に戻るには、 **iSCSI イニシエーターのプロパティ** ] ダイアログ ボックス。

    >[AZURE.IMPORTANT] **ISCSI 接続のプライベート ネットワークを使用している場合は、プライベート ネットワークに接続されている DATA ポートの IP アドレスを入力します。**

4. デバイスの 2 番目のネットワーク インターフェイス (DATA 1 など) に対して手順 2. ～ 3. を繰り返します。 これらのインターフェイスは iSCSI に対応している必要があることに注意してください。 詳細については、次を参照してください。 [ネットワーク インターフェイスの変更](storsimple-modify-device-config.md#modify-network-interfaces)します。
5. 選択、 **ターゲット** ] タブで、 **iSCSI イニシエーターのプロパティ** ] ダイアログ ボックス。 StorSimple デバイスを表示する必要がありますターゲット IQN [ **検出されたターゲット**します。
 ![iSCSI イニシエーター プロパティのターゲット タブ](./media/storsimple-configure-mpio-windows-server/IC741007.png)
6. クリックして **接続** StorSimple デバイスと、iSCSI セッションを確立します。 A **ターゲットへの接続** ] ダイアログ ボックスが表示されます。

7.  **ターゲットへの接続** ダイアログ ボックスで、 **複数パスを有効にする** チェック ボックスをオンします。 クリックして **高度な**です。

8.  **の詳細設定** ] ダイアログ ボックスで、次の操作します。                                       
    -     **ローカル アダプター** ドロップダウン リストで、 **Microsoft iSCSI イニシエーター**します。
    -     **イニシエーター IP** ドロップダウン リストで、ホストの IP アドレスを選択します。
    -     **ターゲット ポータル** IP ドロップダウン リストで、デバイス インターフェイスの IP を選択します。
    -    クリックして **OK** に戻るには、 **iSCSI イニシエーターのプロパティ** ] ダイアログ ボックス。

9. クリックして **プロパティ**します。  **プロパティ** ダイアログ ボックスで、をクリックして **セッションの追加**します。
10.  **ターゲットへの接続** ダイアログ ボックスで、 **複数パスを有効にする** チェック ボックスをオンします。 クリックして **高度な**です。
11.  **の詳細設定** ] ダイアログ ボックス。                                        
    -   **ローカル アダプター** ボックスで、[Microsoft iSCSI イニシエーターです。
    -   **イニシエーター IP** ドロップダウン リストで、ホストに対応する IP アドレスを選択します。 この場合、デバイスの 2 つのネットワーク インターフェイスを、ホスト上の 1 つのネットワーク インターフェイスに接続しています。 そのため、このインターフェイスは最初のセッションで指定されたものと同じです。
    -   **ターゲット ポータル IP** ドロップダウン リストで、デバイスで有効になっている 2 番目のデータ インターフェイスの IP アドレスを選択します。
    -  クリックして **OK** iSCSI イニシエーターのプロパティ] ダイアログ ボックスに戻ります。 2 番目のセッションをターゲットに追加しました。

12. 開いている **コンピューターの管理** に移動して **サーバー マネージャー > ダッシュ ボード > コンピューターの管理**します。 左のウィンドウで **ストレージ > ディスクの管理**します。 このホストに表示される StorSimple デバイスで作成したボリュームが表示され **ディスクの管理** 新しいディスクとして。

13. ディスクを初期化して、新しいボリュームを作成します。 フォーマット処理中に 64 KB のブロック サイズを選択します。
![クリックし](./media/storsimple-configure-mpio-windows-server/IC741008.png)
14.  **ディスクの管理**, を右クリックし、 **ディスク** 選択 **プロパティ**します。
15. StorSimple モデル ### **マルチパス ディスクのデバイス プロパティ** ダイアログ ボックスで、をクリックして、 **MPIO タブ**します。
![StorSimple 8100 マルチパス ディスクのデバイス プロパティです。](./media/storsimple-configure-mpio-windows-server/IC741009.png)

16.  **DSM 名** ] をクリックして **詳細** パラメーターが既定のパラメーターに設定されていることを確認します。既定のパラメーターは次のとおりです。

    - パス確認期間 = 30
    - 再試行回数 = 3
    - PDO 削除期間 = 20
    - 再試行間隔 = 1
    - パス確認を有効化する = オフ


>[AZURE.NOTE] **既定のパラメーターを変更しないでください。**

## 手順 4. 高可用性と負荷分散のために MPIO を構成する

高可用性と負荷分散を基にしたマルチパスでは、複数のセッションを手動で追加し、利用可能なさまざまなパスを宣言する必要があります。 たとえば、ホストの 2 つのインターフェイスが SAN に接続されていて、デバイスの 2 つのインターフェイスが SAN に接続されている場合は、4 つのセッションに適切なパスの順列を構成する必要があります (各 DATA インターフェイスおよびホスト インターフェイスが異なる IP サブネット上にあってルーティング可能ではない場合は、必要なセッションは 2 つだけです)。

>[AZURE.IMPORTANT] **1 GbE と 10 GbE ネットワーク インターフェイスを混合しないことをお勧めします。2 種類のネットワーク インターフェイスを使用する場合は、どちらも同じ種類である必要があります。**

次の手順では、2 つのネットワーク インターフェイスを持つ StorSimple デバイスが 2 つのネットワーク インターフェイスを持つホストに接続されている場合に、セッションを追加する方法について説明します。

### 高可用性と負荷分散のために MPIO を構成するには

1. ターゲットの検出を実行する: で、 **iSCSI イニシエーターのプロパティ** ] ダイアログ ボックスの [、 **検出** ] タブ、[ **ポータルの探索**します。
2.  **ターゲットへの接続** ] ダイアログ ボックスで、デバイスのネットワーク インターフェイスの 1 つの IP アドレスを入力します。
3. クリックして **OK** に戻るには、 **iSCSI イニシエーターのプロパティ** ] ダイアログ ボックス。

4.  **ISCSI イニシエーターのプロパティ** ダイアログ ボックスで、 **ターゲット** ] タブで、検出したターゲットを強調表示してクリックして **接続**します。  **ターゲットへの接続** ] ダイアログ ボックスが表示されます。

5.  **ターゲットへの接続** ] ダイアログ ボックス。
    
    - 選択したターゲット設定の既定値のままにして **この接続を追加** お気に入りのターゲットの一覧にします。 この設定により、デバイスはこのコンピューターが起動するたびに、接続を自動的に再起動します。
    - 選択、 **複数パスを有効にする** チェック ボックスをオンします。
    - クリックして **高度な**です。

6.  **の詳細設定** ] ダイアログ ボックス。
    -  **ローカル アダプター** ドロップダウン リストで、 **Microsoft iSCSI イニシエーター**します。
    -  **イニシエーター IP** ドロップダウン リストで、ホストの IP アドレスを選択します。
    -  **ターゲット ポータル IP** ドロップダウン リストで、[デバイスのデータ インターフェイスの IP アドレスが有効にします。
    - クリックして **OK** iSCSI イニシエーターのプロパティ] ダイアログ ボックスに戻ります。

7. をクリックして **プロパティ**, 、し、[、 **プロパティ** ダイアログ ボックスで、をクリックして **セッションの追加**します。

8.  **ターゲットへの接続** ダイアログ ボックスで、 **複数パスを有効にする** チェック ボックスをオンにし **詳細**します。

9.  **の詳細設定** ] ダイアログ ボックス。
    1.  **ローカル アダプター** ドロップダウン リストで、 **Microsoft iSCSI イニシエーター**します。
    2.  **イニシエーター IP** ドロップダウン リストで、ホスト上の 2 番目のインターフェイスに対応する IP アドレスを選択します。
    3.  **ターゲット ポータル IP** ドロップダウン リストで、デバイスで有効になっている 2 番目のデータ インターフェイスの IP アドレスを選択します。
    4. クリックして **OK** に戻るには、 **iSCSI イニシエーターのプロパティ** ] ダイアログ ボックス。 これで 2 番目のセッションがターゲットに追加されました。

10. 追加のセッション (パス) をターゲットに追加するには、手順 8. ～ 10. を繰り返します。 ホスト上の 2 つのインターフェイスとデバイス上の 2 つのインターフェイスを使用して、合計 4 つのセッションを追加できます。

11. 目的のセッション (パス) を追加した後、 **iSCSI イニシエーターのプロパティ** ] ダイアログ ボックスで、ターゲットを選択し、をクリックして **プロパティ**します。 [セッション] タブで、 **プロパティ** ダイアログ ボックスで、4 つのセッション可能なパスの順列に対応する識別子。 セッションのキャンセルをセッション id の横にあるチェック ボックスをオンにしてクリックして **切断**します。

12. セッション内に示されるデバイスを表示するには、[、 **デバイス** ] タブをクリックします。 選択したデバイスの MPIO ポリシーを構成する] をクリックして **MPIO**します。  **デバイスの詳細** ] ダイアログ ボックスが表示されます。  **MPIO** ] タブで、適切な選択 **負荷分散ポリシー** 設定します。 表示することも、 **Active** または **スタンバイ** パスの種類。

## 次のステップ

詳細について [StorSimple Manager サービスを使用して、StorSimple デバイスの構成を変更する](storsimple-modify-device-config.md)です。
 
