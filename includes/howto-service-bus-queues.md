## Service Bus キューとは

Service Bus キューのサポート、 **仲介型メッセージング** 通信モデルです。 キューを使用すると、分散アプリケーションのコンポーネントが互いに直接通信することがなくなり、仲介者 (ブローカー) の役割を果たすキューを介してメッセージをやり取りすることになります。 メッセージ プロデューサー (送信者) はキューにメッセージを送信した後で、それまでの処理を引き続き実行します。 メッセージ コンシューマー (受信者) は、キューからメッセージを非同期に受信して処理します。 メッセージ プロデューサーは、それ以降のメッセージの処理と送信を続ける場合、メッセージ コンシューマーからの応答を待つ必要がありません。 キューでは **では、先入れ先出し (FIFO)** 1 つまたは複数の競合コンシューマーにメッセージを配信します。 つまり、通常はキューに追加された順番にメッセージが受信され、処理されます。このとき、メッセージを受信して処理できるメッセージ コンシューマーは、メッセージ 1 件につき 1 つだけです。

![QueueConcepts](./media/howto-service-bus-queues/sb-queues-08.png)

Service Bus キューは汎用テクノロジであり、幅広いシナリオで使用できます。

-   多層 Azure アプリケーションでの Web ロールと Worker ロールとの間の通信。
-   ハイブリッド ソリューションでのオンプレミスのアプリと Azure によってホストされるアプリケーションとの間の通信。
-   複数の組織で実行される分散アプリケーションまたは 1 つの組織内の異なる部署でオンプレミスで実行される分散アプリケーションのコンポーネント間の通信。

キューを使用すると、アプリケーションのスケールがより簡単になり、アーキテクチャの復元性が高まります。

## サービス名前空間の作成

Azure の Service Bus キューを使用するには、最初にサービス名前空間を作成する必要があります。 名前空間は、アプリケーション内で Service Bus リソースをアドレス指定するためのスコープ コンテナーを提供します。

サービス名前空間を作成するには:

1.  ログオン、 [Azure ポータル][]します。

2.  ポータルの左側のナビゲーション ウィンドウで、クリックして **Service Bus**します。

3.  ポータルの下のウィンドウで、クリックして **作成**します。
    ![](./media/howto-service-bus-queues/sb-queues-03.png)

4.   **新しい名前空間を追加** ダイアログ ボックスで、名前空間の名前を入力します。 その名前が使用できるかどうかがすぐに自動で確認されます。   
    ![](./media/howto-service-bus-queues/sb-queues-04.png)

5.  入力した名前空間の名前が利用できることを確認できたら、名前空間をホストする国またはリージョンを選択します (コンピューティング リソースを展開する国またはリージョンと同じ国またはリージョンを必ず使用してください)。

     > [AZURE.IMPORTANT] 選択、 **同じリージョン** アプリケーションをデプロイを選択するようにします。 そうすることで、パフォーマンスが最高になります。

6.  既定値は、ダイアログ ボックスの他のフィールドのままに (**メッセージング** と **Standard レベル**)、[ok] のチェック マークをクリックします。 これで、システムによってサービス名前空間が作成され、有効になります。 システムがアカウントのリソースを準備し 終わるまでに、数分間かかる場合があります。

    ![](./media/howto-service-bus-queues/getting-started-multi-tier-27.png)

作成した名前空間はアクティブになるまで少し時間がかかります。その後、Azure ポータルに表示されます。 名前空間のステータスが待って **Active** 続行する前にします。

## 名前空間の既定の管理資格情報の取得

新規作成した名前空間に対してキューの作成などの管理操作を実行するには、名前空間の管理資格情報を取得する必要があります。 これらの資格情報は Azure ポータルから取得できます。

###ポータルから管理資格情報を取得するには

1.  左側のナビゲーション ウィンドウで、クリックして、 **Service Bus** 使用できる名前空間の一覧を表示するのには、ノード。   
    ![](./media/howto-service-bus-queues/sb-queues-13.png)

2.  表示された一覧から先ほど作成した名前空間を選択します。   
    ![](./media/howto-service-bus-queues/sb-queues-09.png)

3.  クリックして **接続情報**します。   
    ![](./media/howto-service-bus-queues/sb-queues-06.png)

4.   **接続情報にアクセス** ] ウィンドウで、SAS キーとキー名を含む接続文字列を検索します。   

    ![](./media/howto-service-bus-queues/multi-web-45.png)
    
5.  キーを書き留めておくか、クリップボードにコピーしておいてください。

  [Azure portal]: http://manage.windowsazure.com


