<properties
    pageTitle="VS を使用したリモート クラスターへのアプリの発行 |Microsoft Azure"
    description="Visual Studio を使用してリモートの Service Fabric クラスターにアプリケーションを発行するために必要な手順について説明します。"
    services="service-fabric"
    documentationCenter="na"
    authors="cawams"
    manager="timlt"
    editor="" />

<tags
    ms.service="multiple"
    ms.devlang="dotnet"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.workload="multiple"
    ms.date="12/06/2015"
    ms.author="cawa" />


# Visual Studio を使用してリモート クラスターにアプリケーションを発行する

Visual Studio の Service Fabric 拡張機能を使用すると、Service Fabric クラスターへのアプリケーションの発行を反復可能な方法で簡単に実行できるうえに、スクリプト化することもできます。

## 発行に必要な成果物の概要

### Deploy-FabricApplication.ps1

これは、Service Fabric アプリケーションを発行するためのパラメーターとして発行プロファイルのパスを使用する PowerShell スクリプトです。 このスクリプトはアプリケーションの一部であるため、アプリケーションに必要であれば修正できます。

### 発行プロファイル

「**PublishProfiles**」という名前の Service Fabric アプリケーション プロジェクトのフォルダーには、次のようなアプリケーションを発行するための重要な情報を格納する XML ファイルが含まれています。
- Service Fabric クラスターの接続パラメーター
- アプリケーション パラメーター ファイルへのパス
- アップグレード設定

既定では、アプリケーションには、Local.xml と Cloud.xml という 2 つの発行プロファイルが含まれています。 既定のファイルの 1 つをコピーして貼り付けることで、プロファイルを追加できます。

### アプリケーション パラメーター ファイル

**ApplicationParameters** という Service Fabric アプリケーション プロジェクト内のフォルダーに、ユーザーが指定したアプリケーション マニフェストのパラメーター値用の XML ファイルが含まれています。 デプロイ設定に複数の値を使用できるように、アプリケーション マニフェスト ファイルをパラメーター化できます。 アプリケーションのパラメーター化の詳細については、「 [Service Fabric での複数の環境を管理](service-fabric-manage-multiple-environment-app-configuration.md)します。
>[AZURE.NOTE] アクター サービスの場合、マニフェスト ファイルにパラメーターを生成するには、まずプロジェクトをビルドする必要があります。

## [Service Fabric アプリケーションの発行] ダイアログ ボックスを使用してアプリケーションを発行する

次の手順は、Visual Studio Service Fabric Tools によって提供される **[Service Fabric アプリケーションの発行]** ダイアログ ボックスを使用してアプリケーションを発行する方法を示しています。

1. Service Fabric アプリケーション プロジェクトのショートカット メニューで **[発行]** を選択すると、**[Service Fabric アプリケーションの発行]** ダイアログ ボックスが表示されます。

    ![][0]

    **[ターゲット プロファイル]** ボックスの一覧で選択したファイルには、**マニフェスト バージョン**を除くすべての設定が保存されます。既存のプロファイルを再利用するか、作成、新しいものを選択して * *<Manage Profiles…>* * で、 **profile を対象に** ボックスの一覧です。発行プロファイルを選択すると、その内容がダイアログ ボックスの対応するフィールドに表示されます。**[プロファイルの保存]** リンクを選択すると、いつでも変更を保存できます。

2. **[接続エンドポイント]** セクションで、ローカルまたはリモートの Service Fabric クラスターの発行エンドポイントを指定できます。 接続エンドポイントを追加または変更するには、**[選択]** をクリックします。 **[Service Fabric クラスターの選択]** ダイアログ ボックスに、ご利用の Azure サブスクリプションに基づき、発行先として使用可能な Service Fabric クラスター接続エンドポイントが表示されます。 Visual Studio にまだログインしていない場合、ログインするように求められます。

    クラスターの選択ダイアログで、利用可能なサブスクリプションとクラスターのセットから選択できます。

    ![][1]
    >[AZURE.NOTE] 任意のエンドポイント (パーティ クラスターなど) に発行する場合、下の「**任意のクラスター エンドポイントに発行する**」を参照してください。

    エンドポイントを選択すると、選択した Service Fabric クラスターへの接続が Visual Studio によって検証されます。 クラスターがセキュリティで保護されていない場合、Visual Studio はすぐにエンドポイントに接続できます。 しかし、クラスターがセキュリティで保護されている場合は、続行する前にローカル コンピューターに証明書をインストールする必要があります。 参照してください [をセキュリティで保護された接続を構成する方法](service-fabric-visualstudio-configure-secure-connections.md) の詳細。 終了したら、**[OK]** をクリックします。 選択したクラスターに、**[Service Fabric アプリケーションの発行]** ダイアログ ボックスが表示されます。

3. **[アプリケーション パラメーター ファイル]** ボックスの一覧を使用して、アプリケーション パラメーター ファイルに移動できます。 アプリケーション パラメーター ファイルには、アプリケーション マニフェスト ファイル内のパラメーターにユーザーが指定した値が保持されています。 パラメーターを追加または変更するには、**[編集]** をクリックします。 **[パラメーター]** グリッドでパラメーターの値を入力または変更します。 終了したら、**[保存]** を選択します。

    ![][2]

4. **[アプリケーションのアップグレード]** チェック ボックスを使用して、この発行操作がアップグレードであるかどうかを指定できます。 アップグレードの発行操作は、通常の発行操作とは異なります。 参照してください [Service Fabric アプリケーションのアップグレード](service-fabric-application-upgrade.md) 違いの一覧についてです。 アップグレードの設定を構成するには、**[アップグレード設定の構成]** リンクを選択します。 アップグレード パラメーター エディターが表示されます。 参照してください [Service Fabric アプリケーションのアップグレードを構成する](service-fabric-visualstudio-configure-upgrade.md) をアップグレード パラメーターの詳細を参照してください。

5. **[マニフェスト バージョン]** をクリックすると、**[バージョンの編集]** ダイアログが表示されます。 更新を実行するには、アプリケーションとサービスのバージョンをアップグレードする必要があります。 参照してください [Service Fabric アプリケーションのアップグレード チュートリアル](service-fabric-application-upgrade-tutorial.md) をアプリケーションとサービス マニフェストのバージョンによるアップグレードのプロセスへの影響を参照してください。

    ![][3]

    アプリケーションとサービスのバージョンに 1.0.0 のようなセマンティック バージョンか 1.0.0.0 の形式の数値が使用されている場合は、**[アプリケーションとサービスのバージョンを自動的に更新する]** オプションをオンにします。 このオプションをオンにすると、コード、構成、またはデータのパッケージ バージョンが更新されたときに、サービスとアプリケーションのバージョン番号が自動的に更新されます。 バージョンを手動で編集する場合は、チェック ボックスをオフにして、この機能を無効にします。
    >[AZURE.NOTE] アクター プロジェクトにすべてのパッケージ エントリが表示されるには、最初に、サービス マニフェスト ファイルにエントリを生成するプロジェクトをビルドします。

6. 必要な設定をすべて指定し終えたら、**[発行]** をクリックし、選択した Service Fabric クラスターにアプリケーションを発行します。 指定した設定が、発行プロセスに適用されます。

## (パーティ クラスターを含む) 任意のクラスター エンドポイントに発行する

Visual Studio の発行機能は、ご利用の Azure サブスクリプションの 1 つに関連付けられているリモート クラスターに発行するために最適化されています。 ただし、発行プロファイル XML を直接編集し、任意のエンドポイント (Service Fabric パーティ クラスターなど) に発行できます。 前述のように、**Local.xml** と **Cloud.xml** という 2 つの発行プロファイルが既定で提供されますが、別の環境のために追加プロファイルを作成できます。 たとえば、パーティ クラスターに発行するために「**Party.xml**」という名前のプロファイルを作成します。

クラスターの接続エンドポイントはなど、必要なはセキュリティ保護されていないクラスターに接続する場合 `partycluster1.eastus.cloudapp.azure.com:19000`します。 その場合、発行プロファイルの接続エンドポイントは次のようになります。

```XML
<ClusterConnectionParameters ConnectionEndpoint="partycluster1.eastus.cloudapp.azure.com:19000" />
```

  保護されているクラスターに接続する場合、ローカル ストアからクライアント証明書の詳細を提供し、認証に使用する必要があります。 詳細については、次を参照してください。 [Service Fabric クラスターにセキュリティで保護された接続を構成する](service-fabric-visualstudio-configure-secure-connections.md)します。

  発行プロファイルが設定されたら、下の図のように発行ダイアログでそれを参照できます。

  ![発行ダイアログ ボックスの新しい発行プロファイル][4]

  この場合、新しい発行プロファイルは既定のアプリケーション パラメーター ファイルの 1 つを指すことに注意してください。 同じアプリケーション構成を複数の環境に公開する場合、これは適切です。 一方、公開する環境ごとに異なる構成を用意する場合、該当するアプリケーション パラメーター ファイルを作成すると合理的です。

## 次のステップ

継続的な統合環境での発行プロセスを自動化する方法については、次を参照してください。 [サービス ファブリック設定を継続的インテグレーション](service-fabric-set-up-continuous-integration.md)します。



[0]: ./media/service-fabric-publish-app-remote-cluster/PublishDialog.png 
[1]: ./media/service-fabric-publish-app-remote-cluster/SelectCluster.png 
[2]: ./media/service-fabric-publish-app-remote-cluster/EditParams.png 
[3]: ./media/service-fabric-publish-app-remote-cluster/EditVersions.png 
[4]: ./media/service-fabric-publish-app-remote-cluster/publish-to-party-cluster.png 

