<properties
   pageTitle="Azure Tools を使用したクラウド サービスの発行 | Microsoft Azure"
   description="Visual Studio を使用して Azure クラウド サービス プロジェクトを発行する方法について説明します。"
   services="visual-studio-online"
   documentationCenter="na"
   authors="TomArcher"
   manager="douge"
   editor="" />
<tags
   ms.service="multiple"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="multiple"
   ms.date="09/04/2015"
   ms.author="tarcher" />

# Azure Tools を使用したクラウド サービスの発行

Azure Tools for Microsoft Visual Studio を使用することで、Azure アプリケーションを Visual Studio から直接発行できます。 Visual Studio では、クラウド サービスのステージング環境または運用環境への統合された発行をサポートしています。

Azure アプリケーションを発行するには、Azure サブスクリプションが必要です。 また、アプリケーションで使用するようにクラウド サービスおよびストレージ アカウントを設定する必要があります。 設定できます、 [Azure 管理ポータル](http://go.microsoft.com/fwlink/?LinkID=213885)します。

>[AZURE.IMPORTANT] 発行するときは、クラウド サービスの展開環境を選択できます。 デプロイ用のアプリケーション パッケージの格納に使用するストレージ アカウントも選択する必要があります。 デプロイ後、アプリケーション パッケージはストレージ アカウントから削除されます。 これらのサービスを設定する方法の詳細については、次を参照してください。 [設定をサービスに必要なクラウド サービスを発行](vs-azure-tools-setting-up-services-required-to-publish-a-cloud-service-from-visual-studio.md) Visual Studio からです。

Azure アプリケーションを開発およびテストするときは、Web Deploy を使用して、Web ロールの変更を段階的に発行することができます。 アプリケーションをデプロイ環境に発行したら、Web Deploy を使用して、Web ロールを実行している仮想マシンに変更を直接デプロイできます。 変更をテストするために Web ロールを更新するたびに、Azure アプリケーション全体をパッケージ化して発行する必要はありません。 この方法では、アプリケーションがデプロイ環境に発行されるのを待たなくても、クラウドで Web ロールの変更をテストできます。

Azure アプリケーションを発行し、Web Deploy を使用して Web ロールを更新するには、次の手順に従います。

- Visual Studio からの Azure アプリケーションの発行またはパッケージ化

- 開発およびテスト サイクルの一環としての Web ロールの更新

## Visual Studio からの Azure アプリケーションの発行またはパッケージ化

Azure アプリケーションを発行するときは、次のいずれかの作業を行います。

- サービス パッケージを作成します。 このパッケージとサービス構成ファイルを使用するには、アプリケーションからのデプロイ環境を発行する、 [Azure 管理ポータル](http://go.microsoft.com/fwlink/?LinkID=213885)します。

- Visual Studio から Azure プロジェクトを発行する: アプリケーションを Azure に直接発行するには、発行ウィザードを使用します。 詳細については、次を参照してください。 [Azure アプリケーションの発行ウィザード](vs-azure-tools-publish-azure-application-wizard.md)します。

### Visual Studio からサービス パッケージを作成するには

1. アプリケーションを発行する準備ができたら、ソリューション エクスプローラーを開き、ロールを含む Azure プロジェクトのショートカット メニューを開いて、[発行] をクリックします。

1. サービス パッケージだけを作成するには、次の手順に従います。  

  1. Azure プロジェクトのショートカット メニューを選択 **パッケージ**します。

  1.  **Azure アプリケーションのパッケージ** ] ダイアログ ボックスで、パッケージを作成するサービス構成を選択し、ビルド構成を選択します。

  1. (省略可能)有効にするリモート デスクトップ、クラウド サービスを発行した後、次のように選択します。、 **すべてのロールのリモート デスクトップを有効にする** チェック ボックスをオンにし **設定** リモート デスクトップを構成します。 パブリッシュした後、クラウド サービスをデバッグする場合を選択してリモート デバッグを有効にする **すべてのロールのリモート デバッガーを有効にする**です。

      詳細については、次を参照してください。 [Azure ロールでリモート デスクトップを使用する](vs-azure-tools-using-remote-desktop-with-azure-roles.md)です。

  1. パッケージを作成するには、選択、 **パッケージ** リンクします。

      ファイル エクスプ ローラーに、新しく作成されたパッケージのファイルの場所が表示されます。 Azure 管理ポータルから使用できるように、この場所をコピーできます。

  1. このパッケージをデプロイ環境で発行する必要があります場所を使用するこのパッケージの場所としてクラウド サービスを作成して環境にこのパッケージを展開するときに、 [Azure 管理ポータル](http://go.microsoft.com/fwlink/?LinkID=213885)します。

1. (省略可能)選択して、動作状況ログの行項目のショートカット メニューで、展開プロセスをキャンセルする **取り消して削除**します。 これにより、デプロイ プロセスが停止し、Azure からデプロイ環境が削除されます。

    >[AZURE.NOTE] 展開された後は、このデプロイ環境を削除するには、Azure 管理ポータルを使用する必要があります。

1. (省略可能)Visual Studio が自動的にデプロイ環境を表示して、ロール インスタンスが起動すると、 **Cloud Services** サーバー エクスプ ローラー ノードです。 ここから、個々のロール インスタンスの状態を確認できます。 参照してください [クラウド エクスプ ローラーで Azure の管理リソース](vs-azure-tools-resources-managing-with-cloud-explorer.md)します。次の図は、まだ初期化中状態ではロール インスタンスを示しています。

    ![VST_DeployComputeNode](./media/vs-azure-tools-publishing-a-cloud-service/IC744134.png)

## 開発およびテスト サイクルの一環としての Web ロールの更新

アプリケーションのバックエンド インフラストラクチャは安定していても、Web ロールを頻繁に更新する必要がある場合は、Web Deploy を使用してプロジェクトの Web ロールだけを更新できます。 これは、バックエンド worker ロールの再構築と再デプロイを避ける場合や、複数の Web ロールの中の 1 つだけを更新する場合に便利です。

### 必要条件

Web Deploy を使用して、Web ロールを更新するための要件を次に示します。

- **開発およびテスト目的でのみ:** web ロールが実行されている仮想マシンに直接適用は、変更します。 この仮想マシンをリサイクルする必要がある場合、発行済みの元のパッケージを使用してロールの仮想マシンが再作成されるため、変更は失われます。 Web ロールの最新の変更を取得するには、アプリケーションを再発行する必要があります。

- **Web ロールのみを更新することができます:** ワーカー ロールを更新することはできません。 また、web role.cs で RoleEntryPoint を更新することもできません。

- **Web ロールの 1 つのインスタンスしかサポート:** デプロイ環境で web ロールの複数のインスタンスを持つことはできません。 ただし、それぞれにインスタンスを 1 つだけ持つ複数の Web ロールがサポートされます。

- **リモート デスクトップ接続を有効にする必要があります:** Web Deploy を使用できるようにユーザーとパスワードの変更をインターネット インフォメーション サービス (IIS) を実行しているサーバーに展開する仮想マシンに接続するには、このことが必要です。 また、仮想マシンに接続して、その仮想マシン上の IIS に信頼された証明書を追加することが必要な場合もあります  (これにより、Web Deploy によって使用される IIS のリモート接続のセキュリティが確保されます)。

次の手順では、使用するいると想定しています、 **Azure アプリケーションの発行** ウィザード。

### アプリケーションの発行時に Web Deploy を有効にするには

1. 有効にする、 **Web Deploy を有効にする** すべての web ロール] チェック ボックス、まずリモート デスクトップ接続を構成する必要があります。 選択 **リモート デスクトップを有効にする** すべての役割に、リモート接続に使用される資格情報を提供し、 **リモート デスクトップ構成** 表示されるボックスです。 参照してください [Azure ロールでリモート デスクトップを使用する](vs-azure-tools-remote-desktop-roles.md) の詳細。

1. すべての web ロール、アプリケーションで Web Deploy を有効にするには選択 **すべての web ロールの Web Deploy を有効にする**です。

    警告を表す黄色の三角形が表示されます。 Web Deploy では、信頼されていない自己署名証明書が既定で使用されます。これは、機密データをアップロードする場合には推奨されません。 機密データのためにこのプロセスを保護する必要がある場合は、Web Deploy の接続に使用する SSL 証明書を追加できます。 この証明書は、信頼された証明書であることが必要です。 これを行う方法については、セクションを参照してください。 **に、Web 展開をセキュリティで保護** このトピックで後述します。

1. 選択 **次** を表示する、 **概要** 画面を開いて、 **発行** 、クラウド サービスをデプロイします。

    クラウド サービスが発行されます。 作成される仮想マシンでは IIS のリモート接続が有効になっているため、Web ロールを再発行しなくても、Web Deploy を使用してそれらのロールを更新できます。

    >[AZURE.NOTE] Web ロール用に構成された 1 つ以上のインスタンスがある場合は、各 web ロールは 1 つのインスタンスを作成してアプリケーションの発行をパッケージにのみ制限されることを示す警告メッセージが表示されます。 [OK] をクリックして続行します。 「必要条件」で説明したように、複数の Web ロールを使用できますが、インスタンスはロールごとに 1 つに限られます。

### Web Deploy を使用して Web ロールを更新するには

1. Web Deploy を使用するには、公開、ソリューションでこのプロジェクト ノードを右クリックして] をポイントする Visual Studio で web ロールのいずれかのプロジェクトにコード変更を加える **発行**します。  **Web の発行** ] ダイアログ ボックスが表示されます。

1. (省略可能)IIS のリモート接続に使用する信頼された SSL 証明書を追加する場合は、オフ、 **信頼されていない証明書を許可する** チェック ボックスをオンします。 Web Deploy のセキュリティ保護する証明書を追加する方法については、セクションを参照してください。 **に、Web 展開セキュリティで保護された** このトピックで後述します。

1. Web Deploy を使用するには、パッケージを最初に発行したときにリモート デスクトップ接続用に設定したユーザー名とパスワードが必要です。

  1.  **ユーザー名**, 、ユーザー名を入力します。

  1.  **パスワード**, 、パスワードを入力します。

  1. (省略可能)このプロファイルにこのパスワードを保存する場合は、選択 **パスワードを保存**します。

1. Web ロールへの変更を発行する **発行**します。

    ステータス バーが表示されます **開始発行**します。 発行が完了したら、 **発行が成功した** が表示されます。 これで、仮想マシンの Web ロールに変更がデプロイされました。 Azure 環境で Azure アプリケーションを起動して変更をテストできます。

### Web Deploy のセキュリティを確保するには

1. Web Deploy では、信頼されていない自己署名証明書が既定で使用されます。これは、機密データをアップロードする場合には推奨されません。 機密データのためにこのプロセスを保護する必要がある場合は、Web Deploy の接続に使用する SSL 証明書を追加できます。 この証明書は、証明機関 (CA) から取得した信頼された証明書であることが必要です。

    Web Deploy のセキュリティ保護する仮想マシンごとに各 web ロール、web を使用する信頼された証明書をアップロードする必要がありますに展開、 [Azure 管理ポータル](http://go.microsoft.com/fwlink/?LinkID=213885)します。 これにより、アプリケーションの発行時に作成される Web ロールの仮想マシンに証明書が確実に追加されます。

1. リモート接続に使用する信頼された SSL 証明書を IIS に追加するには、次の手順を実行します。

  1. Web ロールを実行している仮想マシンに接続する場合に web ロールのインスタンスをクリックして **クラウド エクスプ ローラー** または **サーバー エクスプ ローラー**, を選択し、 **リモート デスクトップを使用して接続** コマンドです。 仮想マシンに接続する方法の詳細については、次を参照してください。 [Azure ロールでリモート デスクトップを使用する](vs-azure-tools-remote-desktop-roles.md)です。

      ブラウザーに .RDP ファイルのダウンロードを求めるメッセージが表示されます。

  1. SSL 証明書を追加するには、IIS マネージャーで管理サービスを開きます。 IIS マネージャーを開いて SSL を有効にする、 **バインド** 内のリンク、 **アクション** ウィンドウです。  **サイト バインドの追加** ] ダイアログ ボックスが表示されます。 選択 **追加**, で HTTPS を選択し、 **型** ボックスの一覧です。  **SSL 証明書** ボックスの一覧で、CA によって署名があると、Azure 管理ポータルにアップロードした SSL 証明書を選択します。 詳細については、次を参照してください。 [管理サービスの接続設定の構成](http://go.microsoft.com/fwlink/?LinkId=215824)します。

      >[AZURE.NOTE] 黄色の三角形の警告が表示されなくなります信頼された SSL 証明書を追加する場合、 **発行ウィザード**します。

## サービス パッケージにファイルを含める

作成されるロールの仮想マシンで特定のファイルを使用できるように、サービス パッケージにそれらのファイルを含めることが必要な場合があります。 たとえば、スタートアップ スクリプトで使用する .exe ファイルまたは .msi ファイルをサービス パッケージに追加する場合があります。 また、Web ロール プロジェクトまたは worker ロール プロジェクトに必要なアセンブリを追加することが必要な場合もあります。 ファイルを含めるには、そのファイルを Azure アプリケーションのソリューションに追加する必要があります。

### サービス パッケージにファイルを含めるには

1. サービス パッケージにアセンブリを追加するには、次の手順に従います。

  1.  **ソリューション エクスプ ローラー** 参照アセンブリが欠けているプロジェクトのプロジェクト ノードを開きます。

  1. アセンブリをプロジェクトに追加するには、ショートカット メニューを開き、 **参照** フォルダーを選択し **参照の追加**します。 [参照の追加] ダイアログが表示されます。

  1. 追加し、[参照] を選択、 **OK** ] ボタンをクリックします。

      下の一覧に参照を追加、 **参照** フォルダーです。

  1. 追加したアセンブリのショートカット メニューを開き、選択 **プロパティ**します。  **プロパティ** ウィンドウが表示されます。

      サービス パッケージには、このアセンブリを含める、 **一覧のローカル コピー** 選択 **True**します。

1.  **ソリューション エクスプ ローラー** 参照アセンブリが欠けているプロジェクトのプロジェクト ノードを開きます。

1. アセンブリをプロジェクトに追加するには、ショートカット メニューを開き、 **参照** フォルダーを選択し **参照の追加**します。  **参照の追加** ダイアログが表示されます。

1. 追加し、[参照] を選択、 **OK** ] ボタンをクリックします。

    下の一覧に参照を追加、 **参照** フォルダーです。

1. 追加したアセンブリのショートカット メニューを開き、選択 **プロパティ**します。 [プロパティ] ウィンドウが表示されます。

1. サービス パッケージには、このアセンブリを含める、 **ローカル コピー** 一覧で、選択 **True**します。

1. ファイルを web ロール プロジェクトに追加されたサービス パッケージに含めるファイルのショートカット メニューを開き、クリックして **プロパティ**します。  **プロパティ** ウィンドウで、選択 **コンテンツ** から、 **ビルド アクション** ボックスの一覧です。

1. ファイルは、ワーカー ロール プロジェクトに追加されたサービス パッケージに含める、ファイルのショートカット メニューを開き、クリックして **プロパティ**します。  **プロパティ** ウィンドウで、選択 **新しい場合はコピー** から、 **出力ディレクトリにコピー** ボックスの一覧です。

## 次のステップ

Azure への発行の詳細を Visual Studio からについて、次を参照してください。 [Azure アプリケーションの発行ウィザード](vs-azure-tools-publish-azure-application-wizard.md)します。

