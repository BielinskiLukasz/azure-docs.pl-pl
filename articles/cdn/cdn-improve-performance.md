<properties 
    pageTitle="CDN - ファイル圧縮によるパフォーマンスの向上" 
    description="ファイルを圧縮して、ファイル転送速度とページ読み込みパフォーマンスを向上させることができます。" 
    services="cdn" 
    documentationCenter=".NET" 
    authors="camsoper" 
    manager="dwrede" 
    editor=""/>

<tags 
    ms.service="cdn" 
    ms.workload="tbd" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="12/02/2015" 
    ms.author="casoper"/>


# ファイル圧縮によるパフォーマンスの向上

このトピックでは、ファイルを圧縮して、ファイル転送速度とページ読み込みパフォーマンスを向上させる方法を説明します。

CDN は次の 2 つの方法で圧縮をサポートしています。

- 配信元サーバーで圧縮を有効にします。この方法では、CDN は既定で圧縮をサポートし、圧縮されたファイルをクライアントに配信します。
- CDN エッジ サーバーで直接、圧縮を有効にします。この方法では、CDN でファイルが圧縮され、エンド ユーザーに渡されます。

## 圧縮の有効化

> [AZURE.NOTE] Standard および Premium CDN レベルでは同じ圧縮機能が提供されますが、ユーザー インターフェイスは異なります。 Standard および Premium CDN 層の違いの詳細については、次を参照してください。 [Azure CDN の概要](cdn-overview.md)します。

### Standard レベル

1. CDN プロファイル ブレードで、管理する CDN エンドポイントをクリックします。

    ![CDN プロファイル ブレード エンドポイント](./media/cdn-file-compression/cdn-endpoints.png)

    CDN エンドポイントのブレードが開きます。

2. **[構成]** をクリックします。

    ![[CDN プロファイル] ブレードの ](./media/cdn-file-compression/cdn-config-btn.png)

    CDN 構成ブレードが開きます。

3. **[圧縮]** をオンにします。

    ![CDN の圧縮オプション](./media/cdn-file-compression/cdn-compress-standard.png)

4. 既定の種類を使用するか、ファイルの種類を削除または追加して一覧を変更します。

5. 変更したら、**[保存]** をクリックします。

### Premium レベル

1. [CDN プロファイル] ブレードで、**[管理]** をクリックします。

    ![[CDN プロファイル] ブレードの ](./media/cdn-file-compression/cdn-manage-btn.png)

    CDN 管理ポータルが開きます。

2. **[HTTP ラージ]** タブ、**[キャッシュの設定]** フライアウトの順にマウスのカーソルを合わせます。 **[圧縮]** をクリックします。

    圧縮のオプションが表示されます。

    ![ファイル圧縮](./media/cdn-file-compression/cdn-compress-files.png)

3. ファイルの種類の一覧を変更したら、**[更新]** をクリックします。


## 圧縮プロセスとルール

1. 依頼者は、コンテンツの要求を送信します。
2. エッジ サーバーは、**Accept-Encoding** ヘッダーがあるかどうかをチェックします。
    1. ヘッダーがある場合、このヘッダーは要求された圧縮方法を特定します。
    1. ない場合、この種類の要求は、非圧縮形式で処理されます。
3.  最も近いエッジ POP でキャッシュの状態、圧縮方法、まだ有効期間があるかどうかが確認されます。
    1.  キャッシュ ミス: 要求されたバージョンがキャッシュされていない場合、要求は原点に転送します。
    2.  圧縮方法が同じキャッシュ ヒット: エッジ サーバーが直ちに圧縮されたコンテンツをクライアントに配信します。
    3.  圧縮方法が異なるキャッシュ ヒット: エッジ サーバーが資産を要求された圧縮方法にトランスコードします。
    4.  キャッシュ ヒットと非圧縮: 最初の要求で資産を非圧縮形式でキャッシュする必要があった場合、(前の定義/要件セクションの条件に基づいて) 要求でエッジ サーバー圧縮を実行可能かどうかを確認するチェックが実行されます。
        1.  実行可能な場合、エッジ サーバーはファイルを圧縮してクライアントに渡します。
        2.  実行できない場合: エッジ サーバーはすぐに非圧縮コンテンツをクライアントに配信します。



## 考慮事項

1. Media Services CDN 対応ストリーミング エンドポイントについて、圧縮は既定で application/vnd.ms-sstr+xml、application/dash+xml、application/vnd.apple.mpegurl、application/f4m+xml というコンテンツの種類に対応しています。 これらの種類の圧縮は、Azure ポータルを使用して有効/無効にすることはできません。
2. エッジ サーバーでキャッシュされるのは、1 つのファイル バージョン (圧縮または非圧縮) のみです。 他のバーションを要求すると、エッジ サーバーによってコンテンツがトランスコードされます。




