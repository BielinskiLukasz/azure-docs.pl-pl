<properties 
   pageTitle="Traffic Manager について | Microsoft Azure"
   description="この記事は、Traffic Manager とそのしくみを理解するのに役立ちます。"
   services="traffic-manager"
   documentationCenter=""
   authors="joaoma"
   manager="carmonm"
   editor="tysonn" />
<tags 
   ms.service="traffic-manager"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="infrastructure-services"
   ms.date="12/07/2015"
   ms.author="joaoma" />


# Traffic Manager について

Microsoft Azure Traffic Manager では、指定したエンドポイントへのユーザー トラフィックの分散を制御できます。このエンドポイントには、Azure Cloud Services、Azure Websites、その他のエンドポイントを指定できます。 Traffic Manager は、インターネット リソースのドメイン名に関するドメイン ネーム システム (DNS) クエリに、インテリジェントなポリシー エンジンを適用することで機能します。 Azure Cloud Services や Azure Websites は、世界中のさまざまなデータセンターで実行できます。

Traffic Manager を使用すると、次のようなメリットが得られます。

- **重要なアプリケーションの可用性の向上** – Traffic Manager は、Azure のエンドポイントを監視し、Azure クラウド サービス、Azure の Web サイト、またはその他の場所がダウンした場合に自動フェールオーバー機能を提供することにより、重要なアプリケーションの可用性を高めることができます。
- **高パフォーマンスのアプリケーションのために応答性を向上** – Azure によって、世界各地に配置されたデータセンターでクラウド サービスまたは Web サイトを実行できます。 Traffic Manager は、クライアントのネットワーク待ち時間が最も小さいエンドポイントにエンド ユーザーを転送することで、アプリケーションの応答性を向上させ、コンテンツ配信にかかる時間を短縮します。
- **ダウンタイムなしのアップグレードおよびサービス メンテナンスの実施** – Traffic Manager は、クラウドとオンプレミスのハイブリッド デプロイの拡張シナリオをサポートします。これには、「クラウドへのバースト」、「クラウドへの移行」、および「クラウドへのフェールオーバー」のシナリオが含まれます。 計画されたメンテナンスの場合は、Traffic Manager で対象のエンドポイントを無効にし、エンドポイントで現在の接続のサービス提供が完了するのを待ちます。 エンドポイントへのトラフィックがなくなったら、エンドポイントのサービスを更新してテストし、Traffic Manager で再び有効にします。 こうすることで、クライアントに対するダウンタイムを発生させずに、サービスの保守とアップグレードを実行できます。
- **大規模で複雑なデプロイに対するトラフィックの分散** – Traffic Manager プロファイルが別の Traffic Manager プロファイルをエンドポイントにすることができる入れ子になった Traffic Manager プロファイルで、大規模で複雑なデプロイに対してパフォーマンスと分散を最適化するために、構成を作成できます。 詳細については、次を参照してください。 [プロファイルを入れ子になった](#nested-profiles)します。

## Traffic Manager のしくみ

Traffic Manager プロファイルを構成する際に各種設定を指定することで、要求を処理するエンドポイントを DNS クエリで判断するのに必要な情報が Traffic Manager に提供されます。 実際のエンドポイント トラフィックは、Traffic Manager を経由してルーティングされるわけではありません。

*図 1* は、Traffic Manager がエンドポイントのセットの 1 つにユーザーを転送する方法を示しています。 図 1 の番号は、下に続く説明の番号に対応しています。

![Traffic Manager のしくみ](./media/traffic-manager-overview/IC740854.jpg)

**図 1**

1. **会社のドメイン名へのユーザー トラフィック**: クライアントは、会社のドメイン名を使用して情報を要求します。 目標は、DNS 名を IP アドレスに解決することです。 会社のドメインは、Traffic Manager の外部に保持されている通常のインターネット ドメイン名登録を通じて予約する必要があります。 図 1 で、例として示している会社のドメインは*www.contoso.com*です。
2. **会社のドメイン名をTraffic Managerドメイン名に**: 会社のドメインの DNS リソース レコードでは、Azure Traffic Manager で管理されている Traffic Manager ドメイン名が参照されます。 これは、会社のドメイン名を Traffic Manager ドメイン名にマップする CNAME リソース レコードを使用して実現されます。 この例では、Traffic Manager ドメイン名は*contoso.trafficmanager.net* です。
3. **Traffic Manager ドメイン名とプロファイル**: Traffic Manager ドメイン名は、Traffic Manager プロファイルの一部です。 ユーザーの DNS サーバーは、Traffic Manager ドメイン名 (この例では *contoso.trafficmanager.net*)の新しい DNS クエリを送信します。これは、Traffic Manager の DNS ネーム サーバーによって受信されます。
4. **Traffic Manager プロファイルのルールを処理**: Traffic Manager は、指定されたトラフィック ルーティング方法と監視状態を使用して、要求を処理する Azure またはその他のエンドポイントを決定します。
5. **エンドポイントのドメイン名をユーザーに送信**: Traffic Manager は、Traffic Manager ドメイン名をエンドポイントのドメイン名にマップする CNAME レコードを返します。 ユーザーの DNS サーバーは、エンドポイントのドメイン名を IP アドレスに解決し、ユーザーに送信します。
6. **ユーザーによるエンドポイントの呼び出し**: ユーザーは、返されたエンドポイントを、IP アドレスを使って直接呼び出します。

会社のドメインと解決された IP アドレスはクライアント コンピューターにキャッシュされるため、ローカルの DNS キャッシュ エントリの有効期限が切れるまで、ユーザーは選択されたエンドポイントと引き続きやり取りすることができます。 DNS クライアントには DNS ホスト エントリがそのエントリの Time-to-Live (TTL) の期間中キャッシュされていることに注意する必要があります。 DNS クライアント キャッシュからホスト エントリを取得すると、Traffic Manager プロファイルは無視されるため、TTL が期限切れになる前にエンドポイントが使用できなくなった場合には、接続が遅延する可能性があります。 キャッシュ内の DNS ホスト エントリの TTL が期限切れになり、会社のドメイン名を再度解決する必要が生じると、クライアント コンピューターは新しい DNS クエリを送信します。 この場合にクライアント コンピューターが受け取る IP アドレスは、適用されるトラフィック ルーティング方法や要求時のエンドポイントの状態によっては、前回のアドレスと異なる可能性があります。

## Traffic Manager の実装方法

*図 2* は、Traffic Manager を実装するために必要な手順を実行順に示しています。 Traffic Manager の構成とベスト プラクティスに関する十分な知識がある場合は、これらの手順を多少異なる順序で実行しても問題ありません。 図 2 の番号は、次の番号付きの説明に対応しています。

![Traffic Manager の構成方法](./media/traffic-manager-overview/IC740855.jpg)

**図 2**

1. **Azure クラウド サービス、Azure の Web サイト、またはその他のエンドポイントを運用環境にデプロイします**。 Traffic Manager プロファイルを作成するときに、そのプロファイルは、サブスクリプションに関連付けられている必要があります。 次に、同じサブスクリプションに含まれる運用環境で、クラウド サービスおよび標準的な層の Web サイトのエンドポイントを追加します。 エンドポイントが Azure の運用環境ではなく、ステージング環境にあり、または同じサブスクリプションに含まれない場合は、外部エンドポイントとして追加できます。 クラウド サービスの詳細については、次を参照してください。 [クラウド サービス](http://go.microsoft.com/fwlink/p/?LinkId=314074)します。 Web サイトに関する詳細については、次を参照してください。 [Websites](http://go.microsoft.com/fwlink/p/?LinkId=393327)します。
2. **Traffic Manager ドメインの名前を決定します**。 一意のプレフィックスを持つドメインの名前を検討してください。 ドメインの後半部分、trafficmanager.net は固定されています。 詳細については、次を参照してください。 [ベスト プラクティス](#best-practices)します。
3. **使用する監視の構成を決定します**。 Traffic Manager は、トラフィック ルーティング方法に関係なく、オンラインであることを確認するために、エンドポイントを監視します。 監視設定を構成した後 Traffic Manager は、すべてのエンドポイントがオフラインであることを検出するか、プロファイルに含まれるいずれかのエンドポイントの状態を検出できなくなるまで、監視システムに従って、オフラインであるエンドポイントにトラフィックを送信しません。 監視の詳細については、次を参照してください。 [Traffic Manager の監視](traffic-manager-monitoring.md)します。
4. **使用するトラフィック ルーティング方法を決定します**。 次の 3 つの異なるトラフィック ルーティング方法を使用できます。 時間をかけて、要件に適合する最適な方法を理解してください。 後で方法を変更する必要がある場合は、いつでも変更できます。 各方法では、わずかに異なる構成手順が必要であることにも注意してください。 トラフィック ルーティング方法の詳細については、次を参照してください。 [Traffic Manager に関するトラフィック ルーティング方法](traffic-manager-load-balancing-methods.md)します。
5. **プロファイルを作成し、設定を構成します**。 REST API、Windows PowerShell、または Azure クラシック ポータルを使用して、Traffic Manager プロファイルを作成し、設定を構成することができます。 詳細については、次を参照してください。 [Traffic Manager の設定を構成する方法](#how-to-configure-traffic-manager-settings)します。 以下の手順は、Azure クラシック ポータルの**簡易作成**を使用することを前提としています。
   - **Traffic Manager プロファイルを作成する** Azure クラシック ポータルで簡易作成を使用して、プロファイルを作成、表示する [Traffic Manager プロファイルの管理](traffic-manager-manage-profiles.md)します。
   - **トラフィック ルーティング方法の設定の構成** – [簡易作成] で、プロファイルのトラフィック ルーティング方法を選択する必要があります。 この設定は、簡易作成の手順を完了した後も、いつでも変更できます。 構成手順については、トラフィック ルーティング方法に対応するトピックを参照してください: [トラフィックのルーティング方法を構成するパフォーマンス](traffic-manager-configure-performance-load-balancing.md), 、[トラフィックのルーティング方法を構成するフェールオーバー](traffic-manager-configure-failover-load-balancing.md), 、[構成ラウンド ロビン トラフィック ルーティング方法](traffic-manager-configure-round-robin-load-balancing.md)します。

   >[AZURE.NOTE] ラウンド ロビンによるトラフィック ルーティング方法で、ネットワーク トラフィックの重み付け分布がサポートされるようになりました。 ただし、現時点では、REST API と Windows PowerShell のいずれかを使用して重みを構成する必要があります。 詳細と構成の例では、次を参照してください。 [Azure Traffic Manager の外部エンドポイントと PowerShell による重み付けラウンド ロビン](http://azure.microsoft.com/blog/2014/06/26/azure-traffic-manager-external-endpoints-and-weighted-round-robin-via-powershell/) 、Azure ブログです。

   - **エンドポイントの構成** – エンドポイントは、簡易作成では構成しません。 プロファイルを作成し、トラフィック ルーティング方法を指定した後で、Traffic Manager に対してエンドポイントを指定する必要があります。 エンドポイントを構成する手順については、を参照してください [Traffic Manager でのエンドポイントの管理](traffic-manager-endpoints.md)。

   - **監視設定の構成** –監視設定は、簡易作成では構成しません。 プロファイルを作成し、トラフィック ルーティング方法を指定した後で、Traffic Manager に対して監視対象を指定する必要があります。 監視を構成する手順については、次を参照してください。 [Traffic Manager の監視](traffic-manager-monitoring.md)します。
6. **Traffic Manager プロファイルをテストします**。 プロファイルとドメインが正常に動作しているかどうかをテストします。 これを行う方法については、次を参照してください。 [Traffic Manager の設定のテスト](traffic-manager-testing-settings.md)します。
7. **会社のドメイン名の DNS リソース レコードでプロファイルを参照して、有効にします**。 詳細については、次を参照してください。 [Traffic Manager ドメインを会社のインターネット ドメインをポイント](traffic-manager-point-internet-domain.md)します。

図 1 の例では、会社のドメイン名が Traffic Manager のドメイン名を参照するように、サーバー上の DNS リソース レコードを次のように変更します。
    www.contoso.com IN CNAME contoso.trafficmanager.net

## Traffic Manager の設定の構成方法

Traffic Manager の設定は、Azure クラシック ポータル、REST API、Windows PowerShell コマンドレットを使用して構成できます。

REST API の各要素は Azure クラシック ポータルには表示されませんが、どちらの方法でも多くの設定を扱えます。 REST Api の使用に関する詳細については、次を参照してください。 [Traffic Manager (REST API リファレンス) の操作](http://go.microsoft.com/fwlink/p/?LinkId=313584)します。

詳細については Windows PowerShell コマンドレットのトラフィック マネージャーの次を参照してください。 [Azure Traffic Manager コマンドレット](http://go.microsoft.com/fwlink/p/?LinkId=400769)します。
>[AZURE.NOTE] 現時点では、Azure クラシック ポータルで外部エンドポイント (タイプ = "Any")、ラウンド ロビンによるトラフィック ルーティング方法の重み、入れ子になったプロファイルを構成することはできません。 REST を使用する必要があります (を参照してください [Create Definition](http://go.microsoft.com/fwlink/p/?LinkId=400772)) または Windows PowerShell (を参照してください [Add-azuretrafficmanagerendpoint](https://msdn.microsoft.com/library/azure/dn690257.aspx))します。

### Azure クラシック ポータルでの設定の構成

Azure クラシック ポータルでは、簡易作成を使用して Traffic Manager プロファイルを作成できます。 簡易作成では基本プロファイルの作成が可能です。 プロファイルの作成後は、追加設定を構成したり、構成済みの設定を編集したりできます。 簡易作成による Traffic Manager プロファイルの作成の詳細については、次を参照してください。 [Traffic Manager プロファイルの管理](traffic-manager-manage-profiles.md)します。

Azure クラシック ポータルでは、次の設定を構成できます。

- **DNS プレフィックス** – 自分で作成できる一意のプレフィックスです。 プロファイルはプレフィックス別に Azure クラシック ポータルに表示されます。
- **DNS TTL** – DNS Time-to-Live (TTL) の値は、クライアントのローカル キャッシュ ネーム サーバーが、更新された DNS エントリを取得するために Azure Traffic Manager の DNS システムに対してクエリを実行する頻度を制御します。
- **サブスクリプション** – プロファイルに対応するサブスクリプションを選択します。 このオプションは、複数のサブスクリプションを持っている場合にのみ表示されます。
- **トラフィック ルーティング方法** – Traffic Manager でトラフィック ルーティングを処理する方法です。
- **フェールオーバーの順序** – フェールオーバーによるトラフィック ルーティング方法を使用する際のエンドポイントの順序です。
- **監視** – 監視設定には、プロトコル (HTTP または HTTPS)、ポート、相対パス、ファイル名が含まれています。

### REST API を使用した設定の構成

REST API を使用して Traffic Manager プロファイルの作成と構成を実行できます。 詳細については、次を参照してください。 [Traffic Manager (REST API リファレンス) の操作](http://go.microsoft.com/fwlink/?LinkId=313584)します。

- **プロファイル** – プロファイルには、作成するドメイン名プレフィックスが含まれています。 各プロファイルはサブスクリプションに対応しています。 1 つのサブスクリプションに複数のプロファイルを作成できます。 プロファイル名は Azure クラシック ポータルに表示されます。 作成した名前 (プロファイルで構成) は、"Traffic Manager ドメイン" と呼ばれます。
- **定義** – 定義には、ポリシー設定と監視設定が含まれています。 定義はプロファイルに対応しています。 1 つのプロファイルには定義を 1 つだけ指定できます。 定義に含まれている設定の多くは Azure クラシック ポータルに表示され、Azure ポータルで構成できますが、定義そのものは Azure クラシック ポータルに表示されません。
- **DNS オプション** – DNS オプションは各定義に含まれています。 ここで DNS TTL を構成します。
- **監視** – 監視設定は各定義に含まれています。 ここで、プロトコル、ポート、相対パス、ファイル名を構成します。 監視設定は Azure クラシック ポータルに表示され、Azure クラシック ポータルで構成できます。 詳細については、次を参照してください。 [Traffic Manager の監視](traffic-manager-monitoring.md)します。
- **ポリシー** – ポリシー設定は各定義に含まれます。 ポリシーでは、トラフィック ルーティング方法とエンドポイントを指定します。 ポリシーに含まれる設定の一部は Azure クラシック ポータルに表示され、Azure ポータルで構成できますが、ポリシーそのものは Azure クラシック ポータルに表示されません。 詳細については、次を参照してください。 [Traffic Manager に関するトラフィック ルーティング方法](traffic-manager-load-balancing-methods.md)します。

## Windows PowerShell を使用した設定の構成

Windows PowerShell を使用して Traffic Manager プロファイルの作成と構成を実行できます。 詳細については、次を参照してください。 [Azure Traffic Manager コマンドレット](http://go.microsoft.com/fwlink/p/?LinkId=400769)します。

## ベスト プラクティス

- **一意のわかりやすいプレフィックスを作成する** – Traffic Manager プロファイルの DNS 名は一意にする必要があります。 自由に作成できるのは、DNS 名の最初の部分のみです。 Traffic Manager ドメイン名は、識別とクライアント要求の転送のみに使用されます。 クライアント コンピューターでこれらの名前がエンド ユーザーに表示されることはありません。 ただし、プロファイルはこのドメイン名によって識別されるため、Azure クラシック ポータルのインターフェイスで目的のドメイン名と他のドメイン名をすばやく識別できるようにすることが重要です。
- **ドットを使用して一意のドメイン名を作成したり、ドメインをわかりやすくしたりする** – ピリオドを使用して、ドメイン名プレフィックスも複数の部分に分割できます。 Traffic Manager で複数のポリシーを作成する場合は、サービスを識別できるように、一貫性のある階層を使用します。 たとえば、Contoso に、Web、課金、およびユーティリティ管理に関するグローバル サービスがあるとします。 この場合、3 つのポリシーは、*web.contoso.trafficmanager.net*、*bill.contoso.trafficmanager.net*、および *util.contoso.trafficmanager.net* のように作成できます。 また、クラウド サービスや Web サイトを設定するときは、場所を含んだ名前を使用できます。 たとえば、*web-us-contoso.cloudapp.net* や *web-asia-contoso.cloudapp.net* などです。 DNS による制約以外に制限事項はありません。 ドメイン名は、ドットで区切られた複数のラベルとして指定されることを前提としています (label.label.label.label など)。 このドキュメントの作成時点では、Traffic Manager におけるドメイン名の制限事項は次のとおりです。
   - 各ラベルは、最大 63 文字まで指定できます。
   - 合計で 40 個を超えるラベルを含めることはできません。 ラベルのうち 2 つは "trafficmanager.net" で使用されるため、残りの 38 個のラベルをプレフィックスに使用できます。
   - ドメイン名全体では、最大 253 文字まで指定できます。 この文字数のうち 19 文字は "trafficmanager.net" で使用されることに注意してください。
- **DNS TTL** – DNS TTL の値は、クライアントのローカル キャッシュ ネーム サーバーが、更新された DNS エントリを取得するために Azure Traffic Manager の DNS システムに対してクエリを実行する頻度を制御します。 Traffic Manager に変更が加えられた場合 (プロファイルの変更やエンドポイントの可用性の変更など)、この期間に、DNS サーバーのグローバル システム全体で更新が実行されます。 設定は、既定値の 300 秒 (5 分) のままにしておくことをお勧めします。 値を大きくすると、Traffic Manager の DNS 応答が DNS リゾルバーおよびクライアントにキャッシュされる時間が長くなり、DNS クエリの待機時間全体が短縮されます。 ただし、迅速なフェールオーバーが必要な場合は、小さい値を設定できます。
- **各エンドポイントは 1 つのサブスクリプションに含まれている必要がある** – すべてのエンドポイントは、プロファイルを作成しようとしている同一のサブスクリプションに含まれている必要があります。 別のサブスクリプションのエンドポイントは外部エンドポイントとしてプロファイルに追加できます。ただし、関連付けられているサービスを無効化または削除しても、外部エンドポイントは自動的には削除されず、 結果として、Traffic Manager プロファイルに残ります。手作業で削除しない限り、引き続き課金されます。
- **運用サービスのみ** – 運用環境にあるエンドポイントのみを使用できます。 ステージング環境で実行されているエンドポイントに転送することはできません。 プロファイルがトラフィックを転送しているときに仮想 IP (VIP) アドレスのスワップを実行すると、トラフィックは、運用環境にスワップされたエンドポイントを使用します。
- **エンドポイントに識別しやすい名前を付ける** – 使用する DNS プレフィックスを考慮します。 DNS 名はサブスクリプション内で一意であることが保証されていますが、クラウド サービスと Web サイトの名前は一意でない場合があるため、DNS 名が使用されます。 混乱を避けるため、クラウド サービスや Web サイトは、名前と DNS プレフィックスに同じまたは類似したものを指定してください。 クラウド サービスや Web サイトが 20 以上ある場合、名前の設定を誤ると正しいエンドポイントを見つけることが難しくなります。 また、名前の設定が適切でないエンドポイントでは、プロファイルを管理するのが難しくなります。
- **1 つのプロファイルに含まれるすべてのエンドポイントは同じ操作とポートを処理する必要がある** – エンドポイントが混在していると、要求を処理できないエンドポイントをクライアントが呼び出す可能性が高くなります。
- **1 つのプロファイルに含まれるすべてのクラウド** – サービスは同じ監視設定を使用する必要がある 1 つの定義内にあるすべてのエンドポイントを監視する際に選択できるパスとファイルは 1 つだけです。 **[相対パスおよびファイル名]** ボックスに「/」を入力すると、監視において既定のパスとファイル名へのアクセスが試行されます。
- **一時的な変更の場合は、構成を変更するのではなく、エンドポイントを無効にする** – エンドポイントをオフラインにする必要が生じることはたびたびあります。 このようなときは、プロファイルからエンドポイントを削除するのではなく、プロファイルに含まれている個々のエンドポイントを無効にします。 無効にしても、エンドポイントはプロファイルに含まれたままですが、プロファイルはそのエンドポイントが含まれていないかのように動作します。 これは、メンテナンス モードのエンドポイントを一時的に削除したり、エンドポイントを再デプロイしたりする場合に役立ちます。 エンドポイントを再度起動して実行すると、有効にすることができます。 詳細については、次を参照してください。 [Traffic Manager でのエンドポイントの管理](traffic-manager-endpoints.md)します。
- **プロファイルを削除せずに、一時的な変更のためにプロファイルを無効にする** – プロファイル内で指定する個々のエンドポイントだけでなく、プロファイル全体をオフラインにすることができます。 そのためには、プロファイルを無効にします。 プロファイルを無効にする場合、すべての設定は、Azure クラシック ポータルで引き続き編集することができ、再度使用するときにプロファイルをすばやく簡単にオンラインに戻すことができます。 詳細については、次を参照してください。 [Traffic Manager でのエンドポイントの管理](traffic-manager-endpoints.md)します。
- **ストレージ** – Traffic Manager を使用する場合、ストレージの場所および分散を設計する方法は、重要な検討事項です。 Traffic Manager 用アプリケーションの設計とデプロイを行う際は、エンド ツー エンドのトランザクションとデータのフローを考慮してください。
- **SQL Azure** – ストレージの設計と同様に、複数の地理的領域にエンドポイントを拡張するときに、アプリケーションの状態とデータ要件を分析します。

## 入れ子になったプロファイル

別の Traffic Manager プロファイルの名前をエンドポイントとして指定できます。これを入れ子になったプロファイルと呼びます。 Traffic Manager プロファイル名は、contoso-europe.trafficmanager.net のような DNS 名です。

そのため、受信した DNS 名のクエリが階層セット内で分析され、要求元のクライアントが正しいエンドポイント セットに転送されるように Traffic Manager を構成できます。 *図 3* に例を示します。

![入れ子になった Traffic Manager プロファイルの例](./media/traffic-manager-overview/IC751072.png)

**図 3**

最大 10 レベルまで入れ子にできます。トラフィック ルーティング方法がそれぞれ異なるプロファイルを複数構成できます。

たとえば、次のような構成を作成できます。

- 最上位の層 (外部 DNS 名にマップされる Traffic Manager プロファイル) において、パフォーマンスによるトラフィック ルーティング方法でプロファイルを構成できます。
- 中間層において、一連の Traffic Manager プロファイルは異なるデータセンターを表し、ラウンド ロビンによるトラフィック ルーティング方法を使用します。
- 最下位の層において、各データセンターの一連のクラウド サービス エンドポイントは、ユーザーのトラフィック要求を処理します。

このように構成することで、ユーザーは、パフォーマンスに基づいて適切な地域のデータセンターに転送され、同等または重み付けされた負荷分散に基づいてデータセンター内のクラウド サービスに転送されます。 たとえば、重み付けを使用して、テストやカスタマー フィードバック用に、トラフィックの少量の割合を新規デプロイメントまたは試用デプロイメントに分散できます。

*図 4* に、この構成を示します。

![多階層の Traffic Manager プロファイルの例](./media/traffic-manager-overview/IC751073.png)

**図 4**

*図 4* の最上位層の Traffic Manager プロファイルは親プロファイル、中間層の Traffic Manager プロファイルは子プロファイルです。

Traffic Manager が少数の正常なエンドポイントがある子プロファイルにユーザーを転送すると、それらのエンドポイントが過負荷状態になり、パフォーマンスの問題が生じる可能性があります。 このような状況を回避するために、親 Traffic Manager プロファイルを構成する際に、正常なエンドポイントのしきい値を設定して、子プロファイル内のいずれかのエンドポイントがトラフィックを受け取れるかどうかを指定できます。 たとえば、子プロファイル内に正常なエンドポイントが 3 つ以上あるようにするには、このしきい値を「3」に設定します。 図 4 の例であれば、最上位層の Traffic Manager プロファイルにこのしきい値を構成します。

Traffic Manager プロファイルをエンドポイントとして追加し、正常なエンドポイントの最小数を設定して、REST を使用する必要があります (を参照してください [Create Definition](http://go.microsoft.com/fwlink/p/?LinkId=400772)) または Windows PowerShell (を参照してください [Add-azuretrafficmanagerendpoint](https://msdn.microsoft.com/library/azure/dn690257.aspx))します。 Azure クラシック ポータルは使用できません。

## Traffic Manager に関する図

Traffic Manager を変更したり、独自の目的の独自のプレゼンテーションの PowerPoint スライドとしてこのトピックの図をたい場合は、次を参照してください。 [MSDN ドキュメント内の Traffic Manager に関する図](http://gallery.technet.microsoft.com/Traffic-Manager-figures-in-887e7c99)します。

## 次のステップ

[Traffic Manager のルーティング方法](traffic-manager-routing-methods.md)

[Traffic Manager の監視](traffic-manager-monitoring.md)

[プロファイルを作成します。](traffic-manager-manage-profiles.md)

[Azure Traffic Manager コマンドレット](http://go.microsoft.com/fwlink/p/?LinkId=400769)




