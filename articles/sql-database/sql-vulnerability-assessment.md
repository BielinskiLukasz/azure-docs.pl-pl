---
title: Ocena luk w zabezpieczeniach SQL
description: Dowiedz się, jak skonfigurować i przeprowadzić ocenę luk w zabezpieczeniach programu SQL SQL Database i interpretować raporty oceny.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: mibar
ms.author: mibar
ms.reviewer: vanto, carlrab
ms.date: 03/12/2019
ms.openlocfilehash: f67882d51c14b50c8a65120b663096d08363d07d
ms.sourcegitcommit: dfa543fad47cb2df5a574931ba57d40d6a47daef
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 02/18/2020
ms.locfileid: "77431455"
---
# <a name="sql-vulnerability-assessment-service-helps-you-identify-database-vulnerabilities"></a>Usługa oceny luk w zabezpieczeniach SQL ułatwia identyfikowanie luk w zabezpieczeniach bazy danych

Ocena luk w zabezpieczeniach programu SQL to prosta konfiguracja usługi, która umożliwia odnajdywanie, śledzenie i rozwiązywanie problemów z potencjalnymi lukami w zabezpieczeniach bazy danych. Dzięki niej można aktywnie zwiększać poziom bezpieczeństwa bazy danych.

Ocena luk w zabezpieczeniach jest częścią oferty [Advanced Data Security](sql-database-advanced-data-security.md) (ADS), która stanowi ujednolicony pakiet zaawansowanych funkcji zabezpieczeń SQL. Dostęp do oceny luk w zabezpieczeniach można uzyskać i zarządzać nim za pośrednictwem centralnego portalu SQL ADS.

> [!NOTE]
> Ocena luk w zabezpieczeniach jest obsługiwana w przypadku Azure SQL Database, wystąpienia zarządzanego usługi Azure SQL i Azure SQL Data Warehouse. Dla uproszczenia SQL Database jest używany w tym artykule w przypadku odwoływania się do dowolnych z tych zarządzanych usług baz danych.

## <a name="the-vulnerability-assessment-service"></a>Usługa oceny luk w zabezpieczeniach

Ocena luk w zabezpieczeniach SQL (VA) to usługa, która zapewnia wgląd w stan zabezpieczeń i zawiera czynności do wykonania w celu rozwiązywania problemów z zabezpieczeniami i zwiększania bezpieczeństwa bazy danych. Może Ci pomóc:  

- Spełniaj wymagania dotyczące zgodności, które wymagają raportów skanowania bazy danych.  
- Poznaj standardy prywatności danych.  
- Monitoruj dynamiczne środowisko bazy danych, w którym zmiany są trudne do śledzenia.  

Ocena luk w zabezpieczeniach to usługa skanowania wbudowana w usługę Azure SQL Database. Usługa korzysta z bazy wiedzy o regułach, które oflagują luki w zabezpieczeniach i wyróżniają odchylenia od najlepszych rozwiązań, takich jak niepotrzebne konfiguracje, nadmierne uprawnienia i niechronione dane poufne. Zasady są oparte na najlepszych rozwiązaniach firmy Microsoft i koncentrują się na problemach z bezpieczeństwem, które stanowią największe ryzyko dla bazy danych i jej cennych danych. Obejmują zarówno problemy na poziomie bazy danych, jak i problemy z zabezpieczeniami na poziomie serwera, takie jak ustawienia zapory serwera i uprawnienia na poziomie serwera. Te reguły reprezentują także wiele wymagań z różnych organów regulacyjnych w celu spełnienia ich standardów zgodności.  

Wyniki skanowania obejmują kroki umożliwiające rozwiązanie problemu i zapewniają dostosowane skrypty korygowania, jeśli ma to zastosowanie. Raport oceny można dostosować do środowiska przez ustawienie akceptowalnego planu bazowego dla konfiguracji uprawnień, konfiguracji funkcji i ustawień bazy danych.

## <a name="implementing-vulnerability-assessment"></a>Implementowanie oceny luk w zabezpieczeniach

Poniższe kroki implementują VA na SQL Database.  

### <a name="1-run-a-scan"></a>1. Uruchom skanowanie  

Rozpocznij pracę z VA, przechodząc do sekcji **Zaawansowane zabezpieczenia danych** w obszarze nagłówka zabezpieczenia w okienku Azure SQL Database. Kliknij, aby włączyć zaawansowane zabezpieczenia danych, a następnie kliknij pozycję **Wybierz magazyn** lub kartę **Ocena luk w zabezpieczeniach** , która automatycznie otwiera kartę Ustawienia oceny luk w zabezpieczeniach dla całego serwera SQL.

Zacznij od skonfigurowania konta magazynu, w którym będą przechowywane wyniki skanowania dla wszystkich baz danych na serwerze. Informacje o kontach magazynu znajdują się w temacie [Informacje o kontach usługi Azure Storage](../storage/common/storage-create-storage-account.md). Po skonfigurowaniu magazynu kliknij przycisk **Skanuj** , aby skanować bazę danych pod kątem luk w zabezpieczeniach.
  
![Skanowanie bazy danych](./media/sql-vulnerability-assessment/pp_va_initialize.png)  

  > [!NOTE]
  > Skanowanie jest lekkie i bezpieczne. Uruchomienie programu może zająć kilka sekund i jest całkowicie tylko do odczytu. Nie wprowadza żadnych zmian w bazie danych.  

### <a name="2-view-the-report"></a>2. Wyświetl raport

Po zakończeniu skanowania raport skanowania zostanie automatycznie wyświetlony w Azure Portal. Ten raport przedstawia przegląd stanu zabezpieczeń: liczbę znalezionych problemów i ich odpowiednich serwerów. Wyniki obejmują ostrzeżenia dotyczące odchyleń od najlepszych rozwiązań i migawki ustawień związanych z zabezpieczeniami, takich jak podmioty zabezpieczeń bazy danych i role i powiązane z nimi uprawnienia. Raport skanowania zawiera również mapę poufnych danych odnalezionych w bazie danych i zawiera zalecenia dotyczące klasyfikowania tych danych przy użyciu funkcji [odnajdywania danych &](sql-database-data-discovery-and-classification.md).

![Wyświetl raport](./media/sql-vulnerability-assessment/pp_main_getstarted.png)  

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. analizowanie wyników i rozwiązywanie problemów

Przejrzyj wyniki i określ wyniki w raporcie, które mają prawdziwe problemy z zabezpieczeniami w danym środowisku. Przechodzenie do szczegółów każdego wyniku nie powiodło się, aby zrozumieć wpływ wyszukiwania i dlaczego każde sprawdzenie zabezpieczeń nie powiodło się. Aby rozwiązać ten problem, użyj informacji o korygowaniu z możliwością działania udostępnianych przez raport.  

![Analizowanie raportu](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Ustaw linię bazową

Podczas przeglądania wyników oceny można oznaczyć określone wyniki jako akceptowalną *linię bazową* w środowisku. Linia bazowa polega głównie na dostosowywaniu sposobu zgłaszania wyników. Wyniki, które pasują do linii bazowej, są uznawane za przekazanie podczas kolejnych skanów. Po ustaleniu stanu zabezpieczeń linii bazowej tylko raporty o odchyleniach od linii bazowej mogą być skoncentrowane na odpowiednich problemach.  

![Ustaw linię bazową](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)  

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. Uruchom nowe skanowanie, aby wyświetlić dostosowany raport śledzenia

Po zakończeniu konfigurowania **linii bazowych reguł**Uruchom nowe skanowanie, aby wyświetlić dostosowany raport. VA teraz zgłasza tylko problemy z zabezpieczeniami odbiegające od zatwierdzonego stanu linii bazowej.

![Wyświetl dostosowany raport](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)  

Ocenę luk w zabezpieczeniach można teraz używać do monitorowania, czy baza danych zapewnia wysoki poziom bezpieczeństwa przez cały czas i czy zasady organizacyjne są spełnione. Jeśli są wymagane raporty zgodności, w celu ułatwienia procesu zgodności mogą być pomocne raporty z przepisami.  

### <a name="6-set-up-periodic-recurring-scans"></a>6. Skonfiguruj okresowe skanowanie cykliczne

Przejdź do ustawień oceny luk w zabezpieczeniach, aby włączyć **okresowe skanowanie cykliczne**. Spowoduje to skonfigurowanie oceny luk w zabezpieczeniach w celu automatycznego uruchamiania skanowania bazy danych na tydzień. Podsumowanie wyników skanowania zostanie wysłane na adresy e-mail, które zapewniasz.

![Wyświetl dostosowany raport](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. Eksportowanie raportu oceny

Kliknij przycisk **Eksportuj wyniki skanowania** , aby utworzyć raport programu Excel do pobrania z wynikami skanowania. Ten raport zawiera kartę Podsumowanie wyświetlającą podsumowanie oceny, w tym wszystkie testy zakończone niepowodzeniem. Zawiera również kartę **wyników** zawierającą pełny zestaw wyników skanowania, w tym wszystkie testy, które zostały uruchomione, oraz szczegóły wyników dla każdego z nich.

### <a name="8-view-scan-history"></a>8. Wyświetl historię skanowania

Kliknij pozycję **historia skanowania** w okienku VA, aby wyświetlić historię wszystkich skanów uruchomionych wcześniej w tej bazie danych. Wybierz konkretne skanowanie na liście, aby wyświetlić szczegółowe wyniki tego skanowania.

Ocenę luk w zabezpieczeniach można teraz używać do monitorowania, czy baza danych zapewnia wysoki poziom bezpieczeństwa przez cały czas i czy zasady organizacyjne są spełnione. Jeśli są wymagane raporty zgodności, w celu ułatwienia procesu zgodności mogą być pomocne raporty z przepisami.

## <a name="manage-vulnerability-assessments-using-azure-powershell"></a>Zarządzanie ocenami luk w zabezpieczeniach przy użyciu Azure PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Moduł Azure Resource Manager programu PowerShell jest nadal obsługiwany przez Azure SQL Database, ale wszystkie przyszłe Programowanie dla modułu AZ. SQL. W przypadku tych poleceń cmdlet zobacz [AzureRM. SQL](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Argumenty poleceń polecenia AZ module i w modułach AzureRm są zasadniczo identyczne.

Za pomocą poleceń cmdlet Azure PowerShell można programowo zarządzać ocenami luk w zabezpieczeniach. Obsługiwane polecenia cmdlet są następujące:

- [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting)

  Aktualizuje ustawienia oceny luk w zabezpieczeniach bazy danych
- [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting)

  Zwraca ustawienia oceny luk w zabezpieczeniach bazy danych
- [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting)

  Czyści ustawienia oceny luk w zabezpieczeniach bazy danych
- [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Ustawia linię bazową reguły oceny luk w zabezpieczeniach.
- [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Pobiera linię bazową reguły oceny luk w zabezpieczeniach dla danej reguły.
- [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Czyści linię bazową reguły oceny luk w zabezpieczeniach. Najpierw ustaw linię bazową przed użyciem tego polecenia cmdlet, aby usunąć jego zaznaczenie.
- [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan)

  Wyzwala rozpoczęcie skanowania oceny luk w zabezpieczeniach
- [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord)

   Pobiera wszystkie rekordy skanowania do oceny luk w zabezpieczeniach skojarzone z daną bazą danych.
- [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan)

  Konwertuje wyniki skanowania oceny luk w zabezpieczeniach do pliku programu Excel

Aby zapoznać się z przykładem skryptu, zobacz temat [Obsługa programu PowerShell w usłudze Azure SQL](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessments-baseline-rules-using-azure-resource-manager-templates"></a>Zarządzanie regułami bazowymi ocen luk w zabezpieczeniach przy użyciu szablonów Azure Resource Manager

Gdy configurng są podstawy oceny luk w zabezpieczeniach przy użyciu szablonów Azure Resource Manager, musisz użyć typu `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines`.

Przed dodaniem linii bazowych upewnij się, że włączono vulnerabilityAssements na SQL Server.

Zobacz przykład definiowania reguły linii bazowej VA2065 do masterdb i VA1143 bazy danych użytkownika jako zasoby w szablonach ARM:

```json
    "resources": [
        {
            "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
            "apiVersion": "2018-06-01-preview",
            "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
            "properties": {
                "baselineResults": [
                    {
                        "result": [
                                "FirewallRuleName3",
                                "StartIpAddress",
                                "EndIpAddress"
                                  ]
                    },{
                         "result": [
                                "FirewallRuleName4",
                                "62.92.15.68",
                                "62.92.15.68"
                            ]
                        
                    }
                ]
            },
        {
            "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
            "apiVersion": "2018-06-01-preview",
            "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
            ],
            "properties": {
                "baselineResults": [
                    {
                        "result": [
                            "dbo"
                        ]
                    }
                ]
            }
        }
    ]
}   
```

W przypadku bazy danych użytkownika i bazy danych Master nazwy zasobów są zdefiniowane inaczej:

* Baza danych Master — "name": "[concat (Parameters (" server_name "),"/", Parameters (" database_name "),"/default/VA2065/<b>Master</b>")]",
* Baza danych użytkownika — "name": "[concat (Parameters (" server_name "),"/", Parameters (" database_name "),"/default/VA2065/<b>default</b>")]",
 
## <a name="next-steps"></a>Następne kroki  

- Dowiedz się więcej o [zaawansowanych zabezpieczeniach danych](sql-database-advanced-data-security.md)
- Dowiedz się więcej na temat [klasyfikacji & odnajdywania danych](sql-database-data-discovery-and-classification.md)
