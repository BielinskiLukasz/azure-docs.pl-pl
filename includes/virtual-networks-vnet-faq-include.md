## Virtual Network の基礎

### Azure Virtual ネットワーク (VNet) とは何ですか。

VNet を使用してプロビジョニングして Azure で仮想プライベート ネットワーク (VPN) を管理および、必要に応じて、VNet を Azure で他の VNet とリンクさせたり、オンプレミス IT インフラストラクチャで、ハイブリッドまたはクロスプレミス ソリューションを作成します。 作成したそれぞれの VNet には独自の CIDR ブロックを持っており、他の VNet や、CIDR ブロックが競合しない限りオンプレミス ネットワークにリンクすることができます。 VNet の DNS サーバー設定と、サブネットへの VNet の分割も制御できます。

VNet を使用して次のことが行えます。

- 専用プライベート クラウドのみの仮想ネットワークを作成します。

    場合によって、ソリューションの、クロスプレミス構成は必要ありません。 VNet を作成するとき、ご使用のサービスと VNet 内の VMが、クラウド内で互いに直接かつ安全に通信することができます。 これによって、VNet 内にトラフィックが安全に保持されますが、 VM と、ソリューションの一部としてインターネット通信を必要とするサービスとのエンドポイント接続を構成することができます。

- データ センターを安全に拡張します。

    VNet については、データ センターの容量を安全にスケールできるよう従来のサイト間 (S2S) VPN を構築できます。 S2S VPN は、IPSEC を使用して、社内の VPN ゲートウェイと Azure 間の安全な接続を提供します。

- ハイブリッド クラウドのシナリオを有効にします。

    VNet は、さまざまなハイブリッド クラウド シナリオをサポートする柔軟性を提供します。 メインフレームなどのオンプレミス システムと Unix システムの任意の型へのクラウド ベースのアプリケーションを安全に接続することができます。

### 仮想ネットワークが必要かどうかを知る方法

参照してください、 [仮想ネットワークの概要](virtual-networks-overview.md) にするための最適なネットワーク設計オプションの決定に役立つディシジョン テーブルを参照してください。

### 開始するには?

参照してください [Virtual Network ドキュメント](http://azure.microsoft.com/documentation/services/virtual-network/) 開始します。 このページには、一般的な構成手順だけでなく、仮想ネットワークを設計する際に考慮する必要がある内容を理解するのに役立つ情報へのリンクがあります。

### VNet でどのようなサービスを使用できますか。

VNet は、Cloud Services (PaaS)、Virtual Machines、Web Apps など、さまざまな異なる Azure サービスで使用できます。 ただし、VNet でサポートされていない、いくつかのサービスがあります。 使用したい特定のサービスをチェックし、互換性があることを確認してください。

### クロスプレミス接続を使用しないで VNet を使用できますか。

はい。 サイト間接続を使用せずに VNet を使用することができます。 これは、Azure でドメイン コントローラーと SharePoint ファームを実行する場合に特に便利です。

## Virtual Network の構成

### VNet を作成するのには、どのようなツールを使用でしょうか。

作成または仮想ネットワークを構成するのには、次のツールを使用できます。

- 管理ポータルを使用することができます。 参照してください [を仮想ネットワーク (VNet) のプロパティを管理する方法](virtual-networks-settings.md)します。

- ネットワーク構成ファイル (netcfg) を使用することができます。 参照してください [ネットワーク構成ファイルを使用して、仮想ネットワークを構成する](virtual-networks-using-network-configuration-file.md)します。

### VNet でどのアドレス範囲が使用できるでしょうか。

パブリック IP アドレス範囲を使用してで定義されている任意の IP アドレス範囲 [RFC 1918](http://tools.ietf.org/html/rfc1918)します。

### VNet 内でパブリック IP アドレスを持つことができますか。

はい。 パブリック IP アドレス範囲の詳細については、次を参照してください。 [Virtual Network (VNet) のパブリック IP アドレス空間](virtual-networks-public-ip-within-vnet.md)します。 パブリック IP が、インターネットから直接アクセスできないことに留意してください。

### 仮想ネットワーク内のサブネットの数に制限はありますか。

VNet 内で使用できるサブネットの数に制限はありません。 すべてのサブネットは仮想ネットワーク アドレス空間に完全に含める必要があり、また、互いに重複しないようにしてください。

### これらのサブネット内の IP アドレスの使用に関する制限はありますか。

Azure は、各サブネット内で一部の IP アドレスを予約します。 サブネットの最初と最後の IP アドレスは、Azure サービスで使用される 3 つ以上のアドレスと共に、プロトコル準拠に予約されます。

### VNet およびサブネットは、どれくらい小規模に、また、大規模になるのでしょうか。

サポートする最小のサブネットは /29 、最大は /8 です (CIDR サブネット定義を使用)。

### VNet を使用して、VLAN を Azure に接続できるでしょうか。

番号 Vnet は、レイヤー 3 のオーバーレイです。 Azure では、任意のレイヤー 2 のセマンティクスはサポートされません。

### 私の Vnet とサブネットをカスタム ルーティング ポリシーを指定できますか。

はい。 ユーザー定義のルーティング (UDR) を使用することができます。 UDR の詳細については、次を参照してください。 [ユーザー定義のルートと IP 転送](virtual-networks-udr-overview.md)します。

### VNet はマルチキャストやブロードキャストをサポートしますか。

番号 マルチキャストまたはブロードキャストはサポートされていません。

### VNet 内はどのようなプロトコルを使用できますか。

VNet 内の標準 IP ベースのプロトコルを使用することができます。 ただし、マルチキャスト、ブロードキャスト、IP-in-IP のカプセル化されたパケット、Generic Routing Encapsulation (GRE) のパケットは、VNet 内でブロックされます。 作動する標準プロトコルは、次のとおりです。

- TCP
- UDP
- ICMP

### VNet 内には、既定ルーターを ping できるでしょうか。

番号

### Tracert を使用して、接続を診断することができますか。

番号

### VNet を作成した後のサブネットを追加できますか。

はい。 サブネット アドレスが VNet 内の別のサブネットの一部でない限り、サブネットはいつでも VNet に追加できます。

### 作成した後、VNet サイズのサイズを変更できますか。

PowerShell コマンドレットまたは NETCFG ファイルを使用してその中にデプロイされた VM やサービスがない場合は、サブネットを追加、削除、展開または圧縮できます。 VM やサービスを含むサブネットが変更の影響を受けない限り、プレフィックスを追加、削除、展開、圧縮ができます。

### サブネットを作成後に変更できますか。

はい。 VNet で使用された CIDR ブロックを追加、削除、変更することができます。

### VNet でサービスを実行している場合、インターネットに接続できますか。

はい。 VNet 内にデプロイされているすべてのサービスは、インターネットに接続できます。 Azure にデプロイされたすべてのクラウド サービスには、アドレス指定可能な VIP がパブリックに割り当てられています。 PaaS ロールの入力エンドポイントと仮想マシンのエンドポイントを定義して、これらのサービスがインターネットからの接続を承諾できるようにする必要があります。

### VNet は IPv6 をサポートするでしょうか。

番号 この時点で、Vnet で IPv6 を使用することはできません。

### VNet は複数のリージョンで広がるでしょうか。

番号 VNet は、1 つのリージョンに制限されます。

### VNet を Azure での別の VNet に接続できますか。

はい。 REST API または Windows PowerShell を使用して VNet 間の通信を作成できます。 参照してください [VNet 間接続を構成する](virtual-networks-configure-vnet-to-vnet-connection.md)します。

## 名前解決 (DNS)

### VNet の DNS オプションとは何でしょうか。

あるディシジョン テーブルを使用して、 [Vm とロール インスタンスの名前解決](virtual-networks-name-resolution-for-vms-and-role-instances.md) にすべての DNS を指示するページが使用可能なオプションです。

### VNet の DNS サーバーを指定できますか。

はい。 VNet 設定では、DNS サーバーの IP アドレスを指定できます。 これにより、VNet 内のすべての VM の既定の DNS サーバーとして適用されます。

### DNS サーバーの数を指定できますか。

最大 12 個の DNS サーバーを指定することができます。

### ネットワークを作成した後、DNS サーバーを変更できますか。

はい。 いつでも、VNet の DNS サーバーの一覧を変更できます。 DNS サーバーの一覧を変更する場合は、新しい DNS サーバーを取得するために VNet で VM をそれぞれ再起動する必要があります。


### Azure で提供される DNS と Vnet と組み合わせて使用について

Azure で提供される DNS は、Microsoft によって提供されるマルチ テナント DNS サービスです。 Azure はこのサービス内のすべての VM とロール インスタンスを登録します。 このサービスは、同じクラウド サービス内に含まれる VM とロール インスタンスのホスト名によって、また、同じ VNet 内の VM とロール インスタンスの FQDN によって名前解決を提供します。
> [AZURE.NOTE] Azure で提供される DNS を使用して、テナント間の名前解決のため、仮想ネットワーク内の最初の 100 個のクラウド サービスには、この時点で制限があります。 独自の DNS サーバーを使用している場合は、この制限は適用されません。

### VM ごとに、サービスごとに DNS 設定を上書きできますか。

はい。 クラウド サービスごとに DNS サーバーを設定し、既定のネットワーク設定を上書きすることができます。 ただし、できるだけネットワーク全体の DNS を使用することをお勧めします。

### 独自の DNS サフィックスを取り込むことができますか。

番号 Vnet には、カスタムの DNS サフィックスを指定できません。

## VNet および VM

### VNet に VM をデプロイできますか。

はい。

### VNet に Linux VM をデプロイできますか。

はい。 Azure でサポートされている Linux のすべてのディストリビューションをデプロイすることができます。

### パブリック VIP と内部 IP アドレスの違いとは?

- 内部 IP アドレスは DHCP によって各 VNet 内の VM に割り当てられている IP アドレスです。 パブリック対象ではありません。 VNet を作成した場合は、ご使用の VNet のサブネット設定で指定した範囲から内部 IP アドレスが割り当てられます。 VNet がない場合は、内部 IP アドレスが割り当てられます。 内部 IP アドレスは、VMが割り当て解除されていなければ、VM がある間は共にとどまります。

- パブリック VIP とは、クラウド サービスまたはロード バランサーに割り当てられているパブリック IP アドレスです。 ご使用のVM の NIC に直接割り当てられていません。 VIP は、クラウド サービスが割り当て解除または削除されるまで、割り当てられているクラウド サービスと共にとどまります。 その時点でリリースされます。

### VM が受信するのはどの IP アドレスでしょうか。

- **内部 IP アドレス -** VM を VNet にデプロイする場合は、VM は、指定した内部 IP アドレスのプールから内部 IP アドレスを受信します。 Vm は、内部 IP アドレスを使用して、Vnet 内で通信します。 Azure では動的内部 IP アドレスが割り当てられますが、ご使用の VM の静的アドレスを要求できます。 静的内部 IP アドレスの詳細については、次を参照してください。 [静的内部 ip アドレスを設定する方法](virtual-networks-reserved-private-ip.md)します。

- **VIP -** VIP は VM に直接割り当てることはありませんが、ご使用の VM も VIP と関連付けられます。 VIP は、クラウド サービスに割り当てられるパブリック IP アドレスです。 必要に応じて、クラウド サービスの VIP を予約することができます。 参照してください [予約済みパブリック IP](virtual-networks-reserved-public-ip.md)します。

- **ILPIP -**インスタンスレベル パブリック IP アドレス (ILPIP) を構成することもできます。 ILPIP はクラウド サービスではなく、VM に直接関連付けられます。 ILPIPs に関する詳細については、次を参照してください。 [インスタンス レベル パブリック IP の概要](virtual-networks-instance-level-public-ip.md)します。

### 後で作成する VM の内部 IP アドレスを予約できますか。

番号 内部 IP アドレスを予約することはできません。 Iternal IP アドレスが使用可能な場合は、DHCP サーバーによって、VM またはロール インスタンスに割り当てられます。 その VM は、内部 IP アドレスを割り当てさせたいマシンの場合もあるし、そうでない場合もあります。 ただし、すでに作成済みの VM の内部 IP アドレスを、使用可能な内部 IP アドレスに変更することができます。

### 内部 IP アドレスを、VNet 内の VM 用に変更しますか。

はい。 内部 IP アドレスしない限り、VM と有効期間にわたって、VM の割り当てが解除します。 VM が割り当て解除されると、VM の静的内部 IP アドレスを定義しない限り、内部 IP アドレスが解放されます。 VM が単純に停止している場合 (**停止 (割り当て解除)**状態になっていない)、IP アドレスは、VM に割り当てられたままです。

### 手動で IP アドレスを VM の NIC に割り当てられますか。

番号 Vm のインターフェイス プロパティを変更する必要がありません。 どの変更も、VM への接続が失われる可能性があります。

### VM をシャットダウンする場合、IP アドレスはどうなりますか。

何もありません。 IP アドレス (パブリック VIP と内部 IP アドレスの両方) は、クラウド サービスまたは VM と共にとどまります。
> [AZURE.NOTE] 単に VM をシャットダウンしたい場合、管理ポータルを使用しないでください。 現時点では、シャットダウン ボタンをクリックすると、仮想マシンの割り当てが解除されます。

### VNet 内で 1 つのサブネットからもう 1 つのサブネットへと、再デプロイせずに移動できますか。

はい。 詳細情報が記載 [ここ](virtual-networks-move-vm-role-to-subnet.md)します。

### VM に静的な MAC アドレスを構成できますか。

番号 MAC アドレスを静的に構成することはできません。

### MAC アドレスは、一度作成されると、VM で同じものとして残りますか。

いいえ、ただし変化するのは停止済み (割り当て解除済み) 状態になった場合だけです。 ユーザーが VM のサイズを変更したり再起動した場合、またはサービス復旧やホスト サーバーの計画的なメンテナンスの場合は、MAC アドレスは維持されます。

### VNet 内の VM からインターネットに接続できますか。

はい。 VNet 内にデプロイされているすべてのサービスは、インターネットに接続できます。 また、Azure にデプロイされたすべてのクラウド サービスには、パブリックにアドレス指定可能な VIP が割り当てられています。 PaaS ロールの入力エンドポイントと vm をインターネットからの接続を受け入れるようにこれらのサービスを有効にするためにエンドポイントを定義する必要があります。

## VNet とサービス

### VNet でどのようなサービスを使用できますか。

VNet 内のコンピューティング サービスのみ使用できます。 Compute Services は、Cloud Services (web ロールと worker ロール) および VM に制限されます。

### Web Apps を Virtual Network と連動できますか。

はい。 ASE (App Service Environment) を使用して VNet 内に Web Apps をデプロイできます。 さらに、VNet にポイント対サイトの 構成をした場合、Web Apps を安全に接続して、Azure VNet 内のリソースにアクセスできます。 詳細については、次のトピックを参照してください。


- [App Service 環境で Web アプリの作成](app-service-web-how-to-create-a-web-app-in-an-ase.md)

- [Web Apps Virtual Network の統合](http://azure.microsoft.com/blog/2014/09/15/azure-websites-virtual-network-integration/)

- [Web Apps で VNet 統合とハイブリッド接続を使用](http://azure.microsoft.com/blog/2014/10/30/using-vnet-or-hybrid-conn-with-websites/)

- [Web アプリを統合する Azure 仮想ネットワーク](web-sites-integrate-with-vnet.md)

### クラウド サービスを VNet 内の Web ロールと worker ロール (PaaS) でデプロイできますか。

はい。 VNet 内で PaaS サービスをデプロイすることができます。

### VNet に PaaS ロールをデプロイする方法

これは、サービス構成のネットワーク構成セクションで、VNet の名前と、ロールとサブネットのマッピングを指定することで実現できます。 どのバイナリも更新する必要はありません。

### サービスを VNet 内外で移動できますか。

番号 サービスを Vnet 内外で移動することはできません。 別の VNet に移動するには、サービスを削除し再デプロイする必要があります。

## VNet とセキュリティ

### VNet のセキュリティ モデルとは何ですか。

Vnet は、1 つの別の機能と、Azure インフラストラクチャでホストされている他のサービスから完全に分離します。 VNet は、トラスト バウンダリです。

### VNet で、ACL または NSG を定義できますか。

番号 Acl または Nsg を Vnet に関連付けることはできません。 ただし、ACL が、VNet にデプロイされている VM の入力エンドポイントで定義されている場合、NSG は、サブネットまたは NIC に関連付けられます。

### VNet セキュリティに関するホワイト ペーパーはありますか。

はい。 ダウンロードする [ここ](http://go.microsoft.com/fwlink/?LinkId=386611)します。

## API、スキーマ、およびツール

### VNet をコードから管理できますか。

はい。 REST API を使用すると、VNet およびクロスプレミス接続を管理することができます。 詳細を参照して [ここ](http://go.microsoft.com/fwlink/?LinkId=296833)します。

### VNet に対するツール サポートはありますか。

はい。 各種プラットフォームで PowerShell とコマンド ライン ツールを使用することができます。 詳細を参照して [ここ](http://go.microsoft.com/fwlink/?LinkId=317721)します。





