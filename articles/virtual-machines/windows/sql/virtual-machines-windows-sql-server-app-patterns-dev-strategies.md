---
title: Wzorce aplikacji programu SQL Server na maszynach wirtualnych | Dokumenty firmy Microsoft
description: W tym artykule omówiono wzorce aplikacji dla programu SQL Server na maszynach wirtualnych platformy Azure. Zapewnia architektom rozwiązań i deweloperom podstawę dobrej architektury i projektowania aplikacji.
services: virtual-machines-windows
documentationcenter: na
author: MashaMSFT
manager: jroth
editor: ''
tags: azure-service-management,azure-resource-manager
ms.assetid: 41863c8d-f3a3-4584-ad86-b95094365e05
ms.service: virtual-machines-sql
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/31/2017
ms.author: mathoma
ms.openlocfilehash: cbc2bfbb68910c3eb12352bebb575c4548885a24
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/27/2020
ms.locfileid: "70124028"
---
# <a name="application-patterns-and-development-strategies-for-sql-server-in-azure-virtual-machines"></a>Wzorce aplikacji i strategie rozwoju dla programu SQL Server w maszynach wirtualnych platformy Azure
[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="summary"></a>Podsumowanie:
Określenie wzorca aplikacji lub wzorców do użycia dla aplikacji opartych na programie SQL-Server w środowisku platformy Azure jest ważną decyzją projektową i wymaga solidnego zrozumienia, jak program SQL Server i każdy składnik infrastruktury platformy Azure współpracują ze sobą. Dzięki programowi SQL Server w usługach infrastruktury platformy Azure można łatwo migrować, obsługiwać i monitorować istniejące aplikacje programu SQL Server wbudowane w system Windows Server na maszyny wirtualne na platformie Azure.

Celem tego artykułu jest zapewnienie architektom rozwiązań i deweloperom podstawy dla dobrej architektury aplikacji i projektowania, które mogą być obserwowane podczas migracji istniejących aplikacji na platformę Azure, a także tworzenia nowych aplikacji na platformie Azure.

Dla każdego wzorca aplikacji znajdziesz scenariusz lokalny, jego odpowiednie rozwiązanie z obsługą chmury i powiązane zalecenia techniczne. Ponadto w tym artykule omówiono strategie rozwoju specyficzne dla platformy Azure, dzięki czemu można poprawnie zaprojektować aplikacje. Ze względu na wiele możliwych wzorców aplikacji zaleca się, aby architekci i deweloperzy wybrali najbardziej odpowiedni wzorzec dla swoich aplikacji i użytkowników.

**Współautorzy techniczni:** Luis Carlos Vargas Śledź, Madhan Arumugam Ramakrishnan

**Recenzenci techniczni:** Corey Sanders, Drew McDaniel, Narayan Annamalai, Nir Mashkowski, Sanjay Mishra, Silvano Coriani, Stefan Schackow, Tim Hickey, Tim Wieman, Xin Jin

## <a name="introduction"></a>Wprowadzenie
Można opracować wiele typów aplikacji n-warstwowych, oddzielając składniki różnych warstw aplikacji na różnych komputerach, a także w oddzielnych składnikach. Na przykład można umieścić składniki reguł aplikacji klienckiej i biznesowych na jednym komputerze, warstwie sieci web frontonu i składnikach warstwy dostępu do danych na innym komputerze oraz warstwę zaplecza bazy danych na innym komputerze. Ten rodzaj struktury pomaga odizolować każdą warstwę od siebie. Jeśli zmienisz, skąd pochodzą dane, nie trzeba zmieniać klienta lub aplikacji sieci web, ale tylko składniki warstwy dostępu do danych.

Typowa aplikacja *n-warstwowa* zawiera warstwę prezentacji, warstwę biznesową i warstwę danych:

| Warstwa | Opis |
| --- | --- |
| **Prezentacja** |*Warstwa prezentacji* (warstwa sieci web, warstwa front-end) to warstwa, w której użytkownicy wchodzą w interakcję z aplikacją. |
| **Firmowe** |*Warstwa biznesowa* (warstwa środkowa) to warstwa używana przez warstwę prezentacji i warstwę danych do komunikowania się ze sobą i zawierająca podstawowe funkcje systemu. |
| **Dane** |Warstwa *danych* jest zasadniczo serwer, który przechowuje dane aplikacji (na przykład serwer z systemem SQL Server). |

Warstwy aplikacji opisują logiczne grupowania funkcji i składników w aplikacji; warstwy opisują fizyczną dystrybucję funkcji i składników na oddzielnych serwerach fizycznych, komputerach, sieciach lub lokalizacjach zdalnych. Warstwy aplikacji mogą znajdować się na tym samym komputerze fizycznym (tej samej warstwie) lub mogą być rozmieszczone na oddzielnych komputerach (n-warstwowych), a składniki w każdej warstwie komunikują się ze składnikami w innych warstwach za pośrednictwem dobrze zdefiniowanych interfejsów. Można myśleć o warstwie termin jako odnoszące się do wzorców dystrybucji fizycznej, takich jak dwuwarstwowe, trzywarstwowe i n-warstwowe. **Wzorzec aplikacji 2-warstwowy** zawiera dwie warstwy aplikacji: serwer aplikacji i serwer bazy danych. Bezpośrednia komunikacja odbywa się między serwerem aplikacji a serwerem bazy danych. Serwer aplikacji zawiera składniki warstwy sieci web i warstwy biznesowej. W **3-warstwowym wzorcu aplikacji**istnieją trzy warstwy aplikacji: serwer sieci web, serwer aplikacji, który zawiera warstwę logiki biznesowej i/lub składniki dostępu do danych warstwy biznesowej oraz serwer bazy danych. Komunikacja między serwerem sieci web a serwerem bazy danych odbywa się za pośrednictwem serwera aplikacji. Aby uzyskać szczegółowe informacje na temat warstw i warstw aplikacji, zobacz [Przewodnik architektury aplikacji firmy Microsoft](https://msdn.microsoft.com/library/ff650706.aspx).

Przed rozpoczęciem czytania tego artykułu należy mieć wiedzę na temat podstawowych pojęć programu SQL Server i platformy Azure. Aby uzyskać więcej informacji, zobacz [SQL Server Books Online](https://msdn.microsoft.com/library/bb545450.aspx), SQL Server w [usłudze Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md) and [Azure.com](https://azure.microsoft.com/).

W tym artykule opisano kilka wzorców aplikacji, które mogą być odpowiednie dla prostych aplikacji, a także bardzo złożonych aplikacji korporacyjnych. Przed wyszczególnieniem każdego wzorca zaleca się zapoznanie się z dostępnymi usługami przechowywania danych na platformie Azure, takimi jak [Usługa Azure Storage,](../../../storage/common/storage-introduction.md) [usługa Azure SQL Database](../../../sql-database/sql-database-technical-overview.md)i SQL Server na [maszynie wirtualnej platformy Azure.](virtual-machines-windows-sql-server-iaas-overview.md) Aby podejmować najlepsze decyzje projektowe dla aplikacji, należy dokładnie zrozumieć, kiedy należy wyraźnie korzystać z usługi przechowywania danych.

### <a name="choose-sql-server-in-an-azure-virtual-machine-when"></a>Wybierz program SQL Server na maszynie wirtualnej platformy Azure, gdy:
* Potrzebujesz kontroli na SQL Server i Windows. Na przykład może to obejmować wersję programu SQL Server, specjalne poprawki, konfigurację wydajności itp.
* Potrzebujesz pełnej zgodności z sql server lokalnie i chcesz przenieść istniejące aplikacje na platformę Azure, jak jest.
* Chcesz korzystać z możliwości środowiska platformy Azure, ale usługa Azure SQL Database nie obsługuje wszystkich funkcji, których wymaga aplikacja. Może to obejmować następujące obszary:
  
  * **Rozmiar bazy danych:** W czasie aktualizacji tego artykułu baza danych SQL obsługuje bazę danych o pojemności do 1 TB danych. Jeśli aplikacja wymaga więcej niż 1 TB danych i nie chcesz implementować niestandardowych rozwiązań dzielenia na fragmenty, zaleca się użycie programu SQL Server na maszynie wirtualnej platformy Azure. Aby uzyskać najnowsze informacje, zobacz [Skalowanie w poziomie bazy danych SQL Azure,](https://msdn.microsoft.com/library/azure/dn495641.aspx) [modelu zakupów opartego na UTU](../../../sql-database/sql-database-service-tiers-dtu.md)i [modelu zakupu opartego na wynikach wirtualnych](../../../sql-database/sql-database-service-tiers-vcore.md)(wersja zapoznawcza).
  * **Zgodność z hipaa:** klienci służby zdrowia i niezależni dostawcy oprogramowania (ISV) mogą wybrać [program SQL Server w maszynach wirtualnych platformy Azure](virtual-machines-windows-sql-server-iaas-overview.md) zamiast bazy danych SQL [Azure,](../../../sql-database/sql-database-technical-overview.md) ponieważ program SQL Server na maszynie wirtualnej platformy Azure jest objęty umową HIPAA Business Associate Agreement (BAA). Aby uzyskać informacje na temat zgodności, zobacz [Centrum zaufania platformy Microsoft Azure: Zgodność](https://azure.microsoft.com/support/trust-center/compliance/).
  * **Funkcje na poziomie wystąpienia:** W tej chwili baza danych SQL nie obsługuje funkcji, które znajdują się poza bazą danych (takich jak serwery połączone, zadania agenta, filestream, service broker itp.). Aby uzyskać więcej informacji, zobacz [Wskazówki i ograniczenia bazy danych SQL platformy Azure](https://msdn.microsoft.com/library/azure/ff394102.aspx).

## <a name="1-tier-simple-single-virtual-machine"></a>1-warstwowy (prosty): pojedyncza maszyna wirtualna
W tym wzorzec aplikacji można wdrożyć aplikację i bazę danych programu SQL Server na autonomicznej maszynie wirtualnej na platformie Azure. Ta sama maszyna wirtualna zawiera aplikację klienta/sieci web, składniki biznesowe, warstwę dostępu do danych i serwer bazy danych. Kod dostępu do prezentacji, firmy i danych są logicznie oddzielone, ale fizycznie znajdują się na komputerze z jednym serwerem. Większość klientów rozpoczyna się od tego wzorca aplikacji, a następnie skalować w poziomie, dodając więcej ról sieci web lub maszyn wirtualnych do swojego systemu.

Ten wzorzec aplikacji jest przydatny, gdy:

* Chcesz przeprowadzić prostą migrację do platformy Azure, aby ocenić, czy platforma odpowiada na wymagania aplikacji, czy nie.
* Chcesz zachować wszystkie warstwy aplikacji hostowane na tej samej maszynie wirtualnej w tym samym centrum danych platformy Azure, aby zmniejszyć opóźnienia między warstwami.
* Chcesz szybko aprowizować środowiska programistyczne i testowe na krótkie okresy czasu.
* Chcesz przeprowadzić testy warunków skrajnych dla różnych poziomów obciążenia, ale jednocześnie nie chcesz posiadać i obsługiwać wielu maszyn fizycznych przez cały czas.

Na poniższym diagramie przedstawiono prosty scenariusz lokalny i jak można wdrożyć jego rozwiązanie z włączoną chmurą na jednej maszynie wirtualnej na platformie Azure.

![Wzorzec aplikacji 1-warstwowy](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728008.png)

Wdrażanie warstwy biznesowej (logiki biznesowej i składników dostępu do danych) w tej samej warstwie fizycznej co warstwa prezentacji może zmaksymalizować wydajność aplikacji, chyba że należy użyć oddzielnej warstwy ze względu na skalowalność lub problemy z zabezpieczeniami.

Ponieważ jest to bardzo typowy wzorzec na początek, można znaleźć następujący artykuł na temat migracji przydatne do przenoszenia danych do maszyny Wirtualnej programu SQL Server: [Migrowanie bazy danych do programu SQL Server na maszynie Wirtualnej platformy Azure](virtual-machines-windows-migrate-sql.md).

## <a name="3-tier-simple-multiple-virtual-machines"></a>3-warstwowy (prosty): wiele maszyn wirtualnych
W tym wzorzec aplikacji wdrożyć 3-warstwowej aplikacji na platformie Azure, umieszczając każdą warstwę aplikacji w innej maszynie wirtualnej. Zapewnia to elastyczne środowisko dla łatwych scenariuszy skalowania w górę i w poziomie. Gdy jedna maszyna wirtualna zawiera aplikację klienta/sieci web, druga hostuje składniki biznesowe, a druga hostuje serwer bazy danych.

Ten wzorzec aplikacji jest przydatny, gdy:

* Chcesz przeprowadzić migrację złożonych aplikacji bazy danych do maszyn wirtualnych platformy Azure.
* Chcesz, aby różne warstwy aplikacji były hostowane w różnych regionach. Na przykład mogą mieć udostępnione bazy danych, które są wdrażane w wielu regionach do celów raportowania.
* Chcesz przenieść aplikacje przedsiębiorstwa z lokalnych zwirtualizowanych platform do maszyn wirtualnych platformy Azure. Aby uzyskać szczegółową dyskusję na temat aplikacji dla przedsiębiorstw, zobacz [Co to jest aplikacja dla przedsiębiorstw](https://msdn.microsoft.com/library/aa267045.aspx).
* Chcesz szybko aprowizować środowiska programistyczne i testowe na krótkie okresy czasu.
* Chcesz przeprowadzić testy warunków skrajnych dla różnych poziomów obciążenia, ale jednocześnie nie chcesz posiadać i obsługiwać wielu maszyn fizycznych przez cały czas.

Na poniższym diagramie pokazano, jak można umieścić prostą aplikację 3-warstwową na platformie Azure, umieszczając każdą warstwę aplikacji na innej maszynie wirtualnej.

![Trójwarstwowy wzorzec aplikacji](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728009.png)

W tym wzorzec aplikacji istnieje tylko jedna maszyna wirtualna (VM) w każdej warstwie. Jeśli masz wiele maszyn wirtualnych na platformie Azure, zaleca się skonfigurowanie sieci wirtualnej. [Usługa Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md) tworzy granicę zabezpieczeń zaufanych, a także umożliwia maszynom wirtualnym komunikowanie się między sobą za pośrednictwem prywatnego adresu IP. Ponadto zawsze upewnij się, że wszystkie połączenia internetowe tylko przejść do warstwy prezentacji. Podczas stosowania tego wzorca aplikacji należy zarządzać regułami sieciowej grupy zabezpieczeń w celu kontrolowania dostępu. Aby uzyskać więcej informacji, zobacz [Zezwalaj na dostęp zewnętrzny do maszyny Wirtualnej przy użyciu witryny Azure portal](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

Na diagramie protokołami internetowymi mogą być protokoły TCP, UDP, HTTP lub HTTPS.

> [!NOTE]
> Konfigurowanie sieci wirtualnej na platformie Azure jest bezpłatne. Jednak opłaty są naliczane dla bramy sieci VPN, która łączy się z lokalnymi. Opłata ta jest oparta na czasie, przez który połączenie jest aprowiedzone i dostępne.
> 
> 

## <a name="2-tier-and-3-tier-with-presentation-tier-scale-out"></a>2-warstwowy i 3-warstwowy ze skalą w poziomie warstwy prezentacji
W tym wzorzec aplikacji można wdrożyć 2-warstwowej lub 3-warstwowej aplikacji bazy danych do maszyn wirtualnych platformy Azure, umieszczając każdą warstwę aplikacji w innej maszynie wirtualnej. Ponadto można skalować w poziomie warstwy prezentacji ze względu na zwiększoną liczbę przychodzących żądań klientów.

Ten wzorzec aplikacji jest przydatny, gdy:

* Chcesz przenieść aplikacje przedsiębiorstwa z lokalnych zwirtualizowanych platform do maszyn wirtualnych platformy Azure.
* Chcesz skalować w poziomie warstwy prezentacji ze względu na zwiększoną liczbę przychodzących żądań klientów.
* Chcesz szybko aprowizować środowiska programistyczne i testowe na krótkie okresy czasu.
* Chcesz przeprowadzić testy warunków skrajnych dla różnych poziomów obciążenia, ale jednocześnie nie chcesz posiadać i obsługiwać wielu maszyn fizycznych przez cały czas.
* Chcesz posiadać środowisko infrastruktury, które można skalować w górę iw dół na żądanie.

Na poniższym diagramie pokazano, jak można umieścić warstwy aplikacji w wielu maszynach wirtualnych na platformie Azure, skalując warstwę prezentacji ze względu na zwiększoną liczbę przychodzących żądań klientów. Jak widać na diagramie, Moduł równoważenia obciążenia platformy Azure jest odpowiedzialny za dystrybucję ruchu na wielu maszynach wirtualnych, a także określanie, z którym serwerem sieci web ma się łączyć. Posiadanie wielu wystąpień serwerów sieci web za modułem równoważenia obciążenia zapewnia wysoką dostępność warstwy prezentacji.

![Wzorzec aplikacji — skalowanie warstwy prezentacji w poziomie](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728010.png)

### <a name="best-practices-for-2-tier-3-tier-or-n-tier-patterns-that-have-multiple-vms-in-one-tier"></a>Najważniejsze wskazówki dotyczące wzorców 2-warstwowych, 3-warstwowych lub n-warstwowych, które mają wiele maszyn wirtualnych w jednej warstwie
Zaleca się umieszczenie maszyn wirtualnych, które należą do tej samej warstwy w tej samej usłudze w chmurze i w tym samym zestawie dostępności. Na przykład umieść zestaw serwerów sieci web w **chmurze CloudService1** i **AvailabilitySet1** oraz zestaw serwerów baz danych w **chmurze CloudService2** i **AvailabilitySet2**. Zestaw dostępności na platformie Azure umożliwia umieszczenie węzłów o wysokiej dostępności w oddzielnych domenach błędów i domenach uaktualnienia.

Aby korzystać z wielu wystąpień maszyn wirtualnych w warstwie, należy skonfigurować moduł równoważenia obciążenia platformy Azure między warstwami aplikacji. Aby skonfigurować moduł równoważenia obciążenia w każdej warstwie, należy utworzyć punkt końcowy z równoważeniem obciążenia na maszynach wirtualnych każdej warstwy oddzielnie. Dla określonej warstwy najpierw utwórz maszyny wirtualne w tej samej usłudze w chmurze. Gwarantuje to, że mają ten sam publiczny wirtualny adres IP. Następnie utwórz punkt końcowy na jednej z maszyn wirtualnych w tej warstwie. Następnie należy przypisać ten sam punkt końcowy do innych maszyn wirtualnych w tej warstwie do równoważenia obciążenia. Tworząc zestaw z równoważeniem obciążenia, można rozdzielić ruch na wiele maszyn wirtualnych, a także umożliwić modułowi równoważenia obciążenia, aby określić, który węzeł do połączenia, gdy węzeł maszyny wirtualnej wewnętrznej bazy danych nie powiedzie się. Na przykład posiadanie wielu wystąpień serwerów sieci web za modułem równoważenia obciążenia zapewnia wysoką dostępność warstwy prezentacji.

Najlepszym rozwiązaniem jest zawsze upewnij się, że wszystkie połączenia internetowe najpierw przejść do warstwy prezentacji. Warstwa prezentacji uzyskuje dostęp do warstwy biznesowej, a następnie warstwa biznesowa uzyskuje dostęp do warstwy danych. Aby uzyskać więcej informacji na temat zezwalania na dostęp do warstwy prezentacji, zobacz [Zezwalanie na dostęp zewnętrzny do maszyny Wirtualnej za pomocą witryny Azure portal](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

Należy zauważyć, że moduł równoważenia obciążenia na platformie Azure działa podobnie do modułów równoważenia obciążenia w środowisku lokalnym. Aby uzyskać więcej informacji, zobacz [Równoważenie obciążenia usług infrastruktury platformy Azure.](../tutorial-load-balancer.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)

Ponadto zaleca się skonfigurowanie sieci prywatnej dla maszyn wirtualnych przy użyciu usługi Azure Virtual Network. Dzięki temu mogą komunikować się między sobą za ich prywatny adres IP. Aby uzyskać więcej informacji, zobacz [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md).

## <a name="2-tier-and-3-tier-with-business-tier-scale-out"></a>2-warstwowy i 3-warstwowy ze skalą w poziomie biznesowym
W tym wzorzec aplikacji można wdrożyć 2-warstwowej lub 3-warstwowej aplikacji bazy danych do maszyn wirtualnych platformy Azure, umieszczając każdą warstwę aplikacji w innej maszynie wirtualnej. Ponadto można rozesłać składniki serwera aplikacji do wielu maszyn wirtualnych ze względu na złożoność aplikacji.

Ten wzorzec aplikacji jest przydatny, gdy:

* Chcesz przenieść aplikacje przedsiębiorstwa z lokalnych zwirtualizowanych platform do maszyn wirtualnych platformy Azure.
* Chcesz dystrybuować składniki serwera aplikacji do wielu maszyn wirtualnych ze względu na złożoność aplikacji.
* Chcesz przenieść logiki biznesowej ciężkich lokalnych lob (line-of-business) aplikacje do maszyn wirtualnych platformy Azure. Aplikacje LOB to zestaw krytycznych aplikacji komputerowych, które są niezbędne do prowadzenia przedsiębiorstwa, takich jak księgowość, zasoby ludzkie (HR), listy płac, zarządzanie łańcuchem dostaw i aplikacje do planowania zasobów.
* Chcesz szybko aprowizować środowiska programistyczne i testowe na krótkie okresy czasu.
* Chcesz przeprowadzić testy warunków skrajnych dla różnych poziomów obciążenia, ale jednocześnie nie chcesz posiadać i obsługiwać wielu maszyn fizycznych przez cały czas.
* Chcesz posiadać środowisko infrastruktury, które można skalować w górę iw dół na żądanie.

Na poniższym diagramie przedstawiono scenariusz lokalny i jego rozwiązanie włączone w chmurze. W tym scenariuszu można umieścić warstwy aplikacji w wielu maszynach wirtualnych na platformie Azure przez skalowanie w poziomie warstwy biznesowej, która zawiera warstwę logiki biznesowej i składniki dostępu do danych. Jak widać na diagramie, Moduł równoważenia obciążenia platformy Azure jest odpowiedzialny za dystrybucję ruchu na wielu maszynach wirtualnych, a także określanie, z którym serwerem sieci web ma się łączyć. Posiadanie wielu wystąpień serwerów aplikacji za modułem równoważenia obciążenia zapewnia wysoką dostępność warstwy biznesowej. Aby uzyskać więcej informacji, zobacz [Najważniejsze rozwiązania dotyczące wzorców aplikacji 2-warstwowych, 3-warstwowych lub n-warstwowych, które mają wiele maszyn wirtualnych w jednej warstwie.](#best-practices-for-2-tier-3-tier-or-n-tier-patterns-that-have-multiple-vms-in-one-tier)

![Wzorzec aplikacji ze skalą warstwy biznesowej w poziomie](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728011.png)

## <a name="2-tier-and-3-tier-with-presentation-and-business-tiers-scale-out-and-hadr"></a>2-warstwowy i 3-warstwowy z prezentacją i warstwami biznesowymi skalowaj w poziomie i HADR
W tym wzorzec aplikacji można wdrożyć 2-warstwowej lub 3-warstwowej aplikacji bazy danych do maszyny wirtualne platformy Azure przez dystrybucję warstwy prezentacji (serwer sieci web) i warstwy biznesowej (serwer aplikacji) składników do wielu maszyn wirtualnych. Ponadto można zaimplementować rozwiązania do odzyskiwania po awarii o wysokiej dostępności i po awarii dla baz danych na maszynach wirtualnych platformy Azure.

Ten wzorzec aplikacji jest przydatny, gdy:

* Chcesz przenieść aplikacje przedsiębiorstwa z platform zwirtualizowanych lokalnie na platformę Azure, implementując wysokiej dostępności programu SQL Server i funkcje odzyskiwania po awarii.
* Chcesz skalować w poziomie warstwy prezentacji i warstwy biznesowej ze względu na zwiększoną liczbę przychodzących żądań klientów i złożoność aplikacji.
* Chcesz szybko aprowizować środowiska programistyczne i testowe na krótkie okresy czasu.
* Chcesz przeprowadzić testy warunków skrajnych dla różnych poziomów obciążenia, ale jednocześnie nie chcesz posiadać i obsługiwać wielu maszyn fizycznych przez cały czas.
* Chcesz posiadać środowisko infrastruktury, które można skalować w górę iw dół na żądanie.

Na poniższym diagramie przedstawiono scenariusz lokalny i jego rozwiązanie włączone w chmurze. W tym scenariuszu można skalować w poziomie warstwy prezentacji i składników warstwy biznesowej w wielu maszynach wirtualnych na platformie Azure. Ponadto implementujesz techniki wysokiej dostępności i odzyskiwania po awarii (HADR) dla baz danych programu SQL Server na platformie Azure.

Uruchamianie wielu kopii aplikacji w różnych maszyn wirtualnych upewnij się, że są obciążenia równoważenia żądań między nimi. Jeśli masz wiele maszyn wirtualnych, należy upewnić się, że wszystkie maszyny wirtualne są dostępne i uruchomione w jednym punkcie w czasie. Jeśli skonfigurujesz równoważenie obciążenia, moduł równoważenia obciążenia platformy Azure śledzi kondycję maszyn wirtualnych i prawidłowo kieruje wywołania przychodzące do działających w dobrej kondycji węzłów maszyn wirtualnych. Aby uzyskać informacje na temat konfigurowania równoważenia obciążenia maszyn wirtualnych, zobacz [Równoważenie obciążenia dla usług infrastruktury platformy Azure.](../tutorial-load-balancer.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) Posiadanie wielu wystąpień serwerów sieci web i aplikacji za modułem równoważenia obciążenia zapewnia wysoką dostępność warstw prezentacji i warstw biznesowych.

![Skalowanie w poziomie i wysoka dostępność](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728012.png)

### <a name="best-practices-for-application-patterns-requiring-sql-hadr"></a>Najważniejsze wskazówki dotyczące wzorców aplikacji wymagających sql hadr
Po skonfigurowaniu rozwiązania SQL Server wysokiej dostępności i odzyskiwania po awarii w maszynach wirtualnych platformy Azure, konfigurowanie sieci wirtualnej dla maszyn wirtualnych przy użyciu [sieci wirtualnej platformy Azure](../../../virtual-network/virtual-networks-overview.md) jest obowiązkowe.  Maszyny wirtualne w sieci wirtualnej będą miały stabilny prywatny adres IP nawet po przestoju usługi, dzięki czemu można uniknąć czasu aktualizacji wymaganego do rozpoznawania nazw DNS. Ponadto sieć wirtualna umożliwia rozszerzenie sieci lokalnej na platformę Azure i tworzy granicę zaufanych zabezpieczeń. Na przykład jeśli aplikacja ma ograniczenia domeny firmowej (takie jak uwierzytelnianie systemu Windows, usługa Active Directory), konieczne jest skonfigurowanie [usługi Azure Virtual Network.](../../../virtual-network/virtual-networks-overview.md)

Większość klientów, którzy są uruchomione kod produkcyjny na platformie Azure, są utrzymanie repliki podstawowe i pomocnicze na platformie Azure.

Aby uzyskać wyczerpujące informacje i samouczki dotyczące wysokiej dostępności i odzyskiwania po awarii, zobacz [Wysoka dostępność i odzyskiwanie po awarii dla programu SQL Server w platformie Azure Virtual Machines](virtual-machines-windows-sql-high-availability-dr.md).

## <a name="2-tier-and-3-tier-using-azure-vms-and-cloud-services"></a>2-warstwowe i 3-warstwowe przy użyciu maszyn wirtualnych i usług w chmurze platformy Azure
W tym wzorcu aplikacji można wdrożyć 2-warstwową lub 3-warstwową aplikację na platformie Azure przy użyciu usług [w chmurze Azure](../../../cloud-services/cloud-services-choose-me.md) (role sieci web i procesu roboczego — Platforma jako usługa (PaaS)) i [maszyny wirtualne platformy Azure](../overview.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) (infrastruktura jako usługa (IaaS)). Korzystanie z [usług w chmurze Azure](https://azure.microsoft.com/documentation/services/cloud-services/) dla warstwy prezentacji/warstwy biznesowej i sql server w [maszynach wirtualnych platformy Azure](../overview.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) dla warstwy danych jest korzystne dla większości aplikacji uruchomionych na platformie Azure. Powodem jest to, że posiadanie wystąpienia obliczeniowego uruchomionego w usługach w chmurze zapewnia łatwe zarządzanie, wdrażanie, monitorowanie i skalowanie w poziomie.

Dzięki usługom w chmurze platforma Azure utrzymuje infrastrukturę, wykonuje rutynową konserwację, łata systemy operacyjne i próbuje odzyskać dane z powodu awarii usługi i sprzętu. Gdy aplikacja wymaga skalowania w poziomie, automatyczne i ręczne skalowanie w poziomie opcje są dostępne dla projektu usługi w chmurze przez zwiększenie lub zmniejszenie liczby wystąpień lub maszyn wirtualnych, które są używane przez aplikację. Ponadto można użyć lokalnego programu Visual Studio do wdrożenia aplikacji w projekcie usługi w chmurze na platformie Azure.

Podsumowując, jeśli nie chcesz posiadać rozbudowanych zadań administracyjnych dla warstwy prezentacji/firmy, a aplikacja nie wymaga żadnej złożonej konfiguracji oprogramowania lub systemu operacyjnego, użyj usług Azure Cloud Services. Jeśli usługa Azure SQL Database nie obsługuje wszystkich funkcji, których szukasz, użyj programu SQL Server w maszynie wirtualnej platformy Azure dla warstwy danych. Uruchamianie aplikacji w usługach w chmurze azure i przechowywanie danych w maszynach wirtualnych platformy Azure łączy korzyści z obu usług. Aby uzyskać szczegółowe porównanie, zobacz sekcję w tym temacie na [porównanie strategii rozwoju](#comparing-web-development-strategies-in-azure)na platformie Azure .

W tym wzorcu aplikacji warstwa prezentacji zawiera rolę sieci web, która jest składnikiem usług w chmurze uruchomionym w środowisku wykonywania platformy Azure i jest dostosowana do programowania aplikacji sieci web, jak są obsługiwane przez usługi IIS i ASP.NET. Warstwa biznesowa lub zaplecza zawiera rolę procesu roboczego, która jest składnikiem usług w chmurze uruchomionym w środowisku wykonywania platformy Azure i jest przydatna do tworzenia uogólnionych i może wykonywać przetwarzanie w tle dla roli sieci web. Warstwa bazy danych znajduje się na maszynie wirtualnej programu SQL Server na platformie Azure. Komunikacja między warstwą prezentacji a warstwą bazy danych odbywa się bezpośrednio lub za stępuje za elementów roli biznesowej — procesu roboczego.

Ten wzorzec aplikacji jest przydatny, gdy:

* Chcesz przenieść aplikacje przedsiębiorstwa z platform zwirtualizowanych lokalnie na platformę Azure, implementując wysokiej dostępności programu SQL Server i funkcje odzyskiwania po awarii.
* Chcesz posiadać środowisko infrastruktury, które można skalować w górę iw dół na żądanie.
* Usługa Azure SQL Database nie obsługuje wszystkich funkcji, których potrzebuje aplikacja lub baza danych.
* Chcesz przeprowadzić testy warunków skrajnych dla różnych poziomów obciążenia, ale jednocześnie nie chcesz posiadać i obsługiwać wielu maszyn fizycznych przez cały czas.

Na poniższym diagramie przedstawiono scenariusz lokalny i jego rozwiązanie włączone w chmurze. W tym scenariuszu można umieścić warstwę prezentacji w rolach sieci web, warstwy biznesowej w rolach procesu roboczego, ale warstwy danych w maszynach wirtualnych na platformie Azure. Uruchamianie wielu kopii warstwy prezentacji w różnych rolach sieci web zapewnia obciążenie żądań równoważenia między nimi. Po połączeniu usług w chmurze azure z maszynami wirtualnymi platformy Azure zaleca się również skonfigurowanie [usługi Azure Virtual Network.](../../../virtual-network/virtual-networks-overview.md) Dzięki [usłudze Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md)możesz mieć stabilne i trwałe prywatne adresy IP w ramach tej samej usługi w chmurze w chmurze. Po zdefiniowaniu sieci wirtualnej dla maszyn wirtualnych i usług w chmurze mogą rozpocząć komunikację między sobą za pośrednictwem prywatnego adresu IP. Ponadto posiadanie maszyn wirtualnych i ról sieci Web/procesu roboczego platformy Azure w tej samej [sieci wirtualnej platformy Azure](../../../virtual-network/virtual-networks-overview.md) zapewnia małe opóźnienia i bezpieczniejszą łączność. Aby uzyskać więcej informacji, zobacz [Co to jest usługa w chmurze](../../../cloud-services/cloud-services-choose-me.md).

Jak widać na diagramie, moduł równoważenia obciążenia platformy Azure dystrybuuje ruch na wielu maszynach wirtualnych, a także określa, z którym serwerem sieci web lub serwerem aplikacji ma się łączyć. Posiadanie wielu wystąpień serwerów sieci web i aplikacji za modułem równoważenia obciążenia zapewnia wysoką dostępność warstwy prezentacji i warstwy biznesowej. Aby uzyskać więcej informacji, zobacz [Najważniejsze wskazówki dotyczące wzorców aplikacji wymagających sql hadr](#best-practices-for-application-patterns-requiring-sql-hadr).

![Wzorce aplikacji z usługami w chmurze](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728013.png)

Innym podejściem do zaimplementowania tego wzorca aplikacji jest użycie skonsolidowanej roli sieci web, która zawiera zarówno warstwę prezentacji, jak i składniki warstwy biznesowej, jak pokazano na poniższym diagramie. Ten wzorzec aplikacji jest przydatne dla aplikacji, które wymagają projektu stanowego. Ponieważ platforma Azure udostępnia bezstanowe węzły obliczeniowe w rolach sieci web i procesach procesowych, zaleca się zaimplementowanie logiki do przechowywania stanu sesji przy użyciu jednej z następujących technologii: [Azure Caching](https://azure.microsoft.com/documentation/services/azure-cache-for-redis/), [Azure Table Storage](../../../cosmos-db/table-storage-how-to-use-dotnet.md) lub Azure SQL [Database](../../../sql-database/sql-database-technical-overview.md).

![Wzorce aplikacji z usługami w chmurze](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728014.png)

## <a name="pattern-with-azure-vms-azure-sql-database-and-azure-app-service-web-apps"></a>Wzorzec z maszynami wirtualnymi platformy Azure, bazą danych SQL platformy Azure i usługą Azure App Service (aplikacje sieci Web)
Głównym celem tego wzorca aplikacji jest pokazanie, jak połączyć infrastrukturę platformy Azure jako składniki usługi (IaaS) ze składnikami platformy Azure jako usługa (PaaS) w rozwiązaniu. Ten wzorzec koncentruje się na usłudze Azure SQL Database dla relacyjnego magazynu danych. Nie zawiera programu SQL Server na maszynie wirtualnej platformy Azure, która jest częścią infrastruktury platformy Azure jako oferty usługi.

W tym wzorcu aplikacji można wdrożyć aplikację bazy danych na platformie Azure, umieszczając warstwy prezentacji i biznesowe na tej samej maszynie wirtualnej i uzyskując dostęp do bazy danych na serwerach bazy danych SQL (SQL Database). Warstwę prezentacji można zaimplementować przy użyciu tradycyjnych rozwiązań sieci Web opartych na usługach IIS. Możesz też zaimplementować połączoną prezentację i warstwę biznesową przy użyciu [usługi Azure App Service.](https://azure.microsoft.com/documentation/services/app-service/web/)

Ten wzorzec aplikacji jest przydatny, gdy:

* Masz już istniejący serwer bazy danych SQL skonfigurowany na platformie Azure i chcesz szybko przetestować aplikację.
* Chcesz przetestować możliwości środowiska platformy Azure.
* Chcesz szybko aprowizować środowiska programistyczne i testowe na krótkie okresy czasu.
* Logika biznesowa i składniki dostępu do danych mogą być samodzielne w aplikacji sieci web.

Na poniższym diagramie przedstawiono scenariusz lokalny i jego rozwiązanie włączone w chmurze. W tym scenariuszu można umieścić warstwy aplikacji w jednej maszynie wirtualnej na platformie Azure i uzyskać dostęp do danych w usłudze Azure SQL Database.

![Mieszany wzór aplikacji](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728015.png)

Jeśli zdecydujesz się zaimplementować połączonej warstwy sieci web i aplikacji przy użyciu usługi Azure Web Apps, zaleca się zachować warstwy środkowej lub warstwy aplikacji jako biblioteki łącza dynamicznego (biblioteki DLL) w kontekście aplikacji sieci web.

Ponadto przejrzyj zalecenia podane w [porównywaniu strategii tworzenia sieci Web w usłudze Azure](#comparing-web-development-strategies-in-azure) na końcu tego artykułu, aby dowiedzieć się więcej na temat technik programowania.

## <a name="n-tier-hybrid-application-pattern"></a>Wzorzec aplikacji hybrydowych warstwy N
W wzorzec aplikacji hybrydowych n-warstwy zaimplementuj aplikację w wielu warstwach rozproszonych między lokalnymi i platformy Azure. W związku z tym można utworzyć elastyczny i wielokrotnego użycia systemu hybrydowego, który można modyfikować lub dodawać określonej warstwy bez zmiany innych warstw. Aby rozszerzyć sieć firmową na chmurę, należy użyć usługi [Azure Virtual Network.](../../../virtual-network/virtual-networks-overview.md)

Ten wzorzec aplikacji hybrydowej jest przydatny, gdy:

* Chcesz tworzyć aplikacje, które działają częściowo w chmurze, a częściowo lokalnie.
* Chcesz przeprowadzić migrację niektórych lub wszystkich elementów istniejącej aplikacji lokalnej do chmury.
* Chcesz przenieść aplikacje przedsiębiorstwa z lokalnych zwirtualizowanych platform na platformę Azure.
* Chcesz posiadać środowisko infrastruktury, które można skalować w górę iw dół na żądanie.
* Chcesz szybko aprowizować środowiska programistyczne i testowe na krótkie okresy czasu.
* Chcesz opłacalny sposób wykonywania kopii zapasowych dla aplikacji do bazy danych przedsiębiorstwa.

Na poniższym diagramie przedstawiono wzorzec aplikacji hybrydowych n-warstwy, który obejmuje lokalne i platformy Azure. Jak pokazano na diagramie, infrastruktura lokalna obejmuje kontroler domeny [Usług domenowych Active Directory](https://technet.microsoft.com/library/hh831484.aspx) do obsługi uwierzytelniania i autoryzacji użytkowników. Należy zauważyć, że diagram pokazuje scenariusz, w którym niektóre części warstwy danych znajdują się w lokalnym centrum danych, podczas gdy niektóre części warstwy danych są dostępne na platformie Azure. W zależności od potrzeb aplikacji można zaimplementować kilka innych scenariuszy hybrydowych. Na przykład może zachować warstwy prezentacji i warstwy biznesowej w środowisku lokalnym, ale warstwy danych na platformie Azure.

![Wzorzec aplikacji warstwy N](./media/virtual-machines-windows-sql-server-app-patterns-dev-strategies/IC728016.png)

Na platformie Azure można używać usługi Active Directory jako autonomicznego katalogu w chmurze dla swojej organizacji lub można również zintegrować istniejącą lokalną usługę Active Directory z [usługą Azure Active Directory.](https://azure.microsoft.com/documentation/services/active-directory/) Jak widać na diagramie składniki warstwy biznesowej mogą uzyskiwać dostęp do wielu źródeł danych, takich jak SQL Server na [platformie Azure](virtual-machines-windows-sql-server-iaas-overview.md) za pośrednictwem prywatnego wewnętrznego adresu IP, lokalnego programu SQL Server za pośrednictwem [usługi Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md)lub bazy danych [SQL](../../../sql-database/sql-database-technical-overview.md) przy użyciu technologii dostawcy danych .NET Framework. Na tym diagramie usługa Azure SQL Database jest opcjonalną usługą przechowywania danych.

W wzorcu aplikacji hybrydowej n-warstwy można zaimplementować następujący przepływ pracy w określonej kolejności:

1. Identyfikowanie aplikacji do bazy danych przedsiębiorstwa, które muszą zostać przeniesione do chmury, za pomocą [zestawu narzędzi Microsoft Assessment and Planning (MAP) Toolkit](https://microsoft.com/map). Zestaw narzędzi MAP toolkit gromadzi dane spisu i wydajności z komputerów, które rozważasz do wirtualizacji i zawiera zalecenia dotyczące planowania pojemności i oceny.
2. Planowanie zasobów i konfiguracji potrzebnych na platformie Azure, takich jak konta magazynu i maszyny wirtualne.
3. Skonfiguruj łączność sieciową między siecią firmową lokalną a [siecią wirtualną platformy Azure](../../../virtual-network/virtual-networks-overview.md). Aby skonfigurować połączenie między siecią firmową lokalną a maszyną wirtualną na platformie Azure, użyj jednej z następujących dwóch metod:
   
   1. Ustanawianie połączenia między środowiskiem lokalnym a platformą Azure za pośrednictwem publicznych punktów końcowych na maszynie wirtualnej na platformie Azure. Ta metoda zapewnia łatwą konfigurację i umożliwia korzystanie z uwierzytelniania programu SQL Server na maszynie wirtualnej. Ponadto skonfiguruj reguły sieciowej grupy zabezpieczeń, aby kontrolować ruch publiczny na maszynie wirtualnej. Aby uzyskać więcej informacji, zobacz [Zezwalaj na dostęp zewnętrzny do maszyny Wirtualnej przy użyciu witryny Azure portal](../nsg-quickstart-portal.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).
   2. Nawiązuj połączenie między środowiskiem lokalnym a platformą Azure za pośrednictwem tunelu wirtualnej sieci prywatnej platformy Azure (VPN). Ta metoda umożliwia rozszerzenie zasad domeny do maszyny wirtualnej na platformie Azure. Ponadto można skonfigurować reguły zapory i używać uwierzytelniania systemu Windows na maszynie wirtualnej. Obecnie platforma Azure obsługuje bezpieczne połączenia sieci VPN między lokacjami i sieci VPN typu "punkt-lokacja":
      
      * Dzięki bezpiecznemu połączeniu lokacja-lokacja można ustanowić łączność sieciową między siecią lokalną a siecią wirtualną na platformie Azure. Zalecane jest do łączenia lokalnego środowiska centrum danych z platformą Azure.
      * Dzięki bezpiecznemu połączeniu typu punkt-lokacja można ustanowić łączność sieciową między siecią wirtualną na platformie Azure a poszczególnymi komputerami działającymi w dowolnym miejscu. Jest to głównie zalecane do celów rozwojowych i testowych.
      
      Aby uzyskać informacje na temat łączenia się z programem SQL Server na platformie Azure, zobacz [Łączenie się z maszyną wirtualną programu SQL Server na platformie Azure](virtual-machines-windows-sql-connect.md).
4. Skonfiguruj zaplanowane zadania i alerty, które tworzą kopii zapasowych danych lokalnych na dysku maszyny wirtualnej na platformie Azure. Aby uzyskać więcej informacji, zobacz [SQL Server Backup and Restore with Azure Blob Storage Service](https://msdn.microsoft.com/library/jj919148.aspx) and Backup and Restore for SQL Server in Azure Virtual [Machines](virtual-machines-windows-sql-backup-recovery.md).
5. W zależności od potrzeb aplikacji można zaimplementować jeden z następujących trzech typowych scenariuszy:
   
   1. Serwer sieci web, serwer aplikacji i niewrażliwe dane można przechowywać na serwerze bazy danych na platformie Azure, podczas gdy poufne dane są poufne lokalnie.
   2. Serwer sieci web i serwer aplikacji można przechowywać lokalnie, podczas gdy serwer bazy danych na maszynie wirtualnej na platformie Azure.
   3. Serwer bazy danych, serwer sieci web i serwer aplikacji można przechowywać lokalnie, podczas gdy repliki bazy danych są przechowywane na maszynach wirtualnych na platformie Azure. To ustawienie umożliwia lokalnym serwerom sieci Web lub aplikacjom raportowania dostęp do replik bazy danych na platformie Azure. W związku z tym można osiągnąć, aby zmniejszyć obciążenie w lokalnej bazie danych. Zaleca się zaimplementowanie tego scenariusza dla obciążeń odczytu o dużym obciążeniu i do celów rozwojowych. Aby uzyskać informacje na temat tworzenia replik bazy danych na platformie Azure, zobacz AlwaysOn Grupy dostępności w [wysokiej dostępności i odzyskiwania po awarii dla programu SQL Server w usłudze Azure Virtual Machines](virtual-machines-windows-sql-high-availability-dr.md).

## <a name="comparing-web-development-strategies-in-azure"></a>Porównywanie strategii tworzenia stron internetowych na platformie Azure
Aby zaimplementować i wdrożyć wielowarstwową aplikację opartą na programie SQL Server na platformie Azure, można użyć jednej z następujących dwóch metod programowania:

* Konfigurowanie tradycyjnego serwera sieci web (IIS — internetowe usługi informacyjne) na platformie Azure i uzyskiwanie dostępu do baz danych w programie SQL Server w usłudze Azure Virtual Machines.
* Implementowanie i wdrażanie usługi w chmurze na platformie Azure. Następnie upewnij się, że ta usługa w chmurze może uzyskiwać dostęp do baz danych w programie SQL Server na maszynach wirtualnych platformy Azure. Usługa w chmurze może zawierać wiele ról sieci web i procesu roboczego.

Poniższa tabela zawiera porównanie tworzenia tradycyjnych stron internetowych z usługami Azure Cloud Services i usługi Azure Web Apps w odniesieniu do programu SQL Server w maszynach wirtualnych platformy Azure. Tabela zawiera usługi Azure Web Apps, ponieważ można używać programu SQL Server w usłudze Azure VM jako źródła danych dla usługi Azure Web Apps za pośrednictwem publicznego wirtualnego adresu IP lub nazwy DNS.

|  | Tradycyjne tworzenie stron internetowych w maszynach wirtualnych platformy Azure | Usługi w chmurze na platformie Azure | Hosting w sieci Web z aplikacjami Azure Web Apps |
| --- | --- | --- | --- |
| **Migracja aplikacji z lokalnego** |Istniejące aplikacje w stanie rzeczywistym. |Aplikacje potrzebują ról sieci web i procesu roboczego. |Istniejące aplikacje w stanie takim, w jakim są odpowiednie dla samodzielnych aplikacji internetowych i usług sieci web, które wymagają szybkiej skalowalności. |
| **Programy i wdrażanie** |Visual Studio, WebMatrix, Visual Web Developer, WebDeploy, FTP, TFS, IIS Manager, PowerShell. |Visual Studio, Azure SDK, TFS, PowerShell. Każda usługa w chmurze ma dwa środowiska, w których można wdrożyć pakiet usługi i konfigurację: przemieszczania i produkcji. Usługę w chmurze można wdrożyć w środowisku przejściowym, aby przetestować ją przed jej promowaniem w środowisku produkcyjnym. |Visual Studio, WebMatrix, Visual Web Developer, FTP, GIT, BitBucket, CodePlex, DropBox, GitHub, Mercurial, TFS, Web Deploy, PowerShell. |
| **Administracja i konfiguracja** |Użytkownik jest odpowiedzialny za zadania administracyjne w aplikacji, danych, regułach zapory, sieci wirtualnej i systemie operacyjnym. |Użytkownik jest odpowiedzialny za zadania administracyjne w aplikacji, danych, regułach zapory i sieci wirtualnej. |Użytkownik jest odpowiedzialny za zadania administracyjne tylko w aplikacji i danych. |
| **Wysoka dostępność i odzyskiwanie po awarii (HADR)** |Zaleca się umieszczenie maszyn wirtualnych w tym samym zestawie dostępności i w tej samej usłudze w chmurze. Utrzymywanie maszyn wirtualnych w tym samym zestawie dostępności umożliwia platformie Azure umieszczanie węzłów o wysokiej dostępności w oddzielnych domenach błędów i domenach uaktualniania. Podobnie utrzymywanie maszyn wirtualnych w tej samej usłudze w chmurze umożliwia równoważenie obciążenia, a maszyny wirtualne mogą komunikować się bezpośrednio ze sobą za pośrednictwem sieci lokalnej w centrum danych platformy Azure.<br/><br/>Użytkownik jest odpowiedzialny za wdrożenie rozwiązania o wysokiej dostępności i odzyskiwania po awarii dla programu SQL Server w usłudze Azure Virtual Machines, aby uniknąć przestojów. Aby uzyskać obsługiwane technologie HADR, zobacz [Wysoka dostępność i odzyskiwanie po awarii dla programu SQL Server w maszynach wirtualnych platformy Azure](virtual-machines-windows-sql-high-availability-dr.md).<br/><br/>Użytkownik jest odpowiedzialny za tworzenie kopii zapasowych własnych danych i aplikacji.<br/><br/>Platforma Azure może przenieść maszyny wirtualne, jeśli komputer-host w centrum danych ulegnie awarii z powodu problemów ze sprzętem. Ponadto może być planowane przestoje maszyny Wirtualnej, gdy komputer-host jest aktualizowany w celu uzyskania zabezpieczeń lub aktualizacji oprogramowania. W związku z tym zaleca się utrzymanie co najmniej dwóch maszyn wirtualnych w każdej warstwie aplikacji, aby zapewnić ciągłą dostępność. Platforma Azure nie zapewnia umowy SLA dla pojedynczej maszyny wirtualnej. |Platforma Azure zarządza błędami wynikającymi z podstawowego sprzętu lub oprogramowania systemu operacyjnego. Zaleca się zaimplementowanie wielu wystąpień roli sieci web lub procesu roboczego, aby zapewnić wysoką dostępność aplikacji. Aby uzyskać więcej informacji, zobacz [Usługi w chmurze, maszyny wirtualne i umowa o poziomie usług sieci wirtualnej](https://azure.microsoft.com/support/legal/sla/virtual-machines/v1_8/).<br/><br/>Użytkownik jest odpowiedzialny za tworzenie kopii zapasowych własnych danych i aplikacji.<br/><br/>W przypadku baz danych zamieszkałych w bazie danych programu SQL Server na maszynie Wirtualnej platformy Azure użytkownik jest odpowiedzialny za wdrożenie rozwiązania o wysokiej dostępności i odzyskiwania po awarii, aby uniknąć przestojów. Aby uzyskać obsługiwane technologie HDAR, zobacz Wysoka dostępność i odzyskiwanie po awarii dla programu SQL Server w maszynach wirtualnych platformy Azure.<br/><br/>**Dublowanie bazy danych programu SQL Server:** Użyj z usługami w chmurze Azure (role sieci web/procesu roboczego). Maszyny wirtualne programu SQL Server i projekt usługi w chmurze mogą znajdować się w tej samej sieci wirtualnej platformy Azure. Jeśli maszyna wirtualna programu SQL Server nie znajduje się w tej samej sieci wirtualnej, należy utworzyć alias programu SQL Server, aby kierować komunikację do wystąpienia programu SQL Server. Ponadto nazwa aliasu musi być zgodna z nazwą programu SQL Server. |Wysoka dostępność jest dziedziczona z ról procesu roboczego platformy Azure, magazynu obiektów blob platformy Azure i bazy danych SQL azure. Na przykład usługa Azure Storage przechowuje trzy repliki wszystkich danych obiektów blob, tabeli i kolejki. W dowolnym momencie usługa Azure SQL Database przechowuje trzy repliki danych uruchomione — jedną replikę podstawową i dwie repliki pomocnicze. Aby uzyskać więcej informacji, zobacz [Usługi Azure Storage](https://azure.microsoft.com/documentation/services/storage/) i usługi Azure SQL [Database](../../../sql-database/sql-database-technical-overview.md).<br/><br/>Korzystając z programu SQL Server w usłudze Azure VM jako źródła danych dla aplikacji Azure Web Apps, należy pamiętać, że usługa Azure Web Apps nie obsługuje usługi Azure Virtual Network. Innymi słowy wszystkie połączenia z usługi Azure Web Apps do maszyn wirtualnych programu SQL Server na platformie Azure muszą przechodzić przez publiczne punkty końcowe maszyn wirtualnych. Może to spowodować pewne ograniczenia dotyczące wysokiej dostępności i scenariuszy odzyskiwania po awarii. Na przykład aplikacja kliencka w usłudze Azure Web Apps łącząca się z maszyną wirtualną programu SQL Server z dublowaniem bazy danych nie będzie mogła połączyć się z nowym serwerem podstawowym, ponieważ dublowanie bazy danych wymaga skonfigurowania sieci wirtualnej platformy Azure między maszynami wirtualnymi hosta programu SQL Server na platformie Azure. W związku z tym przy użyciu **sql server database mirroring** with Azure Web Apps is not supported currently.<br/><br/>**Grupy dostępności programu SQL Server AlwaysOn:** Grupy dostępności AlwaysOn można skonfigurować podczas korzystania z aplikacji Azure Web Apps z maszynami wirtualnymi programu SQL Server na platformie Azure. Należy jednak skonfigurować odbiornik grupy dostępności AlwaysOn, aby kierować komunikację do repliki podstawowej za pośrednictwem publicznych punktów końcowych z równoważeniem obciążenia. |
| **łączność między lokalizacjami** |Za pomocą usługi Azure Virtual Network można połączyć się z lokalnymi. |Za pomocą usługi Azure Virtual Network można połączyć się z lokalnymi. |Usługa Azure Virtual Network jest obsługiwana. Aby uzyskać więcej informacji, zobacz [Integracja sieci wirtualnej aplikacji sieci Web](https://azure.microsoft.com/blog/2014/09/15/azure-websites-virtual-network-integration/). |
| **Skalowalność** |Skalowanie w górę jest dostępne przez zwiększenie rozmiarów maszyn wirtualnych lub dodanie większej liczby dysków. Aby uzyskać więcej informacji na temat rozmiarów maszyn wirtualnych, zobacz [Rozmiary maszyn wirtualnych dla platformy Azure](../sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).<br/><br/>**Dla serwera bazy danych:** Skalowanie w poziomie jest dostępne za pośrednictwem technik partycjonowania bazy danych i grup dostępności programu SQL Server AlwaysOn.<br/><br/>W przypadku obciążeń intensywnie odczytywanych można używać [grup dostępności AlwaysOn](https://msdn.microsoft.com/library/hh510230.aspx) w wielu węzłach pomocniczych, a także replikacji programu SQL Server.<br/><br/>W przypadku dużych obciążeń zapisu można zaimplementować poziome partycjonowanie danych na wielu serwerach fizycznych, aby zapewnić skalowanie aplikacji w poziomie.<br/><br/>Ponadto można zaimplementować skalowano w poziomie przy użyciu [programu SQL Server z routingiem zależnym od danych](https://technet.microsoft.com/library/cc966448.aspx). Za pomocą routingu zależnego od danych (DDR) należy zaimplementować mechanizm partycjonowania w aplikacji klienckiej, zazwyczaj w warstwie warstwy biznesowej, aby rozkierować żądania bazy danych do wielu węzłów programu SQL Server. Warstwa biznesowa zawiera mapowania, jak dane są podzielone na partycje i który węzeł zawiera dane.<br/><br/>Można skalować aplikacje, które są uruchomione maszyny wirtualne. Aby uzyskać więcej informacji, zobacz [Jak skalować aplikację](../../../cloud-services/cloud-services-how-to-scale-portal.md).<br/><br/>**Ważna uwaga:** Funkcja **skalowania automatycznego na** platformie Azure umożliwia automatyczne zwiększanie lub zmniejszanie maszyn wirtualnych używanych przez aplikację. Ta funkcja gwarantuje, że środowisko użytkownika końcowego nie ma negatywnego wpływu w okresach szczytu, a maszyny wirtualne są zamykane, gdy zapotrzebowanie jest niskie. Zaleca się, aby nie ustawiać opcji Skalowanie autoscale dla usługi w chmurze, jeśli zawiera ona maszyny wirtualne programu SQL Server. Powodem jest to, że funkcja Skalowania automatycznego umożliwia platformie Azure włączenie maszyny wirtualnej, gdy użycie procesora CPU na tej maszynie wirtualnej jest wyższe niż niektóre progi i wyłączenie maszyny wirtualnej, gdy użycie procesora CPU jest niższe niż to. Funkcja Autoscale jest przydatna w przypadku aplikacji bezstanowych, takich jak serwery sieci web, gdzie każda maszyna wirtualna może zarządzać obciążeniem bez żadnych odwołań do poprzedniego stanu. Jednak funkcja Autoscale nie jest przydatna w przypadku aplikacji stanowych, takich jak SQL Server, gdzie tylko jedno wystąpienie umożliwia zapisywanie do bazy danych. |Skalowanie w górę jest dostępne przy użyciu wielu ról sieci web i procesu roboczego. Aby uzyskać więcej informacji na temat rozmiarów maszyn wirtualnych dla ról sieci Web i ról procesu roboczego, zobacz [Konfigurowanie rozmiarów usług w chmurze](../../../cloud-services/cloud-services-sizes-specs.md).<br/><br/>Podczas korzystania z **usług w chmurze**można zdefiniować wiele ról do dystrybucji przetwarzania, a także osiągnąć elastyczne skalowanie aplikacji. Każda usługa w chmurze zawiera jedną lub więcej ról sieci web i/lub ról procesu roboczego, z których każda ma własne pliki aplikacji i konfigurację. Usługę w chmurze można skalować w górę, zwiększając liczbę wystąpień roli (maszyn wirtualnych) wdrożonych dla roli i skalowano w dół usługi w chmurze, zmniejszając liczbę wystąpień roli. Aby uzyskać szczegółowe informacje, zobacz [Modele wykonywania platformy Azure](../../../cloud-services/cloud-services-choose-me.md).<br/><br/>Skalowanie w poziomie jest dostępne za pośrednictwem wbudowanej platformy Azure wysokiej dostępności za pośrednictwem usług w [chmurze, maszyn wirtualnych i umowy o poziomie usług sieci wirtualnej](https://azure.microsoft.com/support/legal/sla/virtual-machines/v1_8/) i modułu równoważenia obciążenia.<br/><br/>W przypadku aplikacji wielowarstwowej zaleca się łączenie aplikacji ról sieci web/procesu roboczego z maszynami wirtualnymi serwera bazy danych za pośrednictwem sieci wirtualnej azure. Ponadto platforma Azure zapewnia równoważenie obciążenia maszyn wirtualnych w tej samej usłudze w chmurze, rozprowadzając żądania użytkowników na nich. Maszyny wirtualne połączone w ten sposób mogą komunikować się bezpośrednio ze sobą za pośrednictwem sieci lokalnej w centrum danych platformy Azure.<br/><br/>Skalowanie **automatyczne** można skonfigurować w witrynie Azure portal, a także w godzinach harmonogramu. Aby uzyskać więcej informacji, zobacz [Jak skonfigurować automatyczne skalowanie usługi w chmurze w portalu](../../../cloud-services/cloud-services-how-to-scale-portal.md). |**Skalowanie w górę i w dół:** Można zwiększyć/zmniejszyć rozmiar wystąpienia (VM) zarezerwowane dla witryny sieci web.<br/><br/>Skalowanie w poziomie: można dodać więcej zarezerwowanych wystąpień (maszyn wirtualnych) dla witryny sieci Web.<br/><br/>Skalowanie **automatyczne** można skonfigurować w portalu, a także w godzinach harmonogramu. Aby uzyskać więcej informacji, zobacz [Jak skalować aplikacje sieci Web](../../../app-service/manage-scale-up.md). |

Aby uzyskać więcej informacji na temat wybierania między tymi metodami programowania, zobacz [Usługi Azure Web Apps, usługi w chmurze i maszyny wirtualne: Kiedy używać którego](/azure/architecture/guide/technology-choices/compute-decision-tree).

## <a name="next-steps"></a>Następne kroki
Aby uzyskać więcej informacji na temat uruchamiania programu SQL Server na maszynach wirtualnych platformy Azure, zobacz [SQL Server na maszynach wirtualnych platformy Azure .](virtual-machines-windows-sql-server-iaas-overview.md)

