<properties
    pageTitle="Azure AD アプリケーション プロキシを使用したアプリの発行 | Microsoft Azure"
    description="Azure AD アプリケーション プロキシを使用してオンプレミスのアプリケーションを発行する方法について説明します。"
    services="active-directory"
    documentationCenter=""
    authors="kgremban"
    manager="stevenpo"
    editor=""/>

<tags
    ms.service="active-directory"
    ms.workload="identity"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="12/02/2015"
    ms.author="kgremban"/>


# Azure AD アプリケーション プロキシを使用してアプリケーションを発行する

> [AZURE.NOTE] アプリケーション プロキシは、Premium または Azure Active Directory の Basic エディションにアップグレードする場合にのみ提供される機能です。 詳細については、次を参照してください。 [Azure Active Directory のエディション](active-directory-editions.md)します。

Microsoft Azure AD アプリケーション プロキシを有効にすると、プライベート ネットワークの外部のユーザーからアクセスできるように、アプリケーションを発行できます。

この記事では、ネットワークの外部からのセキュリティで保護されたリモート アクセスを有効にする、ローカル ネットワークで実行中のアプリケーションを発行するための手順について説明します。

> [AZURE.NOTE] コネクタが正しく実行されていることを確認するには、最初に発行するアプリケーションをユーザーがアクセスできる、インターネットから実際のアプリケーションを発行する前に確保するためにプライベート ネットワーク内からアクセスできる任意の web サイトとなります。


## ウィザードを使用してアプリを発行する

1. 任意のブラウザーを開いて、Azure クラシック ポータルに移動します。
2. Azure クラシック ポータルの左側のペインで、[Active Directory] タブをクリックします。
3. アプリケーション プロキシを有効にした、アプリケーションの発行先のディレクトリ (Wingtip Toys など) をクリックします。
4. クリックして、 **アプリケーション** タブをクリックし、クリックして、 **追加** 、画面の下部にあるボタン
    ![アプリケーションを追加します。](./media/active-directory-application-proxy-publish/aad_appproxy_selectdirectory.png)
5. 内容はするでしょうか。 ダイアログ ボックスで、をクリックして **、ネットワークの外部アクセス可能なアプリケーションを発行**します。
    ![ネットワークの外部からアクセス可能な新しいアプリケーション](./media/active-directory-application-proxy-publish/aad_appproxy_addapp.png)

6. 画面上の指示に従い、アプリケーションに関する以下の情報を入力します。
    ![Application properties](./media/active-directory-application-proxy-publish/aad_appproxy_appproperties.png)

**設定** | **詳細**
---|---
外部 URL | これはクラウド サービスの URL で、プライベート ネットワークの外部からアプリケーションにアクセスする際に使用します。 この URL は、指定した名前に基づき、サフィックス msappproxy.net を使用して自動生成されます。
事前認証方法 | <p>アプリケーションで使用する事前認証方法の種類を設定します。</p><p>a. Microsoft Azure Active Directory (Microsoft Azure AD) – ユーザーがアプリケーションにアクセスしようとすると、アプリケーション プロキシ、ユーザーが、ユーザーがディレクトリとアプリケーションに対して必要なアクセス許可を持っているように、ユーザーを認証する Azure AD を使用してログインするようリダイレクトされます。</p> <p>b. パス スルー – 事前認証は実行されません。</p>
外部 URL プロトコル | <p>既定では、アプリケーションは HTTPS プロトコルを使用して発行されます。 サービスは、http を含む URL を入力したユーザーを自動的にリダイレクトします。</p><p>内部アプリケーションに対して HTTP を有効にするには、[事前認証] を [パススルー] に設定する必要があります。これにより、外部 URL プロトコルを HTTPS から HTTP に変更できるようになります。 HTTP を使用してアプリケーションを発行すると、アプリケーションおよびユーザーに対してセキュリティ上の問題が発生する場合があります。</p><p>既定のサフィックス Msappproxy.net を使用する代わりに、カスタム ドメインを挿入することができます。 詳細については、次を参照してください。 [カスタム ドメインの使用](active-directory-application-proxy-custom-domains.md)します。</p>
内部 URL | <p>これは、アプリケーション プロキシ コネクタがアプリケーションへの内部的なアクセスのために使用する内部 URL です。 プライベート ネットワークの内部からアプリケーションにアクセスするために使用する、発行済みアプリケーションの URL にする必要があります。 これは、スペースや記号が含まれていない有効な URL です。</p> <p>バックエンド サーバー上の特定のパスを指定して発行できます。この場合、サーバーのそれ以外のパスは発行されません。 これにより、たとえば、同じ SharePoint サーバー上にある、名前とアクセス規則が異なるさまざまなサイトを発行することができます。</p> <p>パスは、内部 URL フィールドで指定され、外部 URL に表示されます。 内部と外部のパスが同一である必要があります。</p>

ウィザードを終了するには、画面下部にあるチェック マークをクリックします。 これで、アプリケーションが Azure AD で定義されました。


## アプリケーションにユーザーとグループを割り当てる

1. 事前認証済みのアプリには、アプリにアクセスできるようにするユーザーとグループを割り当てる必要があります。 <p>パススルーのアプリには、すべてのユーザーがアクセスできます。 ただし、アプリケーション リスト内のアプリをユーザーに表示するためには、そのユーザーにアプリを割り当てる必要があります。
2. アプリの追加ウィザードを終了すると、[アプリケーション プロキシのクイック スタート] ページが表示されます。 ユーザーを割り当てるにはクリックして **ユーザーの割り当て**します。
    ![アプリケーション プロキシのクイック スタート] 画面](./media/active-directory-application-proxy-publish/quickstart.png)
3. 各ユーザーまたはグループを割り当てるをクリックしてこのアプリを選択して **割り当てる**します。

> [AZURE.NOTE] 統合 Windows 認証アプリの場合は、オンプレミスの Active Directory からユーザーと同期されているグループのみを割り当てることができます。 Microsoft アカウントでログインしているユーザーやゲストを、Azure Active Directory アプリケーション プロキシを使用して発行したアプリに割り当てることはできません。 割り当てるユーザーが、発行するアプリと同じドメインに含まれる資格情報を、ログイン時に使用するようにしてください。


## 詳細な構成

1. [構成] ページから、発行済みのアプリの変更や、オンプレミスのアプリケーションへの SSO などの高度なオプションの構成ができます。
    ![詳細な構成](./media/active-directory-application-proxy-publish/advancedconfig.png)

2. アプリを選択し、クリックして **構成**します。 以下のオプションを使用できます。

**設定** | **詳細**
---|---
名前 | アプリケーションのわかりやすい名前を指定します。
外部 URL | これはクラウド サービスの URL で、プライベート ネットワークの外部からアプリケーションにアクセスする際に使用します。 この URL は、指定した名前に基づき、サフィックス msappproxy.net を使用して自動生成されます。
事前認証方法 | <p>アプリケーションで使用する事前認証方法の種類を設定します。</p><p>a. Microsoft Azure Active Directory (Microsoft Azure AD) – ユーザーがアプリケーションにアクセスしようとすると、アプリケーション プロキシ、ユーザーが、ユーザーがディレクトリとアプリケーションに対して必要なアクセス許可を持っているように、ユーザーを認証する Azure AD を使用してログインするようリダイレクトされます。</p> <p>b. パス スルー – 事前認証は実行されません。</p>
外部 URL プロトコル | <p>既定では、アプリケーションは HTTPS プロトコルを使用して発行されます。 サービスは、http を含む URL を入力したユーザーを自動的にリダイレクトします。</p><p>内部アプリケーションに対して HTTP を有効にするには、[事前認証] を [パススルー] に設定する必要があります。これにより、外部 URL プロトコルを HTTPS から HTTP に変更できるようになります。 HTTP を使用してアプリケーションを発行すると、アプリケーションおよびユーザーに対してセキュリティ上の問題が発生する場合があります。</p><p>既定のサフィックス Msappproxy.net を使用する代わりに、カスタム ドメインを挿入することができます。 詳細については、次を参照してください。 [カスタム ドメインの使用](active-directory-application-proxy-custom-domains.md)します。</p>
内部 URL | <p>これは、アプリケーション プロキシ コネクタがアプリケーションへの内部的なアクセスのために使用する内部 URL です。 プライベート ネットワークの内部からアプリケーションにアクセスするために使用する、発行済みアプリケーションの URL にする必要があります。 これは、スペースや記号が含まれていない有効な URL です。</p> <p>バックエンド サーバー上の特定のパスを指定して発行できます。この場合、サーバーのそれ以外のパスは発行されません。 これにより、たとえば、同じ SharePoint サーバー上にある、名前とアクセス規則が異なるさまざまなサイトを発行することができます。</p> <p>パスは、内部 URL フィールドで指定され、外部 URL に表示されます。 内部と外部のパスが同一である必要があります。</p>
ヘッダーの URL を変換する | 設定する HTTP ホスト ヘッダーが変換されていない、必要とする一部の SharePoint 構成) などのアプリケーション **いいえ**します。 この設定により、要求ヘッダーと応答ヘッダーの両方に対するヘッダー変換が無効になります。
内部認証方法 | <p>事前認証にアプリケーション プロキシを使用する場合、内部認証方法を設定すると、ユーザーがこのアプリケーションへのシングル サインオン (SSO) を活用できるようになります。</p><p> 選択 **統合 Windows 認証 (IWA)** かどうか、アプリケーションで IWA を使用し、このアプリケーションに対して SSO を有効にする Kerberos 制約付き委任 (KCD) を構成することができます。 IWA を使用するアプリケーションは KCD を使用して構成する必要があります。そうしないと、アプリケーション プロキシでこれらのアプリケーションを発行できません。</p><p>選択 **なし** 、アプリケーションが IWA を使用しない場合。</p><p>詳細については、次を参照してください。 [とアプリケーション プロキシのシングル サインオン](active-directory-application-proxy-sso-using-kcd.md)します。</p>
内部アプリケーション SPN | <p>これは、オンプレミスのアプリケーション プロキシで構成されている、内部アプリケーションのサービス プリンシパル名 (SPN) です。 SPN は、Kerberos の制約付き委任 (KCD) を使用してアプリケーションの Kerberos トークンを取得するため、アプリケーション プロキシ コネクタによって使用されます。</p><p>詳細については、次を参照してください。 [シングル サインオンを有効に](active-directory-application-proxy-sso-using-kcd.md)します。</p>

Azure Active Directory アプリケーション プロキシを使用してアプリケーションを発行すると、それらのアプリケーションが Azure AD の [アプリケーション] リストに表示され、そこで管理できるようになります。

アプリケーションの発行後にアプリケーション プロキシ サービスを無効にした場合、アプリケーションは削除されませんが、プライベート ネットワークの外部からそのアプリケーションにアクセスできなくなります。

アプリケーションを表示し、アクセス可能かどうかを確認するには、そのアプリケーションの名前をダブルクリックします。 アプリケーション プロキシ サービスが無効になっていて、アプリケーションが使用できない場合は、画面上部に警告メッセージが表示されます。

アプリケーションを削除する一覧で、アプリケーションを選択し、をクリックして **削除**します。

## 関連項目
アプリケーション プロキシを使ってできることは他にもたくさんあります。

- [アプリケーション プロキシを有効にする](active-directory-application-proxy-enable.md)
- [独自のドメイン名でアプリケーションを発行する](active-directory-application-proxy-custom-domains.md)
- [シングル サインオンを有効にする](active-directory-application-proxy-sso-using-kcd.md)
- [条件付きアクセスを有効にする](active-directory-application-proxy-conditional-access.md)
- [要求に対応するアプリケーションを利用する](active-directory-application-proxy-claims-aware-apps.md)
- [アプリケーション プロキシで発生した問題のトラブルシューティングを行う](active-directory-application-proxy-troubleshoot.md)

## アプリケーション プロキシに関するその他の情報
- [オンライン ヘルプ](active-directory-application-proxy-enable.md)
- [アプリケーション プロキシに関するブログ](http://blogs.technet.com/b/applicationproxyblog/)
- [Channel 9 ビデオ](http://channel9.msdn.com/events/Ignite/2015/BRK3864)

## その他のリソース

* [Kerberos の制約付き委任について](http://technet.microsoft.com/library/cc995228.aspx)

