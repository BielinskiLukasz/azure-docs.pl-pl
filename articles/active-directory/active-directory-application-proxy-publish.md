<properties
    pageTitle="Azure AD アプリケーション プロキシを使用したアプリの発行 | Microsoft Azure"
    description="Azure AD アプリケーション プロキシを使用してオンプレミスのアプリケーションを発行する方法について説明します。"
    services="active-directory"
    documentationCenter=""
    authors="kgremban"
    manager="stevenpo"
    editor=""/>

<tags
    ms.service="active-directory"
    ms.workload="identity"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="12/02/2015"
    ms.author="kgremban"/>



# Azure AD アプリケーション プロキシを使用してアプリケーションを発行する

> [AZURE.NOTE] アプリケーション プロキシは、Azure Active Directory の Premium または Basic エディションにアップグレードしている場合にのみ利用できる機能です。 詳細については、次を参照してください。 [Azure Active Directory のエディション](active-directory-editions.md)します。

Microsoft Azure AD アプリケーション プロキシを有効にすると、プライベート ネットワークの外部のユーザーからアクセスできるように、アプリケーションを発行できます。

この記事では、ネットワークの外部からのセキュリティで保護されたリモート アクセスを有効にする、ローカル ネットワークで実行中のアプリケーションを発行するための手順について説明します。
> [AZURE.NOTE] コネクタが正しく動作しているか確認するには、実際のアプリケーションを発行する前に、最初に発行するアプリケーションをプライベート ネットワーク内からアクセス可能な任意の Web サイトにすることで、ユーザーがインターネットからアクセスできるようにする必要があります。


## ウィザードを使用してアプリを発行する

1. 任意のブラウザーを開いて、Azure クラシック ポータルに移動します。
2. Azure クラシック ポータルの左側のペインで、[Active Directory] タブをクリックします。
3. アプリケーション プロキシを有効にした、アプリケーションの発行先のディレクトリ (Wingtip Toys など) をクリックします。
4. **[アプリケーション]** タブをクリックし、画面下部にある **[追加]** をクリックします
    ![アプリケーションの追加](./media/active-directory-application-proxy-publish/aad_appproxy_selectdirectory.png)
5. 内容はするでしょうか。 ダイアログ ボックスで、をクリックして **、ネットワークの外部アクセス可能なアプリケーションを発行**します。
    ![使用しているネットワーク以外からアクセス可能な新しいアプリケーション](./media/active-directory-application-proxy-publish/aad_appproxy_addapp.png)

6. 画面上の指示に従い、アプリケーションに関する以下の情報を入力します。
    ![アプリケーションのプロパティ](./media/active-directory-application-proxy-publish/aad_appproxy_appproperties.png)

 **設定**| **詳細**
---|---
 外部 URL| これはクラウド サービスの URL で、プライベート ネットワークの外部からアプリケーションにアクセスする際に使用します。この URL は、指定した名前に基づき、サフィックス msappproxy.net を使用して自動生成されます。
 事前認証方法| <p>アプリケーションで使用する事前認証方法の種類を設定します。</p><p>、します。Microsoft Azure Active Directory (Microsoft Azure AD) – ユーザーがアプリケーションにアクセスしようとすると、アプリケーション プロキシ、ユーザーが、ユーザーがディレクトリとアプリケーションに対して必要なアクセス許可を持っているように、ユーザーを認証する Azure AD を使用してログインするようリダイレクトされます。</p> <p>b.パススルー – 事前認証は実行されません。</p>
 外部 URL プロトコル| <p>既定では、アプリケーションは HTTPS プロトコルを使用して発行します。サービスは、http URL を入力するユーザーを自動的にリダイレクトされます。</p><p>内部アプリケーションに対して HTTP を有効にするのを [パススルー事前認証方法を設定する必要がし、外部 URL プロトコルを HTTPS から HTTP に変更することができます。HTTP を使用してアプリケーションの公開で、アプリケーションと、ユーザーのセキュリティ問題を作成可能性があることに注意します。</p><p>既定のサフィックス msappproxy.net を使用するのではなく、カスタム ドメインを挿入することができます。詳細については、次を参照してください。 [カスタム ドメインの使用](active-directory-application-proxy-custom-domains.md)します。</p>
 内部 URL| <p>これは、アプリケーション プロキシ コネクタを使用して、アプリケーションに内部的にアクセスする内部 URL です。プライベート ネットワークの内部からアプリケーションにアクセスするために使用する、発行済みアプリケーションの URL にする必要があります。これは、スペースや記号のない、有効な URL です。</p><p>バックエンド サーバーで発行する、サーバーの残りの部分が発行されていない特定のパスを指定できます。これにより、たとえば、別の名前とアクセス規則と同じ SharePoint サーバー上にある別のサイトを公開することができます。</p><p>パスは、[内部 URL] フィールドで指定され、外部の URL に表示されます。内部および外部のパスは、同一でなければなりません。</p>

ウィザードを終了するには、画面下部にあるチェック マークをクリックします。 これで、アプリケーションが Azure AD で定義されました。


## アプリケーションにユーザーとグループを割り当てる

1. 事前認証済みのアプリには、アプリにアクセスできるようにするユーザーとグループを割り当てる必要があります。<p>アプリにパススルーは、アクセスはすべてのユーザーです。ただし、アプリケーション リスト内のアプリをユーザーに表示するためには、そのユーザーにアプリを割り当てる必要があります。
2. アプリの追加ウィザードを終了すると、[アプリケーション プロキシのクイック スタート] ページが表示されます。 ユーザーを割り当てるには、**[ユーザーの割り当て]** をクリックします。
    ![アプリケーション プロキシのクイック スタート画面](./media/active-directory-application-proxy-publish/quickstart.png)
3. このアプリに割り当てる各ユーザーまたはグループを選択し、**[割り当て]** をクリックします。

> [AZURE.NOTE] 統合 Windows 認証アプリでは、オンプレミスの Active Directory から同期したユーザーとグループのみを割り当てることができます。 Microsoft アカウントでログインしているユーザーやゲストを、Azure Active Directory アプリケーション プロキシを使用して発行したアプリに割り当てることはできません。 割り当てるユーザーが、発行するアプリと同じドメインに含まれる資格情報を、ログイン時に使用するようにしてください。


## 詳細な構成

1. [構成] ページから、発行済みのアプリの変更や、オンプレミスのアプリケーションへの SSO などの高度なオプションの構成ができます。
    ![詳細な構成](./media/active-directory-application-proxy-publish/advancedconfig.png)

2. アプリを選択し、**[構成]** をクリックします。 以下のオプションを使用できます。

 **設定**| **詳細**
---|---
 名前| アプリケーションのわかりやすい名前を指定します。
 外部 URL| これはクラウド サービスの URL で、プライベート ネットワークの外部からアプリケーションにアクセスする際に使用します。この URL は、指定した名前に基づき、サフィックス msappproxy.net を使用して自動生成されます。
 事前認証方法| <p>アプリケーションで使用する事前認証方法の種類を設定します。</p><p>、します。Microsoft Azure Active Directory (Microsoft Azure AD) – ユーザーがアプリケーションにアクセスしようとすると、アプリケーション プロキシ、ユーザーが、ユーザーがディレクトリとアプリケーションに対して必要なアクセス許可を持っているように、ユーザーを認証する Azure AD を使用してログインするようリダイレクトされます。</p> <p>b.パススルー – 事前認証は実行されません。</p>
 外部 URL プロトコル| <p>既定では、アプリケーションは HTTPS プロトコルを使用して発行します。サービスは、http URL を入力するユーザーを自動的にリダイレクトされます。</p><p>内部アプリケーションに対して HTTP を有効にするのを [パススルー事前認証方法を設定する必要がし、外部 URL プロトコルを HTTPS から HTTP に変更することができます。HTTP を使用してアプリケーションの公開で、アプリケーションと、ユーザーのセキュリティ問題を作成可能性があることに注意します。</p><p>既定のサフィックス msappproxy.net を使用するのではなく、カスタム ドメインを挿入することができます。詳細については、次を参照してください。 [カスタム ドメインの使用](active-directory-application-proxy-custom-domains.md)します。</p>
 内部 URL| <p>これは、アプリケーション プロキシ コネクタを使用して、アプリケーションに内部的にアクセスする内部 URL です。プライベート ネットワークの内部からアプリケーションにアクセスするために使用する、発行済みアプリケーションの URL にする必要があります。これは、スペースや記号のない、有効な URL です。</p><p>バックエンド サーバーで発行する、サーバーの残りの部分が発行されていない特定のパスを指定できます。これにより、たとえば、別の名前とアクセス規則と同じ SharePoint サーバー上にある別のサイトを公開することができます。</p><p>パスは、[内部 URL] フィールドで指定され、外部の URL に表示されます。内部および外部のパスは、同一でなければなりません。</p>
 ヘッダーの URL を変換する| HTTP ホスト ヘッダーが変換されていないことが必要なアプリケーション (一部の SharePoint 構成など) については、これを **[いいえ]** に設定します。この設定により、要求ヘッダーと応答ヘッダーの両方に対するヘッダー変換が無効になります。
 内部認証方法| <p>アプリケーション プロキシを事前認証を使用する場合は、このアプリケーションにシングル サインオン (SSO) を活用するユーザーを有効にする、内部認証方法を設定できます。</p><p> 選択 **統合 Windows 認証 (IWA)** かどうか、アプリケーションで IWA を使用し、このアプリケーションに対して SSO を有効にする Kerberos 制約付き委任 (KCD) を構成することができます。IWA を使用するアプリケーションは KCD を使用して構成する必要があります、それ以外の場合、アプリケーション プロキシによってこれらのアプリケーションを発行できません。</p><p>選択 **None** 、アプリケーションが IWA を使用しない場合。</p><p>詳細については、次を参照してください。 [とアプリケーション プロキシのシングル サインオン](active-directory-application-proxy-sso-using-kcd.md)します。</p>
 内部アプリケーション SPN| <p>これは、内部設置型のアプリケーション プロキシで構成されている、内部のアプリケーションのサービス プリンシパル名 (SPN) です。アプリケーション プロキシ コネクタは、SPN を使用して、Kerberos 制約付き委任 (KCD) を使用してアプリケーションの Kerberos トークンを取得します。</p><p>詳細については、次を参照してください。 [シングル サインオンを有効に](active-directory-application-proxy-sso-using-kcd.md)します。</p>

Azure Active Directory アプリケーション プロキシを使用してアプリケーションを発行すると、それらのアプリケーションが Azure AD の [アプリケーション] リストに表示され、そこで管理できるようになります。

アプリケーションの発行後にアプリケーション プロキシ サービスを無効にした場合、アプリケーションは削除されませんが、プライベート ネットワークの外部からそのアプリケーションにアクセスできなくなります。

アプリケーションを表示し、アクセス可能かどうかを確認するには、そのアプリケーションの名前をダブルクリックします。 アプリケーション プロキシ サービスが無効になっていて、アプリケーションが使用できない場合は、画面上部に警告メッセージが表示されます。

アプリケーションを削除するには、リスト内のアプリケーションを選択し、**[削除]** をクリックします。

## 関連項目

アプリケーション プロキシを使ってできることは他にもたくさんあります。

- [アプリケーション プロキシを有効にします。](active-directory-application-proxy-enable.md)
- [ドメイン名を使用してアプリケーションを公開します。](active-directory-application-proxy-custom-domains.md)
- [シングル サインオンの有効化にします。](active-directory-application-proxy-sso-using-kcd.md)
- [条件付きアクセスを有効にします。](active-directory-application-proxy-conditional-access.md)
- [クレーム対応アプリケーションの使用](active-directory-application-proxy-claims-aware-apps.md)
- [アプリケーション プロキシが発生した問題をトラブルシューティングします。](active-directory-application-proxy-troubleshoot.md)

## アプリケーション プロキシに関するその他の情報

- [こちらをご覧オンライン ヘルプ](active-directory-application-proxy-enable.md)
- [アプリケーション プロキシに関するブログします。](http://blogs.technet.com/b/applicationproxyblog/)
- [Channel 9 のビデオを見る。](http://channel9.msdn.com/events/Ignite/2015/BRK3864)

## その他のリソース

* [Kerberos の制約付き委任について](http://technet.microsoft.com/library/cc995228.aspx)





