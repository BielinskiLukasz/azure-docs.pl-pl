<properties 
    pageTitle="自動スケーリングと App Service Environment" 
    description="自動スケーリングと App Service Environment" 
    services="app-service"
    documentationCenter=""
    authors="btardif" 
    manager="wpickett" 
    editor="" 
/>

<tags 
    ms.service="app-service" 
    ms.workload="web" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="10/09/2015" 
    ms.author="byvinyal"
/>
    
#自動スケーリングと App Service Environment

##はじめに
**App Service 環境** 自動スケールをサポートします。 自動スケールの個人化することによりこれは、 
メトリックまたはスケジュールに基づいてワーカー プール。
 
![][intro]
 
自動スケールでは、自動的に拡大および縮小によって、リソース使用率を最適化することができます、 
**App Service 環境** 予算に合わせて、または読み込みをプロファイルします。

##ワーカー プールの自動スケールの構成 
[設定] タブから自動スケール機能にアクセスすることができます、 **ワーカー プール**します。 
 
![][settings-scale]

そこからインターフェイスこれ以降はかなり使い慣れたは操作と同じスケールする場合は、 
**App Service プラン**します。 スケール値は手動で入力できます。
 
![][scale-manual]
 
または、次のように自動スケール プロファイルを構成することもできます。
 
![][scale-profile]
 
自動スケール プロファイルは、スケールに対して制限を設定するのに便利です。 このように両方一貫性があることができます。 
パフォーマンスの状態は下限スケール値 (1) および支出の予測可能な上限を設定し、 
上限値 (2) を設定します。 
 
![][scale-profile2]
 
メトリックに基づいた自動スケール ルールを追加することができます、プロファイルを定義すると、スケール上または下に、 
インスタンスの数、 **ワーカー プール** プロファイルで定義されている範囲内です。

![][scale-rule]

 いずれか、 **ワーカー プール** または **フロント エンド** メトリックは、自動スケール規則を定義するために使用できます。 この 
 同じメトリックス リソース ブレードのグラフ内の監視や、アラートを設定できます。
 
##自動スケールの例
自動スケール、 **App Service 環境** 最適なシナリオを進めるにを説明できます。 
この記事の内容を見ていくために必要なすべてを考慮自動スケールを設定する場合、 
自動スケーリングのことを考慮する場合に効果を発揮するすべての相互作用 **App Service 環境** を 
ASE でホストされます。

###シナリオの概要
Frank は、エンタープライズ システム管理者、彼に勤務し管理するワークロードの一部を移行します。 
**App Service 環境**します。

 **App Service 環境** 次のように手動でのスケーリングするように構成されます。
* フロント エンド: 3
* ワーカー プール 1: 10
* ワーカー プール 2: 5
* ワーカー プール 3: 5

**ワーカー プール 1** はときに使用すると、運用環境のワークロード、 **ワーカー プール 2** と **ワーカー プール 3** 
QA および開発のワークロードに使用されます。

 **App Service プランの** 使用 QA およびデベロッパーが用に構成されている **手動でのスケーリング** が、運用環境 
**App Service プラン** に設定されている **自動スケール** 負荷とトラフィックの変動に対処します。

Frank は、アプリケーションに関する豊富な知識と間の負荷のピーク時間ことがわかっています 
午前 9時 00分と午後 6 時 00 分はこのため、 **LOB アプリケーション** は中に、従業員によって使用されます 
office です。 その後、ユーザーがその日の業務を終了すると、使用量は低下します。 まだいくつかの読み込み 
ユーザーがアクセスできるリモートでのモバイル デバイスや自宅のコンピューターのためです。 運用環境 
**App Service プラン** に既に構成されている **自動スケール** を次の CPU 使用率に基づく 
ルール:

![][asp-scale]

|   **自動スケール プロファイル – 平日 – App Service プラン**    |   **自動スケール プロファイル – 週末 – App Service プラン**    |
|   ----------------------------------------------------    |   ----------------------------------------------------    |
|   **[名前]:** 平日プロファイル                               |   **[名前]:** 週末にプロファイル                               |
|   **スケールの基準:** スケジュールおよびパフォーマンス ルール            |   **スケールの基準:** スケジュールおよびパフォーマンス ルール            |
|   **プロファイル:** (曜日別)                                   |   **プロファイル:** 週末                                    |
|   **型:** 定期的なアイテム                                    |   **型:** 定期的なアイテム                                    |
|   **ターゲットの範囲:** 5 ~ 20 インスタンス                     |   **ターゲットの範囲:** 3 ~ 10 のインスタンス                     |
|   **日数:** 月曜日、火曜日、水曜日、木曜日、金曜日  |   **日数:** 土曜日、日曜日                              |
|   **開始時刻:** 午前 9時 00分                                  |   **開始時刻:** 午前 9時 00分                                  |
|   **タイム ゾーン:** UTC – 08                                 |   **タイム ゾーン:** UTC – 08                                 |
|                                                           |                                                           |
|   **自動スケール ルール (スケールアップ)**                          |   **自動スケール ルール (スケールアップ)**                          |
|   **リソース:** 運用 (App Service 環境の場合)      |   **リソース:** 運用 (App Service 環境の場合)      |
|   **メトリック:** CPU %]                                       |   **メトリック:** CPU %]                                       |
|   **処理:** 60% より大きい                         |   **処理:** 80% を超える                         |
|   **継続時間:** 5 分                                 |   **継続時間:** 10 分                                |
|   **時間の集計:** 平均                           |   **時間の集計:** 平均                           |
|   **アクション:** 2 数の増加                         |   **アクション:** を 1 つの数を増やす                         |
|   **(分) を下がる:** 15                             |   **(分) を下がる:** 20                             |
|                                                           |                                                           |
|   **自動スケール ルール (スケールダウン)**                        |   **自動スケール ルール (スケールダウン)**                        |
|   **リソース:** 運用 (App Service 環境の場合)      |   **リソース:** 運用 (App Service 環境の場合)      |
|   **メトリック:** CPU %]                                       |   **メトリック:** CPU %]                                       |
|   **処理:** 30% よりも低い                          |   **処理:** 20% を下回る                          |
|   **継続時間:** 10 分                                |   **継続時間:** 15 分                                |
|   **時間の集計:** 平均                           |   **時間の集計:** 平均                           |
|   **アクション:** を 1 つの数を減らす                         |   **アクション:** を 1 つの数を減らす                         |
|   **(分) を下がる:** 20                             |   **(分) を下がる:** 10                             |

###App Service プランの増加率
**App Service プランの** 、そのためには 1 時間あたりの最大レートで自動スケールするように構成します。 このレート 
できますが、自動スケール ルールの指定された値にに基づいて計算されます。

理解し、計算、 **App Service プランが増加率** が重要 
**App Service 環境** **ワーカー プール** スケールからの自動スケールを変更する、 **ワーカー プール** は 
ない瞬間的な適用する時間がかかる操作を行います。

 **App Service プラン** が増加率は次のように計算します。

![][ASP-Inflation]

に基づいて、 *スケール アップの自動スケール* に対するルール、 *平日* 、運用のプロファイル 
**App Service プラン** これは次のようになります。

![][Equation1]

場合、 *スケール アップ: 自動スケール* に対するルール、 *週末* 、運用のプロファイル 
**App Service プラン** 数式を解決するには。

![][Equation2]

この値は、スケールダウン操作についても計算できます。

に基づいて、 *スケール ダウンの自動スケール* に対するルール、 *平日* 、運用のプロファイル 
**App Service プラン** これは次のようになります。

![][Equation3]

場合、 *スケール ダウン – 自動スケール* に対するルール、 *週末* 、運用のプロファイル 
**App Service プラン** 数式を解決するには。  

![][Equation4]

これにより、運用環境が **App Service プラン** 最大速度に大きくなる **8** 
1 週間に 1 時間あたりのインスタンスと **4** 週末の間の時間あたりのインスタンス。 そのことができます、 
最大レートでインスタンスを解放 **4** 週に 1 時間あたりのインスタンスと **6** インスタンス 
週末時速です。

複数の **App Service プランの** でホストされている、 **ワーカー プール**, 、 **合計が増加率** 
計算する必要がありますし、これは、として表す、 *合計* すべてが増加率の 
**App Service プランの** でホストされている **ワーカー プール**します。

![][ASP-Total-Inflation] 

###App Service プランの増加率を使用してワーカー プールの自動スケール ルールを定義する
**ワーカー プール** をホストする **App Service プランの** に構成されている自動スケールがする必要があります 
拡大/縮小する自動スケール操作を許可する容量のバッファーを確保する、 
**App Service プラン** 必要に応じて。 計算された最小バッファーになります 
**App Service プランが増加率の合計**します。

 **App Service 環境** スケール操作の適用に時間がかかる、何らかの変更を考慮する必要があります 
評価中に発生する可能性がありますそれ以上の要求変更操作が進行中です。 この私たちの 
計算済みの使用が推奨 **合計アプリ サービス プランが増加率** としての最小数 
インスタンスを自動スケール操作ごとに追加します。

フランクは、この情報を使用して次の自動スケール プロファイルとルールを定義することができます。

![][Worker-Pool-Scale]

|   **自動スケール プロファイル – 平日**                       |   **自動スケール プロファイル – 週末**               |
|   ----------------------------------------------------    |   --------------------------------------------    |
|   **[名前]:** 平日プロファイル                               |   **[名前]:** 週末にプロファイル                       |
|   **スケールの基準:** スケジュールおよびパフォーマンス ルール            |   **スケールの基準:** スケジュールおよびパフォーマンス ルール    |
|   **プロファイル:** (曜日別)                                   |   **プロファイル:** 週末                            |
|   **型:** 定期的なアイテム                                    |   **型:** 定期的なアイテム                            |
|   **ターゲットの範囲:** 13 ~ 25 のインスタンス                    |   **ターゲットの範囲:** 6 ~ 15 のインスタンス             |
|   **日数:** 月曜日、火曜日、水曜日、木曜日、金曜日  |   **日数:** 土曜日、日曜日                      |
|   **開始時刻:** 7時 00分 AM                                  |   **開始時刻:** 午前 9時 00分                          |
|   **タイム ゾーン:** UTC – 08                                 |   **タイム ゾーン:** UTC – 08                         |
|                                                           |                                                   |
|   **自動スケール ルール (スケールアップ)**                          |   **自動スケール ルール (スケールアップ)**                  |
|   **リソース:** ワーカー プール 1                             |   **リソース:** ワーカー プール 1                     |
|   **メトリック:** WorkersAvailable                            |   **メトリック:** WorkersAvailable                    |
|   **処理:** 8 個未満                              |   **処理:** 3 より小さい                      |
|   **継続時間:** 20 分                                |   **継続時間:** 30 分                        |
|   **時間の集計:** 平均                           |   **時間の集計:** 平均                   |
|   **アクション:** 8 で数の増加                         |   **アクション:** 3 数の増加                 |
|   **(分) を下がる:** 90                             |   **(分) を下がる:** 90                     |
|                                                           |                                                   |
|   **自動スケール ルール (スケールダウン)**                        |   **自動スケール ルール (スケールダウン)**                |
|   **リソース:** ワーカー プール 1                             |   **リソース:** ワーカー プール 1                     |
|   **メトリック:** WorkersAvailable                            |   **メトリック:** WorkersAvailable                    |
|   **処理:** 8 より大きい値                           |   **処理:** 3 より小さい                      |
|   **継続時間:** 20 分                                |   **継続時間:** 15 分                        |
|   **時間の集計:** 平均                           |   **時間の集計:** 平均                   |
|   **アクション:** 2 で数を減らす                         |   **アクション:** 3 で数を減らす                 |
|   **(分) を下がる:** 90                             |   **(分) を下がる:** 90                     |

定義されている最小インスタンスによって、プロファイルで定義されている対象範囲を計算します 
プロファイルを **App Service プラン** + バッファー。

最大範囲をすべてのすべての最大範囲の合計となる **App Service プランの** でホストされています。 
 **ワーカー プール**します。

X は 1 以上であるにスケール アップ ルールの増加数を設定する必要があります、 
**アプリ サービス プランが増加率** のスケール アップします。

数が増減する数は、1/2 X または X 1 の間のものに調整できる、 **アプリ サービス プランが増加
レート** のスケール ダウンします。

###フロントエンド プールの自動スケール
**フロント エンド** 自動スケール ルールはにとってよりも簡単 **ワーカー プール**, 、主な特徴を探しますが、 
スケール アウトするという事実を考慮に入れて測定および cooldown タイマー take のことを確認して期間を作成します。 
操作、 **App Service プラン** 瞬時ではありません。

このシナリオでは、Frank を知っているフロント エンドが CPU 使用率を 80% に達すると、エラー率が増加します。 
これを防ぐには、次のようにインスタンス数の増加を自動スケール ルール彼は設定します。
 
![][Front-End-Scale]
  
|   **自動スケール プロファイル – フロントエンド**             |
|   --------------------------------------------    |
|   **[名前]:** 自動スケール – フロント エンド               |
|   **スケールの基準:** スケジュールおよびパフォーマンス ルール    |
|   **プロファイル:** 日常的な                           |
|   **型:** 定期的なアイテム                            |
|   **ターゲットの範囲:** 3 ~ 10 のインスタンス             |
|   **日数:** 日常的な                              |
|   **開始時刻:** 午前 9時 00分                          |
|   **タイム ゾーン:** UTC – 08                         |
|                                                   |
|   **自動スケール ルール (スケールアップ)**                  |
|   **リソース:** フロント エンド プール                    |
|   **メトリック:** CPU %]                               |
|   **処理:** 60% より大きい                 |
|   **継続時間:** 20 分                        |
|   **時間の集計:** 平均                   |
|   **アクション:** 3 数の増加                 |
|   **(分) を下がる:** 90                     |
|                                                   |
|   **自動スケール ルール (スケールダウン)**                |
|   **リソース:** ワーカー プール 1                     |
|   **メトリック:** CPU %]                               |
|   **処理:** 30% よりも低い                  |
|   **継続時間:** 20 分                        |
|   **時間の集計:** 平均                   |
|   **アクション:** 3 で数を減らす                 |
|   **(分) を下がる:** 90                     |

<!-- IMAGES -->
[intro]: ./media/app-service-environment-auto-scale/introduction.png
[settings-scale]: ./media/app-service-environment-auto-scale/settings-scale.png
[scale-manual]: ./media/app-service-environment-auto-scale/scale-manual.png
[scale-profile]: ./media/app-service-environment-auto-scale/scale-profile.png
[scale-profile2]: ./media/app-service-environment-auto-scale/scale-profile-2.png
[scale-rule]: ./media/app-service-environment-auto-scale/scale-rule.png
[asp-scale]: ./media/app-service-environment-auto-scale/asp-scale.png
[ASP-Inflation]: ./media/app-service-environment-auto-scale/asp-inflation-rate.png
[Equation1]: ./media/app-service-environment-auto-scale/equation1.png
[Equation2]: ./media/app-service-environment-auto-scale/equation2.png
[Equation3]: ./media/app-service-environment-auto-scale/equation3.png
[Equation4]: ./media/app-service-environment-auto-scale/equation4.png
[ASP-Total-Inflation]: ./media/app-service-environment-auto-scale/asp-total-inflation-rate.png
[Worker-Pool-Scale]: ./media/app-service-environment-auto-scale/wp-scale.png
[Front-End-Scale]: ./media/app-service-environment-auto-scale/fe-scale.png


