<properties 
    pageTitle="Azure Search 用のプロトタイプ アプリケーションを構築する | Microsoft Azure | ホスト型クラウド検索サービス" 
    description="ホスト型のクラウド検索サービスである Azure Search を使い始めるために、最初のアプリケーション プロトタイプを作成します。" 
    services="search" 
    documentationCenter="" 
    authors="HeidiSteen" 
    manager="mblythe" 
    editor=""/>

<tags 
    ms.service="search" 
    ms.devlang="rest-api" 
    ms.workload="search" 
    ms.topic="article" 
    ms.tgt_pltfrm="na" 
    ms.date="11/04/2015" 
    ms.author="heidist"/>

# Azure Search 用のプロトタイプ アプリケーションを構築する

ホスト型のクラウド検索サービスとして Azure Search を評価する開発者は、ほとんどの場合、まずは暫定版のテスト アプリケーションを作成して、カスタム アプリケーションに Azure Search を追加する価値を検証します。
この記事では、プロトタイプの作成プロセスを迅速化するためのいくつかの構成要素を紹介します。
 
- data.json および schema.json ファイルを含む、Visual Studio C# プロジェクト。 サンプル データがあることで、すぐにソリューションを構築し、実行できます。コードを 1 行も記述しなくても、自分のシステムでソリューションが動作することを確認できます。 

    可能であれば、これらのスタンドアロンで接続されていないスキーマとデータ ファイルを、実際のビジネスのデータに置き換えてみてください。 そうすれば、アプリケーションを実行するときに、作成されるインデックスはスキーマに基づき、ドキュメントはデータ ファイルに基づいているので、Azure Search ですぐに機能させることができます。

- Azure Search にアップロードするデータを構造化する方法についてのガイダンス。 インデックスごとに 1 つのデータセットを必要があります。 Azure Search では、データのシリアル化に JSON を使用します。

- 最後に、プロトタイプを次のレベルに引き上げる、いくつかの追加機能を紹介します。ファセット ナビゲーション、検索結果のチューニングのためのスコアリング プロファイル、先行入力またはオート コンプリート クエリのような検索固有の機能と、厳密な他のフルテキスト検索では利用できない検索ページ関連機能を組み合わせることができます。

最後に、プロトタイプ アプリケーションがあります。実際のデータを使用し、Azure Search による堅牢な検索エクスペリエンスを試すことができます。 

## データを準備する

検索操作は、Azure Search で作成した検索インデックスに対して実行されます。 インデックスには、スコアリング プロファイルやサジェスターなどの複数の部分がありますが、インデックスのほとんどは、検索操作で使用されるデータ フィールドから成っています。 

フィールドを提供するデータセットは、フラットなデータ ファイル (JSON 形式) である必要があります。データセット内の各フィールドは、データを設定するインデックス内の相当するフィールドにマップされます。 スコアリング プロファイル、CORS オプションなど、インデックスの他の部分は、スキーマに直接、個別に追加されます。

Azure Table Storage など、JSON をネイティブに使用するデータ ソースは、リレーショナル データよりも使いやすいデータを提供します。すべてのフィールドを 1 つの行セットで提示できる、1 つのビューまたはテーブルが必要になります。

プロトタイプ サンプル アプリケーション内のコードを使用して、データとスキーマのファイルをアップロードするために、ソリューション内に埋め込まれている既定のスキーマとデータのファイルを上書きできます。

> [AZURE.NOTE] バッチ内のデータをアップロードするなどの複数のデータ ファイルを読み込むことができますが、データの構造が同じインデックスにアップロードするデータ ファイルごとに同じである必要があります。 インデックスを結合することはできません。各インデックスは、独立した検索コーパスとして機能します。

## システム上でプロトタイプ ソリューションをテストする

1. [Azure クラシック ポータルで Azure Search サービスの作成](search-create-service-portal.md)します。

    サービスの共有 (無料) バージョンを、既存の任意の Azure サブスクリプションに追加できます。 共有サービスは、プロトタイプ用によく使用されます。 共有サービスでは、データが 50 MB に達するか、ドキュメントが合計 10,000 に達するかの、いずれか早い方までという制限があることに注意してください。 また、データとドキュメントは、最大で 3 つのインデックス間にまたがることができます。 

    組み込みのサンプル データ ファイルでプロトタイプ サンプル アプリケーションを実行すると、"musicstoreindex" いう名前の 1 つのインデックスが作成されます。246 個のドキュメントが含まれており、Azure Search サービス上で 278 KB になります。 このチュートリアルの後の方で、このインデックスを、Adventure Works データを使用した新しいインデックスに置き換えます。そのインデックスでは、最大で ## 個のドキュメントと ## MB が使用されます。

2. [プロトタイプ ビルダー ソリューションをダウンロードする](http://go.microsoft.com/fwlink/p/?LinkId=536479)です。 これは、インデックスの作成、読み込み、およびクエリに使用されるコンソール アプリケーションを構築する、C# での Visual Studio 2013 ソリューションです。 Visual Studio がいない場合は、取得できます、無料 [Visual Studio 2013 Express edition](http://www.visualstudio.com/products/visual-studio-express-vs.aspx) バージョンです。

3. app.config を編集して、自分の Search サービスと API キーをターゲットにする構成設定を追加します。 

    URL と管理の api キーを取得できます [ポータルでのサービス ダッシュ ボード](search-create-service-portal.md)します。 URL については、https プレフィックスと `search.windows.net` ドメインを含めて、サービス名の完全パスを入力します。

4. ソリューションをビルドし、ビルド エラーが発生しないことを確認します。 ビルド エラーを解決するために、パッケージを更新しなければならない場合もあります。 右クリック **[NuGet パッケージの** パッケージを更新するソリューションです。

5. 組み込みのスキーマとデータ ファイルを使用して、ソリューションを実行します。 この手順はオプションですが、独自のデータの追加に時間を費やす前に、ソリューションの動作を確認できます。 次のメッセージが、コンソールに出力されます。

    - インデックスが削除された ("musicstoreindex" という名前のインデックスが存在する場合のみ)
    - インデックスが作成された ("musicstoreindex" という名前の新しいインデックスがサービスに作成されます)
    - ドキュメントが投稿された (JSON ファイルごとに 1 つのメッセージ)
    - 5 秒間待機している (最初のクエリを発行する前にインデックスの作成が完了できるようにする)
    - ブースティングなしでの、検索語句 'best' の検索結果 (データがインデックスに読み込まれたことを証明するための単純なクエリを実行)

6. アプリケーションを停止し、独自のデータのスペースを確保するためにインデックスを削除します。 

    > [AZURE.TIP] 使用する [ポータル](https://portal.azure.com) インデックスを削除します。 インデックスのブレードを開き、使用するには、インデックス名をクリックして、 **削除** コマンドです。

## データのスキーマとデータ JSON ファイルを自分のデータに置き換える

プロトタイプ ソリューションでは、1 つのスキーマ ファイルと 3 つのデータ ファイル (data1.json、data2.json、および data3.json) があります。 スキーマ ファイル (schema.json) は、独自のデータを説明するスキーマに置き換える必要があります。 

既定では、これらのファイルは以下のようにソリューション フォルダーにあります。

![][1]

独自のデータを JSON ファイルに変換できる場合は、既存のファイルを独自のデータで上書きし、アプリケーションを実行してインデックスの作成と読み込みを行うことができます。 データを複数のファイルに分散すると、一括アップロード操作を試すことができます。 

データを読み込むためのその他のアプローチとして、インデクサーの使用が挙げられます (Azure DocumentDB データ ソースまたは Azure SQL Database データ ソースが必要)。 別のデータを読み込む方法を説明するサンプル コードは掲載されて [Azure Search のビデオとチュートリアルのリスト](search-video-demo-tutorial-list.md) MSDN にします。

### クエリを編集する

ソリューションに組み込まれている既定のクエリは、組み込みのデータ ファイルのフィールドと構造を参照します。 実際のデータを使用するようにデータ ファイルを上書きしたので、クエリのコードをコメント アウトするか、自分のスキーマのフィールドを使用するように変更できます。 検索クエリ構文の詳細については、次を参照してください。 [ドキュメントの検索](https://msdn.microsoft.com/library/azure/dn798927.aspx)します。

### アプリケーションの構築と実行

キーを押して **f5 キーを押して** アプリケーションを実行します。 前回と同様に、インデックスが作成されて読み込まれ、クエリ可能になっていることを示すメッセージが表示されます。

より詳しい調査の基盤として使用できる、実務的なインデックスが用意できました。

切り替えるこの時点では、 [Fiddler](search-fiddler.md) または [Chrome Postman](search-chrome-postman.md) クエリを実行するには、Search サービスおよびインデックスを使用するサンプル アプリケーションを変更するか、データを視覚化するカスタム コードを追加します。

## スコアリング プロファイルを追加する

実験をお勧め [スコアリング プロファイル](search-get-started-scoring-profiles.md) 、ポータルまたはコードを使用します。 スコアリング プロファイルは、特定のフィールドで検出される検索語句の重要性を高めます。 たとえば、検索語句が市区町村名である場合は、必要があるドキュメント *シアトル* 、City フィールドにあるドキュメントよりも上位の結果に表示する、 *シアトル* 、Description フィールドにします。

スコアリング プロファイルを追加すると、インデックスが変更されます。スキーマを変更するたびに、インデックスを再ビルドして読み込み直す必要があります。 このため、プロトタイプにスコアリング プロファイルのコード セグメントを追加することを検討してください (または、インデックス作成コードを使用するようにスコアリング プロファイル サンプルを変更してください)。

参照してください [スコアリング プロファイルの追加](https://msdn.microsoft.com/library/dn798928.aspx) リファレンス ドキュメントについては、スコアリング プロファイルにします。

## サジェスターを追加する

サジェスターとは、ユーザーからのテキスト入力に基づいて可能性のある検索語句のリストを提案する、一般的な検索機能のことです (「wea」と入力すると、"weather"、"weather channel"、"weather underground" などのオートコンプリート検索語句のリストが提示されます)。

サジェスターを追加するには、インデックス スキーマに、オートコンプリートまたは先行入力クエリの構築に使用するフィールドを指定するセクションを追加します。 通常は、重複する値がない、名前または短い文字列を格納しているフィールドが最適です。 参照してください [Create Index](https://msdn.microsoft.com/library/dn798928.aspx) の詳細。

## 言語アナライザーを試す

言語アナライザーは、重要な単語と重要でない単語、原形、さらには同義語を区別する言語規則を提供します。 既定では、Azure Search は英語用に Lucene 言語アナライザーを使用します。 特定のフィールドのインデックス属性として、別のアナライザーを指定できます。そうすることで、異なるアナライザーを使用するフィールドを含むスキーマとドキュメントを構築できます (たとえば、多言語アプリケーションでは、同じドキュメント内でフランス語と英語のフィールドを並べて使用することがあります)。 参照してください [言語サポート](https://msdn.microsoft.com/library/dn879793.aspx) 詳細です。

## 次のステップ

これまでのセクションでは、プロトタイプに機能を追加するためにインデックスを変更しました。 この時点で、インデックスの変更はほぼ完了です (CORS の有効化は行いませんでした。これが、まだ行っていない唯一のスキーマ変更です)。

さらにプロトタイプ作成を進めるには、2 つの異なる方向性が考えられます。UI に対する外面的な集中 (ファセット ナビゲーションや、検索を絞り込むその他のフィルターの追加など) と、ソリューションのデータ同期の面でのさらに詳細な調査です。 多くのソリューションには、揮発性データがあります。 多くの開発者にとって、トランザクション データベース システムと Azure Search インデックス間のデータ更新の同期は、基本的な検索動作の検証の次に優先度が高い事項です。

詳細については、次のリンクを参照してください。

- [Azure Search を使用する開発プロジェクトの一般的なワークフロー](search-workflow.md)

- [Azure Search Indexer のカスタマイズ](search-indexers-customization.md)

- [Azure Search のファセット ナビゲーション](search-faceted-navigation.md) 

- [Azure Search での検索結果のページング](search-pagination-page-layout.md)


<!--Image references-->
[1]: ./media/search-build-prototype/azsearch-datafiles.png
 
