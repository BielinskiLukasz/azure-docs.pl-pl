<properties
    pageTitle="Visual Studio Team Services を使用してアプリケーションのロード テストを実行する | Microsoft Azure"
    description="Visual Studio Team Services を使用して Azure Service Fabric アプリケーションのストレス テストを実行する方法について説明します。"
    services="service-fabric"
    documentationCenter="na"
    authors="cawams"
    manager="timlt"
    editor="" />

<tags
    ms.service="multiple"
    ms.devlang="dotnet"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.workload="multiple"
    ms.date="10/28/2015"
    ms.author="cawa" />

# Visual Studio Team Services を使用してアプリケーションのロード テストを実行する

この記事では、Visual Studio ロード テスト機能を使用して、アプリケーションのストレス テストを実行する方法について説明します。 この機能では、Service Fabric のステートフル サービス バックエンドとステートレス サービス Web フロントエンドが使用されます。 この記事で使用するサンプル アプリケーションは、飛行機の位置特定シミュレーターです。 ユーザーが飛行機の ID、出発地、および到着地を指定すると、 アプリケーションのバックエンドによって要求が処理され、フロントエンドによって条件に一致する飛行機がマップに表示されます。

次の図は、テストする Service Fabric アプリケーションを示しています。

![][0]

## 前提条件
始める前には、次の手順を実行する必要があります。

- Visual Studio Team Services (VSTS) アカウントを取得します。 無料で取得できます [Visual Studio Team Services](https://www.visualstudio.com)します。
- Visual Studio 2013 または Visual Studio 2015 を取得してインストールする。 この記事では、Visual Studio 2015 Enterprise エディションを使用しますが、Visual Studio 2013 など他のエディションも同様に機能します。
- ステージング環境にアプリケーションをデプロイする。 参照してください [Visual Studio を使用してリモート クラスターにアプリケーションを展開する方法](service-fabric-publish-app-remote-cluster.md) についてはこれです。
- アプリケーションの使用パターンを理解する。 この情報は、ロード パターンをシミュレートするために使用されます。
- ロード テストの目標を理解する。 これは、ロード テストの結果の解釈と分析に役立ちます。

## Web パフォーマンスとロード テストのプロジェクトの作成と実行

### Web パフォーマンスとロード テストのプロジェクトを作成する

1. Visual Studio 2015 を開きます。 選択 **ファイル** > **新規** > **プロジェクト** を開くにはメニュー バーで、 **新しいプロジェクト** ] ダイアログ ボックス。

1. 展開、 **Visual c#** ノードを選択して **テスト** > **Web パフォーマンスとロード テストのプロジェクト**します。 プロジェクトに名前を付けてを選択し、 **OK** ] ボタンをクリックします。

    ![][1]

    新しい Web パフォーマンスとロード テストのプロジェクトが表示されます。

    ![][2]

### Web パフォーマンス テストを記録する

1. .webtest プロジェクトを開きます。

1. 選択、 **記録追加** お使いのブラウザーで記録セッションを開始するにはアイコン。

    ![][3]

    ![][4]

1. Service Fabric アプリケーションを参照します。 記録パネルに Web 要求が表示されます。

    ![][5]

1. ユーザーが実行すると予想される一連のアクションを実行します。 これらのアクションは、負荷を生成するパターンとして使用されます。

1. 完了したら、選択、 **停止** 記録を停止する] ボタンをクリックします。

    ![][6]

    Visual Studio の .webtest プロジェクトで一連の要求がキャプチャされます。 動的パラメーターが自動的に置き換えられます。 この時点で、テスト シナリオに含まれていない余分な依存関係要求の繰り返しを削除できます。

1. プロジェクトを保存しを選択し、 **テストの実行** web パフォーマンス テストをローカルで実行し、すべてのものを確認するにはコマンドが正常に動作します。

    ![][7]

### Web パフォーマンス テストをパラメーター化する

Web パフォーマンス テストをパラメーター化するには、コード化された Web パフォーマンス テストに変換し、そのコードを編集します。 または、テストでデータが反復処理されるように、データの一覧に Web パフォーマンス テストをバインドすることもできます。 参照してください [の生成とコード化された web パフォーマンス テストの実行](https://msdn.microsoft.com/library/ms182552.aspx) web パフォーマンスに変換する方法の詳細については、コード化されたテストにテスト用と [web パフォーマンス テストへのデータ ソースの追加](https://msdn.microsoft.com/library/ms243142.aspx) web パフォーマンス テストにデータをバインドする方法についてです。

この例では、GUID を生成して飛行機 ID と置き換え、フライトを複数の場所に送信するための要求を追加できるように、Web パフォーマンス テストをコード化されたテストに変換します。

### ロード テスト プロジェクトを作成する

ロード テスト プロジェクトは、Web パフォーマンス テストと単体テストで記述されている 1 つ以上のシナリオと、指定された追加のロード テスト設定で構成されます。 次の手順は、ロード テスト プロジェクトを作成する方法を示しています。

1. Web パフォーマンスおよびロード テストのプロジェクトのショートカット メニューで **追加** > **ロード テスト**します。  **ロード テスト** ウィザードを選択、 **次** テストの設定を構成するボタンです。

1.  **ロード パターン** セクションで、ユーザーの一定の負荷または少数のユーザーから開始して、ユーザーが時間と共に増加するステップ ロードするかどうかを選択します。

    ユーザーの負荷の量に正確に予測があり、現在のシステムを実行する方法を参照するには、選択した場合 **定数ロード**します。 目標は、学習する場合かどうか、システムで実行される一貫してさまざまな量の負荷の下にある、選択 **ステップ ロード**します。

1.  **[テスト ミックスの** セクションで、選択、 **追加** ] ボタンをクリックし、ロード テストに追加するテストを選択します。 使用することができます、 **配布** テストごとに実行するテストの合計の割合を指定する列。

1.  **実行設定** セクションで、ロード テスト継続時間を指定します。
    >[AZURE.NOTE]  **テスト イテレーション** オプションは、Visual Studio を使用してローカルでロード テストを実行する場合にのみ使用します。

1.  **場所** の **実行設定**, 、ロード テストの要求の生成元の場所を指定します。 ウィザードで、Team Services アカウントにログインするよう要求される場合があります。 Team Services アカウントを使用してログインし、地理的な場所を選択します。 完了したら、選択、 **完了** ] ボタンをクリックします。

1. .Loadtest プロジェクトを開き、ロード テストを作成した後、現在の設定をなど、実行を選択して **実行設定** > **Run Settings1 [Active]**します。 実行設定が開き、 **プロパティ** ウィンドウです。

1.  **結果** のセクション、 **実行設定** プロパティ] ウィンドウで、 **タイミングの詳細ストレージ** 設定する必要がありますが **None** の既定値です。 この値に変更 **すべての個別詳細** 、ロード テスト結果の詳細情報を表示します。 参照してください [テストを読み込む](https://www.visualstudio.com/load-testing.aspx) Visual Studio チームのサービスに接続して、ロード テストを実行する方法についての詳細。

### Visual Studio Team Services を使用してロード テストを実行する

選択、 **ロード テストの実行** テストの実行を開始するコマンドです。

![][8]

## ロード テスト結果の表示と分析

ロード テストの進行に合わせて、パフォーマンス情報がグラフ化されます。 次のようなグラフが表示されます。

![][9]

1. 選択、 **レポートをダウンロード** ページの上部にあるリンクです。 レポートをダウンロードした後、選択、 **レポートを表示する** ] ボタンをクリックします。

     **グラフ** ] タブのさまざまなパフォーマンス カウンターのグラフを表示できます。  **概要** ] タブの全体的なテスト結果が表示されます。  **テーブル** ] タブで、成功および失敗したロード テストの総数が表示されます。

1. 数値のリンクをクリックして、 **テスト** > **失敗** と **エラー** > **カウント** エラーの詳細を表示する列。

     **詳細** タブが失敗した要求の仮想のユーザーとテスト シナリオの情報を表示します。 このデータは、ロード テストに複数のシナリオが含まれている場合に役立ちます。

参照してください [、ロード テスト アナライザーのグラフ ビューでロード テスト結果の分析](https://www.visualstudio.com/load-testing.aspx) 負荷を表示する方法の詳細については、テスト結果。

## ロード テストの自動化

Visual Studio Team Services のロード テストで提供されている API を使用して、Team Services アカウントでロード テストを管理し、結果を分析できます。 参照してください [クラウド ロード テストの Rest Api](http://blogs.msdn.com/b/visualstudioalm/archive/2014/11/03/cloud-load-testing-rest-apis-are-here.aspx) の詳細。

## 次のステップ
- [ローカル コンピューターの開発のセットアップでのサービスの監視と診断](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

[0]: ./media/service-fabric-vso-load-test/OverviewDiagram.png
[1]: ./media/service-fabric-vso-load-test/NewProjectDialog.png
[2]: ./media/service-fabric-vso-load-test/Project.png
[3]: ./media/service-fabric-vso-load-test/AddRecording.png
[4]: ./media/service-fabric-vso-load-test/AddRecording2.png
[5]: ./media/service-fabric-vso-load-test/ActionSequence.png
[6]: ./media/service-fabric-vso-load-test/StopRecording.png
[7]: ./media/service-fabric-vso-load-test/RunTest.png
[8]: ./media/service-fabric-vso-load-test/RunTest2.png
[9]: ./media/service-fabric-vso-load-test/Graph.png

