<properties
   pageTitle="Azure Cloud Services および Virtual Machines 向け Microsoft マルウェア対策 | Microsoft Azure"
   description="この記事では、Azure 向けの Microsoft マルウェア対策のアーキテクチャの概要を説明します。Azure Cloud Services および Virtual Machines の保護の有効化、構成、デプロイに関するサポートされるシナリオと構成などについて説明します。 Microsoft Azure サービス管理 API、PowerShell スクリプト、Microsoft Azure 管理ポータル、Visual Studio でアクセスできる基本的な構成、管理、監視の機能を説明します。"
   services="virtual-machines, cloud-services, storage"
   documentationCenter="na"
   authors="YuriDio"
   manager="swadhwa"
   editor=""/>

<tags
   ms.service="azure-security"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="12/10/2015"
   ms.author="yuridio"/>

#Azure Cloud Services および Virtual Machines 向け Microsoft マルウェア対策

最近のクラウド環境に対する脅威は非常に変化が激しく、コンプライアンスとセキュリティの要件を満たすために効果的な保護を維持しなければならないというビジネス IT クラウドのサブスクライバーに対する圧力はますます大きくなっています。 Azure Cloud Services および Virtual Machines 向けの Microsoft マルウェア対策は、ウイルスやスパイウェアなどの悪意のあるソフトウェアを識別して削除するリアルタイム保護機能であり、既知のマルウェアや不要なソフトウェアが Azure システムへのインストールまたは実行を試みた場合に警告する構成可能なアラートを備えています。

ソリューションをビルド、同じマルウェア対策とプラットフォームを Microsoft Security Essentials \[MSE\]、Microsoft Forefront Endpoint Protection、Microsoft System Center Endpoint Protection、Windows Intune、および Windows 8.0 以降の Windows Defender します。 Azure 向け Microsoft マルウェア対策は、アプリケーションおよびテナント環境のための単一エージェント ソリューションであり、ユーザーの介入なしにバック グラウンドで実行するように作られています。 アプリケーションのワークロードのニーズに基づいて、マルウェア対策監視など、基本的な既定のセキュリティまたは高度なカスタム構成で、保護をデプロイできます。

Azure 向け Microsoft マルウェア対策をアプリケーションにデプロイして有効にすると、次のコア機能を使用できるようになります。

**リアルタイム保護** -クラウド サービス、および仮想マシンを検出し、マルウェアの実行をブロックにアクティビティを監視します。

**スキャン スケジュール** -プログラムの実行中など、マルウェアを検出するために対象となるスキャンを定期的に実行します。

**マルウェアを駆除** - 自動的に検出されたマルウェア、削除、悪意のあるファイルを検疫または悪意のあるレジストリ エントリのクリーンアップなどのアクションを実行します。

**署名の更新プログラム** - 自動的に保護が事前に定義した頻度に最新の状態を最新の対策署名 (ウイルス定義) をインストールします。

**マルウェア対策エンジンが更新** に自動的に Microsoft マルウェア対策エンジンを更新します。

**マルウェア対策のプラットフォーム更新** に自動的に Microsoft マルウェア対策のプラットフォームを更新します。

**アクティブな保護** - 進化し続ける脅威の情勢への迅速な応答を確実に Microsoft Azure への検出された脅威と疑わしいリソースに関するテレメトリ メタデータを報告するだけでなくリアルタイム同期署名配信を通じて、Microsoft Active Protection システム (MAPS) を有効にするとします。

**レポートのサンプル** - やサンプルをサービスの改善、およびトラブルシューティングを行うために、Microsoft マルウェア対策サービスに報告を実現します。

**除外リストの** -により、プロセスの特定のファイルを構成するには、アプリケーションとサービス管理者と、保護し、パフォーマンスやその他の理由のスキャンから除外するドライブです。

**イベント コレクションのマルウェア対策** - マルウェア対策サービスのヘルス状態、疑わしいアクティビティは、およびオペレーティング システムのイベント ログで実行される修復アクションを記録し、顧客の Azure ストレージ アカウントにそれらを収集します。

##アーキテクチャ

Azure Cloud Services および Virtual Machines 向け Microsoft マルウェア対策ソリューションには、Microsoft マルウェア対策クライアントとサービス、マルウェア対策サービス管理拡張機能、マルウェア対策 PowerShell コマンドレット、および Azure 診断拡張機能が含まれます。 Microsoft マルウェア対策ソリューションは、Windows Server 2008 R2、Windows Server 2012、および Windows Server 2012 R2 の各オペレーティング システム ファミリでサポートされます。 Windows Server 2008 オペレーティング システムではサポートされません。 現時点では Windows Server Technical Preview はサポートされていませんが、将来的にはサポートされる予定です。

Microsoft マルウェア対策クライアントおよびサーバーは、既定では、Cloud Services プラットフォームのすべてのサポートされる Azure ゲスト オペレーティング システム ファミリに無効状態でインストールされます。

Microsoft マルウェア対策クライアントおよびサービスは既定では Virtual Machines プラットフォームにはインストールされず、Microsoft Azure 管理ポータルおよび Visual Studio 仮想マシン構成のセキュリティ拡張機能でオプション機能として使用できます。

###Microsoft マルウェア対策のワークフロー

Azure サービスの管理者は、既定の構成で、または以下のオプションを使用してカスタム構成で、Virtual Machines および Cloud Services に対する Azure 向けマルウェア対策を有効にできます。

-   Virtual Machines – Microsoft Azure 管理ポータルの [セキュリティ拡張機能]

-   Virtual Machines – Visual Studio のサーバー エクスプローラーの仮想マシン構成

-   Virtual Machines および Cloud Services – マルウェア対策サービス管理 API (SMAPI)

-   Virtual Machines および Cloud Services – マルウェア対策 PowerShell コマンドレット

Microsoft Azure 管理ポータルまたは PowerShell コマンドレットは、あらかじめ決められている固定の場所にある Azure システムに、マルウェア対策拡張機能パッケージ ファイルをプッシュします。 Azure ゲスト エージェント (またはファブリック エージェント) は、マルウェア対策拡張機能を起動し、入力として提供されたマルウェア対策の構成設定を適用します。 これにより、マルウェア対策サービスは既定またはカスタムの構成設定で有効になります。 カスタム構成を指定しないと、マルウェア対策サービスは既定の構成設定で有効になります。 参照してください、 *マルウェア対策の構成* セクション、 [Azure クラウド サービスと仮想マシン-コード サンプルの Microsoft マルウェア対策](http://aka.ms/amazsamples "Microsoft マルウェア対策の Azure クラウド サービスと Vm のコード サンプル") 詳細です。

Microsoft マルウェア対策クライアントは実行すると、最新の保護エンジンとシグネチャ定義をインターネットからダウンロードして、Azure システムに読み込みます。 Microsoft マルウェア対策サービスは、サービス関連のイベントをシステム OS イベント ログの "Microsoft マルウェア対策" イベント ソースに書き込みます。 イベントには、マルウェア対策クライアントの正常性状態、保護と修復の状態、新旧の構成設定、エンジンの更新とシグネチャの定義、その他が含まれます。

生成されたマルウェア対策イベント ログ イベントを Azure ストレージ アカウントに書き込むように、Cloud Service または Virtual Machine のマルウェア対策監視を構成できます。 マルウェア対策サービスは、Azure 診断拡張機能を使用して、Azure システムから顧客の Azure ストレージ アカウントのテーブルにマルウェア対策イベントを収集できます。

構成手順と、上記のシナリオについては、「でサポートされているオプションの展開ワークフロー [マルウェア対策の展開シナリオ](#_Antimalware_Deployment_Scenarios) このドキュメントの「します。

![Azure での Microsoft マルウェア対策](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

###マルウェア対策の既定の構成とカスタム構成

カスタム構成設定を指定しない場合、Azure Cloud Services または Virtual Machines のマルウェア対策は既定の構成設定を適用して有効になります。 既定の構成設定は、Azure 環境での実行に合わせてあらかじめ最適化されています。 Azure アプリケーションまたはサービスのデプロイメントでの必要に応じて既定の構成設定をカスタマイズし、他のデプロイメント シナリオに適用できます。

次の表は、マルウェア対策サービスで使用できる構成設定をまとめたものです。 「既定値」列は既定の構成設定です。

![表 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

##マルウェア対策のデプロイ シナリオ

ここでは、Azure Cloud Services および Virtual Machines の監視など、マルウェア対策を有効にして構成するシナリオについて説明します。

###Virtual Machines - マルウェア対策の有効化と構成

**Azure プレビュー ポータルを使用したデプロイ**

マルウェア対策サービスを有効にする] をクリックして **追加** [拡張機能] ブレードで、次のように選択します。 **Microsoft マルウェア対策** 新しいリソースのブレードをクリックして **作成** Microsoft マルウェア対策のブレードでします。 クリックして **作成** せず、既定の設定でマルウェア対策を有効にするか、次の図 2 に示すように構成されている仮想マシンのマルウェア対策の構成設定を入力、構成値を入力します。 参照してください、 **ツールヒント** サポートされる構成値を表示する拡張機能の追加] ブレードでそれぞれの構成設定が付属しています。

![Microsoft マルウェア対策用の Virtual Machine の構成設定](./media/azure-security-antimalware/sec-azantimal-fig2.PNG)

**Microsoft Azure 管理ポータルを使用したデプロイ**

Azure Virtual Machines のプロビジョニングの間に Microsoft Azure 管理ポータルを使用して Virtual Machines の Microsoft マルウェア対策を有効化および構成するには、次の手順のようにします。

1. Azure 管理ポータルにログオン <https://manage.windowsazure.com>

2. 新しいバーチャル マシンを作成する] をクリックして **新規**, 、**コンピューティング**, 、**仮想** **マシン**, 、**ギャラリーから** (使用しない簡易作成) 次のようにします。

![新しい仮想マシン](./media/azure-security-antimalware/sec-azantimal-fig3.PNG)


3. [、 **Microsoft Windows Server** でイメージ、 **イメージの選択** ページです。

4. 右矢印をクリックし、仮想マシンの構成を入力します。

5. check、 **Microsoft マルウェア対策** 下のチェック ボックス **セキュリティ拡張機能** 仮想マシンの構成] ページ。

6. [送信] ボタンをクリックし、Azure Virtual Machines の Microsoft マルウェア対策を既定の構成設定で有効化して構成します。

![仮想マシンの構成](./media/azure-security-antimalware/sec-azantimal-fig4.PNG)

**Visual Studio の仮想マシン構成を使用したデプロイメント**

Visual Studio を使用して Microsoft マルウェア対策サービスを有効化および構成するには:

1. Visual Studio で Microsoft Azure に接続します。

2. 仮想マシンの選択、 **仮想マシン** 内のノード **サーバー エクスプ ローラー**

![Visual Studio での仮想マシンの構成](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3. を右クリックして **構成** を仮想マシンの構成ページを表示するには

4. [ **Microsoft マルウェア対策** 下にあるドロップダウン リストから拡張 **インストールされた拡張機能** ] をクリック **追加** マルウェア対策の既定の構成を構成します。

![インストール済み拡張機能](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)

5. 既定のマルウェア対策の構成をカスタマイズする順番でインストールされた拡張機能 (強調表示)、マルウェア対策の拡張機能を選択し] をクリックして **構成**します。

6. でサポートされている JSON 形式でカスタムの構成に既定のマルウェア対策の構成を置き換える、 **パブリック構成** textbox OK] をクリックします。

7. [、 **更新** 仮想マシンに構成の更新をプッシュするボタンをクリックします。

![仮想マシン構成拡張機能](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

**注:** マルウェア対策用の Visual Studio 仮想マシンの構成は、JSON 形式の構成のみをサポートします。 マルウェア対策の JSON の構成設定のテンプレートが含まれている、 [Microsoft マルウェア対策の Azure クラウド サービスと仮想マシンのコード サンプル](http://aka.ms/amazsamples "Microsoft マルウェア対策の Azure クラウド サービスと仮想マシンのコード サンプル"), 、サポートされているマルウェア対策の構成設定を表示します。

**PowerShell コマンドレットを使用したデプロイ**

Azure のアプリケーションまたはサービスでは、PowerShell コマンドレットを使用して Azure Virtual Machines の Microsoft マルウェア対策を有効化および構成できます。

マルウェア対策 PowerShell コマンドレットを使用して Microsoft マルウェア対策を有効化および構成するには:

1. PowerShell 環境を設定するのには、ドキュメントを参照してください <https://github.com/Azure/azure-sdk-tools#get-started>

2. セット AzureVMMicrosoftAntimalwareExtension マルウェア対策コマンドレットを使用して有効にして」の説明に従って、仮想マシンの Microsoft マルウェア対策を構成 <http://msdn.microsoft.com/library/azure/dn771718.aspx>

**注:** マルウェア対策用の Azure の仮想マシンの構成は、JSON 形式の構成のみをサポートします。 マルウェア対策の JSON の構成設定のテンプレートが含まれている、 [Microsoft マルウェア対策の Azure クラウド サービスと仮想マシンのコード サンプル](http://aka.ms/amazsamples "Microsoft マルウェア対策の Azure クラウド サービスと仮想マシンのコード サンプル"), 、サポートされているマルウェア対策の構成設定を表示します。

###PowerShell コマンドレットを使用したマルウェア対策の有効化と構成

Azure のアプリケーションまたはサービスでは、PowerShell コマンドレットを使用して Azure Cloud Services 向けの Microsoft マルウェア対策を有効化および構成できます。 Microsoft マルウェア対策は Cloud Services プラットフォームに無効状態でインストールされるので、Azure アプリケーションで有効化する必要があることに注意してください。

PowerShell コマンドレットを使用して Microsoft マルウェア対策を有効化および構成するには:

1.  PowerShell 環境を設定するのには、ドキュメントを参照してください <https://github.com/Azure/azure-sdk-tools#get-started>

2.  セット AzureServiceAntimalwareExtension マルウェア対策コマンドレットを使用して有効にして」の説明に従って、Microsoft マルウェア対策をクラウド サービスの構成 <http://msdn.microsoft.com/library/azure/dn771718.aspx>

マルウェア対策の XML 構成の設定テンプレートが含まれている、 [Microsoft マルウェア対策の Azure クラウド サービスと仮想マシンのコード サンプル](http://aka.ms/amazsamples "Microsoft マルウェア対策の Azure クラウド サービスと仮想マシンのコード サンプル"), 、サポートされているマルウェア対策の構成設定を表示します。

###Cloud Services と Virtual Machines - PowerShell コマンドレットを用いた構成

Azure のアプリケーションまたはサービスでは、PowerShell コマンドレットを使用して、Cloud Services および Virtual Machines 向けの Microsoft マルウェア対策の構成を取得できます。

PowerShell コマンドレットを使用して Microsoft マルウェア対策の構成を取得するには:

1.  PowerShell 環境を設定するのには、ドキュメントを参照してください <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **仮想マシンの**:」の説明に従って、マルウェア対策の構成を取得する Get AzureVMMicrosoftAntimalwareExtension マルウェア対策コマンドレットを使用 <http://msdn.microsoft.com/library/azure/dn771719.aspx>

3.  **クラウド サービスの**:」の説明に従って、マルウェア対策の構成を取得する Get AzureServiceAntimalwareConfig マルウェア対策コマンドレットを使用 <http://msdn.microsoft.com/library/azure/dn771722.aspx>

###PowerShell コマンドレットを使用したマルウェア対策の構成の削除

Azure アプリケーションまたはサービスでは、Cloud Service または Virtual Machine に関連付けられている関連する Azure マルウェア対策および診断サービスの拡張機能から、マルウェア対策の構成および関連付けられているマルウェア対策監視構成を削除できます。

PowerShell コマンドレットを使用して Microsoft マルウェア対策を削除するには:

1.  PowerShell 環境を設定するのには、ドキュメントを参照してください <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **仮想マシンの**:」の説明に従って削除 AzureVMMicrosoftAntimalwareExtension マルウェア対策のコマンドレットを使用して <http://msdn.microsoft.com/library/azure/dn771720.aspx>

3.  **クラウド サービス:** 」の説明に従って削除 AzureServiceAntimalwareExtension マルウェア対策のコマンドレットを使用して <http://msdn.microsoft.com/library/azure/dn771717.aspx>

 **を有効にする** Azure プレビュー ポータルを使用して仮想マシンのイベント コレクションのマルウェア対策。

1.  [仮想マシン] ブレードの監視レンズのどこかをクリックします。

2.  [メトリック] ブレードの [診断] コマンドをクリックします。

3.  選択 **ステータス** ON および Windows イベント システム ログのオプションをチェックします。 一覧の他のオプションは、すべてオフにしても、アプリケーション サービスのニーズに応じて有効のままにしてもかまいません。

4.  「エラー」、「警告」、「情報」などのマルウェア対策イベント カテゴリが、Azure ストレージ アカウントに収集されます。

マルウェア対策のイベントが、Windows イベント システム ログから Azure ストレージ アカウントに収集されます。 適切なストレージ アカウントを選択することにより、マルウェア対策のイベントを収集するように仮想マシンのストレージ アカウントを構成できます。

![メトリックと診断](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

###PowerShell コマンドレットを使用したマルウェア対策の監視の有効化と構成

マルウェア対策 PowerShell コマンドレットを使用して、Azure 診断を用いた Cloud Service または Virtual Machine の Microsoft マルウェア対策イベントの収集を有効にできます。 システム イベント ログ ソース “Microsoft マルウェア対策” から Azure ストレージ アカウントにイベントをキャプチャするように、Azure 診断拡張機能を構成できます。 「エラー」、「警告」、「情報」などのマルウェア対策イベント カテゴリが、Azure ストレージ アカウントに収集されます。

PowerShell コマンドレットを使用して Azure ストレージ アカウントへのマルウェア対策イベント収集を有効にするには:

1.  PowerShell 環境での設定を参照してください <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **仮想マシンの** -」の説明に従って、セット AzureVMMicrosoftAntimalwareExtension マルウェア対策コマンドレットを監視 ON オプションを使用します。 <http://msdn.microsoft.com/library/azure/dn771716.aspx>

3.  **クラウド サービスの** -」の説明に従って、セット AzureServiceAntimalwareExtension マルウェア対策コマンドレットを監視 ON オプションを使用します。 <http://msdn.microsoft.com/library/azure/dn771718.aspx>

マルウェア対策の監視を有効にするために構成した Azure ストレージ アカウントの WADWindowsEventLogsTable テーブルで、マルウェア対策の未加工のイベントを見ることができます。 これにより、マルウェア対策サービスの正常性の詳細など、マルウェア対策イベント収集が動作していることを確認できます。 ストレージ アカウントからマルウェア対策のイベントを抽出する方法のサンプル コードを含め、詳細についてを参照してください [Microsoft マルウェア対策の Azure クラウド サービスと仮想マシンのコード サンプル](http://aka.ms/amazsamples "Microsoft マルウェア対策の Azure クラウド サービスと仮想マシンのコード サンプル")します。

