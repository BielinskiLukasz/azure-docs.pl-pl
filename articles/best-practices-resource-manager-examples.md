<properties
    pageTitle="テンプレート実装のベスト プラクティスの具体的な例"
    description="ベスト プラクティスを示す Azure リソース マネージャーのテンプレートの例を紹介します。"
    services="azure-resource-manager"
    documentationCenter=""
    authors="mmercuri"
    manager="georgem"
    editor="tysonn"/>

<tags
    ms.service="azure-resource-manager"
    ms.workload="multiple"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="08/13/2015"
    ms.author="mmercuri"/>

# テンプレート実装のベスト プラクティスの具体的な例

このトピックでは、Azure リソース マネージャーのテンプレートを実装する方法に関する 7 つの具体的な例を紹介します。 原則の概要については 
これらの例に示すようを参照してください [Azure リソース マネージャーのテンプレートのデザインのベスト プラクティス](best-practices-resource-manager-design-templates.md)します。

このトピックは大型のホワイト ペーパーの一部です。 フルのペーパーを参照するには、ダウンロード [世界クラスの ARM テンプレートの考慮事項と実証済みプラクティス] (http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World クラス ARM テンプレートの考慮事項と実証済みの Practices.pdf)。

## 機能スコープ テンプレートをエンド ツー エンド ソリューション スコープ テンプレートに移行する

機能スコープ テンプレートを開発するためのパターンは、既に共有されていますが、  考えて疑問の 1 つは、さまざまな考慮事項があるかどうか 
ときに、単独またはエンド ツー エンド ソリューション スコープ テンプレートの一部としては、この機能スコープ テンプレートを使用します。  

たとえば、機能の 1 つとして SQL Server の展開テクノロジに重点を置いたテンプレートがあった場合することが考慮事項は、発生した場合、使用しています。 
個別にまたは取引に伴いより大きなのエンド ツー エンド ソリューション スコープの web アプリケーションをサポートするために SQL Server を使用するテンプレートです。

このシナリオを考える場合は、関連するリソースの数に注目することが適切です。 堅牢な実装では、機能スコープ テンプレートがありません。 
ストレージ アカウントや SQL Server の 1 つのインストール時に 1 つの VM だけにします。 堅牢な機能スコープ テンプレートでは、SQL Server の展開で複数の Vm を展開します。 
高可用性を実現します。 Analysis Services などの一部の機能では、トポロジでも Active Directory と共に SQL Server がデプロイされる場合があります。

このシナリオの重要な 2 つの考慮事項として、SQL Server がどのように使用されるかを示すライフサイクルと、SQL Server に適用する RBAC があります。  具体的には 
SQL Server 更新やソリューションまたはソリューションの他の部分からのライフ サイクルの変化、ソリューションまたはの残りの部分を削除します。  また、 
ライフ サイクルが異なる別のリソース グループに配置することを検討してください。  

もう 1 つの考慮事項は、RBAC を SQL Server の機能スコープ ソリューション テンプレートに適用する方法です。  内で RBAC を適用する方法に基づく 
トポロジ、さまざまなこれらの詳細に合うようにリソース グループを選択できます。  特定の数が、リソース レベルでの RBAC を適用することができます。 
リソースの SQL Server 機能スコープ ソリューション テンプレートに RBAC を適用して別のリソース グループは、重要な考慮事項をする必要があります。

別の考慮事項は、作成した場合、現在特定のリソース自体 vs を識別するために SQL Server の機能スコープ ソリューション テンプレートの評価です。 
「リソースの持ち込み」することができます。  「リソース持ち込み」(BYOR) モデルの場合、機能スコープ ソリューション テンプレートに、テンプレートを許可します。 
再利用、既存のリソースとストレージ アカウント、仮想ネットワークまたは可用性セットという典型的な例です。 BYOR アプローチが存在しない場合 
機能スコープ テンプレートでは、オプションのリソース テンプレートは、このドキュメントで定義したアプローチを使用することを変更できます。  ここで、 
エンド ツー エンド ソリューション スコープ テンプレートは、共通のリソースの共有リソース テンプレートを持つ、機能スコープ テンプレートを拡張すると 
オプションとして、これらのリソースをサポートします。  これにより、より優れた機能ソリューション スコープ テンプレートが作成され、単独で使用したり、構成の一部として使用できるようになります。

エンド ツー エンド ソリューション スコープ テンプレートからストレージ アカウントを渡す必要があるかどうかを評価する際は、RBAC も再評価する必要があります。 具体的には、 
この特定のリソースに RBAC が適用されることを確認する必要がありますか。  場合は、リソースが適用のレベルに渡されると予想される場合 
ソリューション ブロックが必要に応じてこれを使用する場合は、機能スコープ テンプレートを提供する必要のあるすべてのユーザーではなく信頼を配置します。 
独立しています。  RBAC が重要な場合、機能スコープ ソリューション テンプレート内の省略可能なテンプレートにするかどうかを検討してください、 
または、ことが要求されるが、機能内から必要な RBAC を使用した作成スコープ ソリューション テンプレートです。

でも、リソース間のリレーションシップを定義するのにリソースへのリンクを使用する別のリソース グループにこれらを配置するのに意思決定が行われた場合もことができます。 
リソースがリソース グループにまたがるとき。

## 複数の機能スコープ テンプレートを含むエンド ツー エンド ソリューション スコープ テンプレートを作成する

これは主に、前の例のスーパーセットです。 このシナリオでは、組織が、一連の複数の機能スコープ ソリューション テンプレート 
Kafka、Apache Hadoop、Apache Spark に 1 つのソリューション ブロックにまとめたい、Apache Storm などのデータ テクノロジです。  その結果 
コンポジションには、特定のサブネットの割り当てにこれらの機能スコープ ソリューション テンプレートだけでなく、共有記憶域と仮想ネットワークは使用します。

必要に応じて、その他のリソースがこのソリューションでは、必要である特定の機能スコープ テンプレートの外部であってもだけするスクリプトします。 
機能スコープ テンプレートをまとめるし、構成は。

この場合、共有の仮想ネットワークとストレージ アカウントがあることが識別されます。  これに合わせて、この共有を追加する必要があります。 
エンド ツー エンド ソリューション内のリソース テンプレートは、スコープのテンプレートを「リソース持ち込み」アプローチが、機能スコープ テンプレートでサポートされていることを確認します。 
対応していない場合は、前の例で説明したように、機能スコープ テンプレートを変更して対応させることができます。

追加するその他のリソースについては、個々の機能スコープ テンプレートの作成に使用されるパターンのスーパーセットに従います。 
共有リソース テンプレート、オプション リソース テンプレート、メンバー ノード テンプレート、および目的の状態の構成 (スクリプトを追加する場合は、 
Chef、Puppet、Powershell DSC) の新しいリソースです。  依存関係がある場合、可能な限り暗黙的な参照と dependsOn を使用する最適化します 
配置の並列処理 (および速度) に影響を与える無効な依存関係が発生する可能性を排除します。 ライフ サイクルを検討することもあります。 
これらのリソース、RBAC の考慮事項、およびこれらを別のリソース グループに配置するかどうかを判断する依存関係。  

共有記憶域アカウントなどの共有リソースを追加するときにする必要がありますも評価リソース ロックが必要な場合、これを回避できます。 
誤った削除操作。

新しいリソースを追加するときにもを調べてください。 いずれかのエンド ツー エンド ソリューション スコープ テンプレートに追加されているリソースを分離できる場合 
機能スコープ テンプレート自体として  場合は、この厳密考えなければなりませんにとっての利点を提供できるように分解をさらに促進 
再利用し、テストの両方です。

ソリューション ブロックに統合するときに、次の考慮事項を識別する場合、前の例で識別される個別のライフ サイクル 
機能スコープ ソリューション テンプレートは広範なソリューションと異なると、RBAC の要件がこれらを分離することを必要となるかどうか 
別々 のリソース グループ。

最後に、リソースの間のリンクを定義および照会できるようにするかどうかを検討します。 リソース リンクを採用することが、作成する場合は、します。 
複数のリソース グループにまたがる場合でも、エンド ツー エンド ソリューション スコープ テンプレート間これを実行できます。

## 部分的なオン/オフの切り替えパターンを使用してエンド ツー エンド ソリューション スコープ テンプレートを作成する

このシナリオは、前のシナリオの変化形です。  この場合、顧客は 1 日のうち一定の間隔でオンプレミスのシステムからデータを抽出します。  
顧客は、このように抽出したデータを処理するためのデータ パイプラインと、そのデータを常にクエリに使用できるリレーショナル データ ストアを所有しています。  クラウドは、 
従量課金制モデルで処理するためにデータが表示されるときに、これらの間隔中にのみデータ パイプラインを運用を持つ、顧客の希望します。

データ パイプラインの一部として導入した SQL Server では、処理後のデータを受け取り、そのデータを照会できるようにします。 顧客がいます。 
取り込み部分とその処理の固定されたスケジュールでパイプラインのオンとオフを有効にするには、中には、常に利用可能な SQL Server 扱おうとします。

このシナリオでは、ライフ サイクルに明確な違いのように見える内容があるし、可能性のあるいくつか追加の考慮事項、顧客が 
発生しますが、評価する必要があります。

説明したとおり、SQL Server のデプロイは、他のリソースが作成されたり削除されたりする間も維持されます。  それらは最初にまとめてデプロイします。 
ですが、テンプレートの他のメンバーは破壊され、別のライフ サイクルに作成します。  これらを別のリソース グループに分離することができますか 
SQL Server リソースに適用されるリソースのロックを使用して同じリソース グループに残っています。  SQL Server と具体的には、前の例で説明されています。 
さまざまなリソースとして表現の場合、、独自のリソース グループに分けることが適しています。

その他の考慮事項ですが、お客様は、データ パイプラインの残りの部分が欲しいと言われました
オン/オフになっているスケジュールに従って、いる可能性があります考慮していないレポート システムの不一致の動作です。  サード パーティからのデータのスケジュールされた配信しない場合は 
常に正確な – 接続を使用できないローカル クロック時間の期間の誤差があるクラウド ベースのサーバーまたは、時間の変更の可能性がありますまたはとしてことはできません。 
もちろんなどです。場合は、そのライフ サイクルが大きい場合、オン/オフ パターンで同様に、取り込みメカニズムを使用する場合に評価する必要があります。 
場合よりも処理コンポーネントです。

Azure Data Factory や Event Hub などの管理されたサービスを使用している場合は、あまり問題として、運用モデルと関連する課金方法 
データを取り込んでストレージに配置することにすぐに使用できるようにします。  バーチャル マシンを配置した Kafka などの別のテクノロジを使用している場合 
マシンすることもこと、および使用可能な取り込みに必要な関連付けられたストレージ アカウントを作成する方法のライフ サイクルを確認します。  これが原因で 
取り込みと処理のリソースをそのライフ サイクルに基づいて別のリソース グループに配置されています。

## 1 つのサブスクリプション内で異なる環境をサポートする

多くの組織のサービスを効率的に行うため、スケール、課金の分離、説明責任の分離する必要がある地理的な分離要件のセットがあります。 
満たされています。  組織は、Azure のサービスを設計する際、このようなニーズを満たす方法に、サブスクリプションのパーティション分割を使用してきました。  

リソース マネージャーが、サブスクリプション内で展開可能な特定の種類のリソースの数に対する制約を緩和し、リソース グループを導入しています 
RBAC と監査します。 これらを組み合わせることができます、パーティション分割用のリソース グループを使用する組織の要件を満たすようにし、 
サブスクリプションのパーティション分割を行う必要がありますが、量を減らします。  

このセクションでは、このような種類の環境に見られる要件を確認し、ARM でその要件を満たす環境を実現する方法についてガイダンスを示します。  

### 分離に関する考慮事項

このセクションでは、環境の分離、課金の分離、地理的な分離に関する一般的な顧客要因について詳しく説明します。

#### 環境の分離

サービスの所有者は、異なる環境を分離したいと考えています。  各環境の分離により、チームができるより細かです 
環境へのアクセスを持つを制御します。 開発環境は、それらにアクセスできるユーザーとしての観点からよりオープンであっても、 
または支援するために自動化 – で使用するシステム アカウントを縮小して環境のスコープはユーザーの数を実稼働環境に近いが 
コンプライアンスと全体的なリスクを最小化します。

#### 課金の分離 – サービスの開発と実行

コストの原価 (COGS) と営業経費 (OpEx) を正確に反映するには、ビジネス オーナーが調査中のコストを分割できるようにします。 
サービスを実行すると、サービスを作成します。  

環境の分離のスーパー セットで説明したように、目的は開発とテストを個別の統合になるや 
集計したまま、実稼働は後者の独立した、前者の課金されます。

#### 課金の分離 – サービスの使用にかかるコストに対する透明性と説明責任の追加

課金の分離は、特定のチームや適切な紹介プラットフォーム使用に関連したコストへ透明性のどちらにも使用されます。 
説明責任のレベル。

これは、非クラウド モデルから一部の開発者にとってあまり知られていない、クラウドはエラスティックであり、従量課金モデルにより、中に、ハードウェア 
調達あり所有するものです。 非クラウド モデルでは、「コンピューター」に有効にできるありの数に関して物理的な制限されました。 
使用しないときは、スケール ダウン オンまたはオフするリソースの制限のインセンティブをでした。  多くの場合、この専用のハードウェアの調達の行っていたわけで、 
それを使用していた開発者。

サブスクリプションを分離すると、特定のチームにそれらのサブスクリプションの説明責任を割り当て、サービスの所有者は、この種類のサブスクリプション 
パーティションの促進と目的の動作の適用の場合も利点です。

#### 地理的な分離 – 特定の地域に固有のデプロイと特定の地域の法律に準拠するデプロイ

特定のコンテキストでがある、特定の地域を対象としたサービスがアドレスに展開する方法を検討する必要がある要件 
コンプライアンスの考慮事項です。

運用で内に存在するか、または特定地域にサービスを提供するための展開を管理することが、サービスは、本質的にグローバルであっても、 
人員配置します。 具体的を特定の国または定められた国の市民である場合や特定の背景審査を通過したユーザーのみを持つ 
プロセスには、それらのサービスが動作します。

地理的な分離には、新しいプラットフォームのサービスと機能を利用するという観点でもメリットがあります。 中国などの一部の地域の可能性があります。 
利用できるプラットフォーム サービスの一部のみまたはプラットフォーム サービスの展開を延期します。  

地理的な分離により、チームの新規または強化されたプラットフォーム サービスと機能を利用するには、そのサービスを進化すること、 
利用。

### コンプライアンスの考慮事項

サービスは、複数の地域や業界に配信される場合があります。 これらの対象ユーザーは、機密データやプロセスに含まれている多くの場合があります。 
自分のアプリケーション設計を保護するためにもとそれらに対する取り組みの監査に関連付けられているコンプライアンス規制があるとします。

#### ロールと義務の分離

ロールと義務の分離は、内部サービスを企業内ポリシーに準拠させるための主な要件です。 多くの商用サービスがあります。 
この政府や業界の規制ガイドラインの準拠を維持します。  サービスがサービスとその基になるリソースへのアクセスを制限する必要があります。 
特定の状況での役割を承認します。 多くのサービスでは、RBAC と監査という 2 つの機能を提供するためにスキャフォールディングが作成されています。

#### ロールベースのアクセス制御 (RBAC) の使用事例

コンプライアンスのシナリオでは、特定のリソースへのアクセスを制限することが重要です。  

たとえば、複数のシナリオでコンプライアンスが関連する - 正常性情報、財務データは、機密データを見てみると 
税の記録などのアクセス、表示、または必要とするためだけにデータを操作するメンバーの数を制限する必要が 
親組織のビジネスを行うにはアクセスできます。

RBAC により、個々のユーザー、システム、グループに対して、特定の条件下で特定のリソースへのアクセスが提供されます。

#### 監査

組織は、RBAC によって提供される限定的アクセスだけでなく、リソースへのアクセスとリソースとの対話を監査する必要があります。

### Azure リソース マネージャーによる実装

これまで、組織は、このような目標を達成するために、サブスクリプションのパーティション分割を使用していました。 この方法は可能ですが、理想的ではありませんでした。  作成として 
サブスクリプションは実質的に商取引のアクティビティで、サービス管理 API が作成または新しいサブスクリプションを削除するメカニズムが公開されていません 
自動的に手動で作成する必要のあるサブスクリプションとします。 サブスクリプションの結果の数は非常に大規模なサービスの – 大幅に増大する可能性があります。 
Microsoft の商用サービスなど – 数が 1,000 以上にわたる可能性のあります。  これは、結果としての作成が多くの場合 
カスタムのスキャフォールディングを作成し、組織のサブスクリプションを管理します。

リソース マネージャーを使用すると、サブスクリプション内で複数の環境をデプロイすることはさらに簡単になります。  リソース上で以前の固定 cap を緩和します。 
以前のモデルは、リソースの制約によるパーティション分割の必要性を大幅に削減でした。

環境は、リソース グループに配置できます。これらのリソース グループに特定の RBAC を適用すると、環境を分離できるようになります。  シナリオで 
地理的な分離が必要なこの実行可能リソース グループを使用します。 リソースとしてグループは、特定の分離の地域にまたがることができます。 
1 つまたは複数の地域で実現できます。

課金のロールアップや概要の表示に使用できるリソースとリソース グループにタグを適用することで、課金を分離できます。  タグを使用することができます。 
環境の種類 (研究、教育、開発、テスト、運用)、責任を持つ組織や個人 (「人事」、"Finance"、"John Smith"、"Jane Jones") を定義します。

監査の要件は、基礎となる Azure リソース マネージャーのそのまますぐに使用できる機能の一部として提供されており、一元的に表示できます。

認証およびロールのために使用される Azure Active Directory に登録されているアカウント ベースのアクセス制御に顧客を終了します 
環境とリソースです。

#### 密度の最適化

リソースの制限は Azure リソース マネージャーで緩和されますが、それでも一定の制限はあります。 環境自体を作成する必要もあります。 
サブスクリプション内での環境の密度を実現することを確認します。  個人または組織に容量を提供する環境を提供する、 
どのような関連する「t シャツ サイズ」を評価する必要がありますを配信します。  具体的には、小規模、中規模、大規模な、余分な間バリアントを識別します。 
必要なリソースの観点からより多くの顧客です。  

さらに密度を高くするために、"T シャツ サイズ" ごとに異なるサブスクリプションを使用することもできます。 たとえば、ことできます 1000年小規模に合わせて 
t シャツ サイズの環境、500 の規模のデプロイ、100 の大規模な展開、および特定のサブスクリプションで 10 個の非常に大規模な展開します。  課金なし 
複数のサブスクリプションがあるコストを最大限の密度を提供する別のサブスクリプションにさまざまなサイズを分離することがあります。  これを行う 
比較的控えめで容易に管理するサブスクリプションの数を保持します。

必要な場合とに、顧客を増やすか、t シャツのサイズを変更できるようにする場合、キーについて考慮する必要がある必要がありますが識別します。 
方法そのコンテンツを配置します。  

1 つには、顧客が既存のリソース グループ内で追加容量を取得できるようにする方法があります。  簡単に対応できます技術的には、 
密度に影響があります。  これにより、すべての顧客を明確に定義サイズではなく追加のオーバーヘッドが大きく変動性のレベル 
密度に最適化します。  すべてのサイズの小さい環境がサイズ X の場合は、あらかじめ簡単に計算数のサイズの小さい環境に配置することができます、 
最適な密度のサブスクリプションです。  環境をカスタマイズすることができる、結果はバリアントと数量の予測の数 
X、x+1、x+2、可能性のある環境の次のようになどです。このレベルの変動性では、容量を確保する必要が少なく密度を実現するは 
内にこれらの差異を対応するサブスクリプション。  

この方法は可能ですが、一般的な方法としてはあまり理想的ではありません。これは、密度が小さくなり、より多くのオーバーヘッドを管理する必要があるためです。 サイズが大きい 
環境より有効なオプションがあります。  以下のような大規模で余分な大規模な環境は、サブスクリプションの場合、ことができます、 
この成長に対応するサブスクリプションのうちに配置します。

また、顧客の現在のサイズの環境を削除して、別のサイズで新しい環境を作成する方法もあります。  While の適切でないです。 
シナリオによっては、これはテスト環境や開発など一時的に使用される環境に適しています。

次に最も簡単な方法は、ここは、顧客の規模の大きい環境を取得し、その環境への移行を管理する機能を提供するには 
自分でします。  たとえば、小規模な環境で SQL Server の展開を持っている顧客の中規模の環境を購入すること、個別になります 
データとカスタムの状態の転送を担当します。

または、このようなある規模から別の規模への移行に対応する管理されたサービスを提供する方法もあります。 これは明らかに複雑になりますが、 
ワークロードと顧客に基づいてこのなものもあります、組織が積極的になります。

## 顧客ポリシーの制約が追加された環境を提供する

組織によっては、デプロイする環境に関する追加の要件とポリシーがある場合もあります。 具体的には、制限するポリシーがある、 
ポートは、外部に公開され、環境への着信および発信トラフィックの監視を必要とするポリシーがある場合があります。
サポートとコストを考慮する場合は、最終顧客が作成、更新、削除できるリソースに対する制約があることもあります。
環境を提供する組織では、通常、サポートするためにサブスクリプションへのアクセスも必要になります。

前のシナリオのスーパー セットで、これが必要になりますがユーザーに追加の制約が保持される特定のリソースを追加し、 
指定した型のリソースを作成できませんでした。  

ユーザーが特定のリソースを作成、更新、または削除できるかどうかは、ロールベースのアクセス制御を使用して制限できます。  例として、 
特定の操作を必要とする組織は、VNET と潜在的に最終顧客が更新されていないか、削除するサブネットをネットワークです。

リソース ロックを実装して、リソースを読み取り専用にする、つまり、削除できないようにすることができます。 RBAC は、ユーザーまたはサービス プリンシパルに許可するために使用できます。 
リソースまたはリソース グループに対して特定のアクティビティを実行します。

アプリケーションでは、階層間のトラフィックなどが最初に仮想などを介して「組織では、トラフィックを特定する必要がある場合 
ネットワーク アプライアンス、ユーザー定義ルートを使用する必要があります。

仮想アプライアンスは、アプリケーションを実行する VM にすぎません。ファイアウォールや NAT デバイスなど、ネットワーク トラフィックを何らかの方法で処理するために使用されるアプリケーションが仮想アプライアンスで実行されます。 
数多くのサード パーティが Azure に仮想ネットワーク アプライアンスを提供していますが、組織は独自のアプライアンスを用意することもできます。

アプライアンスを "独自に用意する" 手法により、組織はオンプレミスの環境で使用できる既存のコードを再利用できます。 この仮想パス 
アプライアンス VM でそれ自体に扱っていない着信トラフィックを受信できる必要があります。 VM が自分の他の宛先に向かうトラフィックを受信するため 
VM の IP 転送を有効にする必要があります。  

これまでの例と同様に、リソースのライフサイクルと RBAC の制約をリソース グループ戦略の一環として見直して検討する必要があります。

## 内部の悪意のあるユーザーからリソースを保護する

組織にとっての懸念事項の 1 つとして、リソースとそのリソースをプロビジョニングするテンプレートを悪意のあるユーザーから保護する点が挙げられます。  

一例が、ある銀行しようとすると、悪意のあるソフトウェア開発者またはメンバーを確認して、IT のスタッフを行わない変更または 
刑事上の目的で、問題のあるアクターに移動するデータとなる重要な情報を抽出します。

一般的なエンタープライズ シナリオとデプロイされたワークロード内の重要なシークレットにアクセス権を持つ信頼されたオペレーターの小さなグループには 
作成または VM のデプロイを更新できる開発者/運用担当者の広範なグループです。  

VM のシークレットと証明書を調整および格納するには、Azure Key Vault を ARM と共に使用します。

ベスト プラクティスは、資格情報コンテナー (キー マテリアルが含まれます) の作成と Vm のデプロイ用の個別の ARM テンプレートを維持するためには 
(URI を持つを参照して、資格情報コンテナーに含まれるキー)。

Key Vault に格納されたシークレットは、厳密な RBAC により信頼されたオペレーターの手で制御されます。  信頼されたオペレーターは、会社または内での転送が退職した場合 
会社を新しいグループかどうかは、資格情報コンテナー内に作成したキーにアクセスします。

展開用の ARM テンプレートのみを含めるにはシークレットの URI 参照つまり、実際のシークレットはコード、構成、またはソース コードにはありません。 
リポジトリ。 これにより、シークレットがフィッシングされる可能性が低くなるほか、悪意のあるユーザーによる改ざんの可能性も抑えることができます。

このドキュメントで既に説明したように、グローバルな Key Vault はありません。 Key Vault は常に局所的であるため、シークレットは常に VM と同じローカリティ (および主権) を持ちます。

この方法の実装例については、このドキュメントの「シークレットと証明書」で説明しました。

## "サブスクリプション持ち込み" モデルを有効にする

社内 IT 部門、システム インテグレーター、Cloud Services ベンダーは、顧客と共同で "サブスクリプション持ち込み" モデルを使用する場合があります。  具体的には、 
組織では、エンド カスタマーにサービスを提供し、なんらかの方法で、その顧客の Azure サブスクリプションを利用します。

この方法には複数のバリエーションがあり、次に説明するように、それぞれで要件が若干異なります。

### アカウント内のリソースを監視するための第三者アクセスを有効にする

監視用のアプリケーションを持つ組織では、そのアプリケーションで使用するデータを取得するために、顧客のサブスクリプションに対する読み取り専用アクセスが必要になる場合があります。 
この場合、期間限定の読み取り専用アクセスが必要です。  アクセスは顧客が制御する機能を提供することである必要があります。 
監視サービスのプロバイダーとのリレーションシップが切断された場合は、アクセスを終了します。

#### Azure リソース マネージャーによる実装

この実装の詳細については、「開発者ガイドに認証、Azure リソース マネージャー API を使用」で詳しく説明する 
ご覧 [ここ](http://www.dushyantgill.com/blog/2015/05/23/developers-guide-to-auth-with-azure-resource-manager-api/)します。 そのドキュメントでは、 
ステップ バイ ステップの実装の説明とサンプル コードです。

### ソフトウェアを 1 回だけデプロイするための第三者アクセスを有効にする

別の例では、組織がのデプロイし、構成バージョンのソフトウェアの期間の書き込みアクセス権を必要とする顧客のアカウント 
展開の時間。

#### Azure リソース マネージャーによる実装

この例では、前の例と同様の方法に従います。

インストールの特定のニーズに応じて、サービス プリンシパルに割り当てられている特定のロールが最低レベルのアクセスのみを許可します。 
インストールを実行し、インストールの完了後に取り消すすぐにアクセスするに必要です。

### データの保存に顧客のサブスクリプションを使用するための第三者アクセスを有効にする

たとえば、組織は、独自の環境でソフトウェアを実行する一方で、データの保存には顧客のアカウントを使用したいと考える場合があります。 これにより、顧客 
データのコントロールに常にでき、あるプラットフォームでは、Azure Machine Learning や HDInsight などの他のテクノロジを活用できるように、 
独自の判断によってコストや料金オーバーヘッドが企業の IT やシステム インテグレーター、機能を提供する CSV を追加しません。 継続的にアクセスが必要です。 
その情報にアクセスするための情報を監査する制御とアクセスすることで顧客と、組織のストレージ アカウント。

#### Azure リソース マネージャーによる実装

これは、他の例と同じパターンを使用して実装されます。 サービス プリンシパルには、ストレージ リソースへのアクセスが提供されます。  このシナリオのために必要なとして 
読み取りし、書き込みアクセス ストレージ アカウント、ビルトインの共同作業者の役割は、このレベルのアクセスを実現するために、サービス プリンシパルに割り当てるとするロール。

このシナリオでは、共有記憶域アカウントを使用して、1 つ目と 3 番目のパーティにもありますストレージ アカウントがあることを確認したいです。 
誤って削除されません。  シナリオのこの側面については、ストレージ アカウントにリソース ロックを適用します。

### 第三者によるサービスの管理を有効にする

別の例では、組織が、顧客のサブスクリプションでソフトウェアをデプロイ、監視、管理したいと考える場合があります。 顧客に対する制約がある可能性があります。 
変更に関して、ことができます (またはより明示的にことはできません) に加えられるソフトウェアの展開環境です。

#### Azure リソース マネージャーによる実装

これは、このセクションの冒頭で示されたパターンのスーパーセットに従います。 具体的には、サード パーティで使用されるサービス プリンシパルが提供されます。 
リソース グループ内のリソースへのフル アクセスできます。

さらに、顧客に対する制約があるため、顧客のユーザーまたはグループには、環境を使用するために適切な権限が付与されます。  
これは、このセクションで既に示したテンプレートを使用して実行できます。

最後に、特定のリソースが誤って削除されないようにすることが求められる場合もあります。  大文字と小文字の場合は、リソース ロックもあります。 
このような保護を必要とするリソースと見なされます。

## 次のステップ

- テンプレートの作成方法については、次を参照してください。 [テンプレートの作成](resource-group-authoring-templates.md)します。
- Azure リソース マネージャーのセキュリティを処理する方法に関する推奨事項について、次を参照してください。 [セキュリティの考慮事項 Azure リソース マネージャーの](best-practices-resource-manager-security.md)です。
- テンプレートに出入りする状態の共有については、次を参照してください [Azure リソース マネージャー テンプレートでの状態の共有。](best-practices-resource-manager-state.md)


